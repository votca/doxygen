<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>votca: xtp/src/libxtp/orbitals.cc Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">votca<span id="projectnumber">&#160;2023-dev</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_74c2a4b3b0df7b8317fa7dedf91a69e4.html">xtp</a></li><li class="navelem"><a class="el" href="dir_939a47b76fcf2b405f4898a413fd95f4.html">src</a></li><li class="navelem"><a class="el" href="dir_dc926f450391b6c725d23f976d3dbdae.html">libxtp</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle"><div class="title">orbitals.cc</div></div>
</div><!--header-->
<div class="contents">
<a href="orbitals_8cc.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="comment">/*</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="comment"> *            Copyright 2009-2022 The VOTCA Development Team</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="comment"> *                       (http://www.votca.org)</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="comment"> *</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="comment"> *      Licensed under the Apache License, Version 2.0 (the &quot;License&quot;)</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="comment"> *</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="comment"> * You may not use this file except in compliance with the License.</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="comment"> * You may obtain a copy of the License at</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="comment"> *</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="comment"> *              http://www.apache.org/licenses/LICENSE-2.0</span></div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="comment"> *</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="comment"> * Unless required by applicable law or agreed to in writing, software</span></div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="comment"> * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="comment"> * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span><span class="comment"> * See the License for the specific language governing permissions and</span></div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="comment"> * limitations under the License.</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="comment"> *</span></div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span><span class="comment"> */</span></div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span> </div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span><span class="comment">// Standard includes</span></div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span><span class="preprocessor">#include &lt;cstdio&gt;</span></div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span><span class="preprocessor">#include &lt;fstream&gt;</span></div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span><span class="preprocessor">#include &lt;iomanip&gt;</span></div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span><span class="preprocessor">#include &lt;numeric&gt;</span></div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span> </div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span><span class="comment">// Local VOTCA includes</span></div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span><span class="preprocessor">#include &quot;<a class="code" href="aomatrix_8h.html">votca/xtp/aomatrix.h</a>&quot;</span></div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span><span class="preprocessor">#include &quot;<a class="code" href="orbitals_8h.html">votca/xtp/orbitals.h</a>&quot;</span></div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span><span class="preprocessor">#include &quot;<a class="code" href="orbreorder_8h.html">votca/xtp/orbreorder.h</a>&quot;</span></div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span><span class="preprocessor">#include &quot;<a class="code" href="qmstate_8h.html">votca/xtp/qmstate.h</a>&quot;</span></div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span><span class="preprocessor">#include &quot;<a class="code" href="vc2index_8h.html">votca/xtp/vc2index.h</a>&quot;</span></div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span><span class="preprocessor">#include &quot;<a class="code" href="xtp_2include_2votca_2xtp_2version_8h.html">votca/xtp/version.h</a>&quot;</span></div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span> </div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span><span class="keyword">namespace </span><a class="code hl_namespace" href="namespacevotca.html">votca</a> {</div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span><span class="keyword">namespace </span>xtp {</div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span> </div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno"><a class="line" href="classvotca_1_1xtp_1_1Orbitals.html#aa5e2e7fe2eaffd23911c1b4e0c16da26">   37</a></span><a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#aa5e2e7fe2eaffd23911c1b4e0c16da26">Orbitals::Orbitals</a>() : atoms_(<span class="stringliteral">&quot;&quot;</span>, 0) { ; }</div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span> </div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno"><a class="line" href="classvotca_1_1xtp_1_1Orbitals.html#a5b244837b85d38e4f16d5ad3cc6a33a2">   46</a></span>std::vector&lt;Index&gt; <a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#a5b244837b85d38e4f16d5ad3cc6a33a2">Orbitals::CheckDegeneracy</a>(<a class="code hl_typedef" href="namespacevotca.html#ad2c9da4f7634ac9c89e02a192345f276">Index</a> level,</div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span>                                             <span class="keywordtype">double</span> energy_difference)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span> </div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span>  std::vector&lt;Index&gt; result;</div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span>  <span class="keywordflow">if</span> (level &gt; <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#aa7de90dfd160a1dd838e0ef6e07e58d3">mos_</a>.<a class="code hl_function" href="classvotca_1_1tools_1_1EigenSystem.html#a8e7c2db1e04dcae085b3ba95d298dedd">eigenvalues</a>().size()) {</div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span>    <span class="keywordflow">throw</span> std::runtime_error(</div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span>        <span class="stringliteral">&quot;Level for degeneracy is higher than maximum level&quot;</span>);</div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span>  }</div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span>  <span class="keywordtype">double</span> MOEnergyLevel = <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#aa7de90dfd160a1dd838e0ef6e07e58d3">mos_</a>.<a class="code hl_function" href="classvotca_1_1tools_1_1EigenSystem.html#a8e7c2db1e04dcae085b3ba95d298dedd">eigenvalues</a>()(level);</div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span> </div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span>  <span class="keywordflow">for</span> (<a class="code hl_typedef" href="namespacevotca.html#ad2c9da4f7634ac9c89e02a192345f276">Index</a> i = 0; i &lt; <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#aa7de90dfd160a1dd838e0ef6e07e58d3">mos_</a>.<a class="code hl_function" href="classvotca_1_1tools_1_1EigenSystem.html#a8e7c2db1e04dcae085b3ba95d298dedd">eigenvalues</a>().size(); ++i) {</div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span>    <span class="keywordflow">if</span> (std::abs(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#aa7de90dfd160a1dd838e0ef6e07e58d3">mos_</a>.<a class="code hl_function" href="classvotca_1_1tools_1_1EigenSystem.html#a8e7c2db1e04dcae085b3ba95d298dedd">eigenvalues</a>()(i) - MOEnergyLevel) &lt; energy_difference) {</div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span>      result.push_back(i);</div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span>    }</div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>  }</div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span> </div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span>  <span class="keywordflow">if</span> (result.empty()) {</div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span>    result.push_back(level);</div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span>  }</div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span>  <span class="keywordflow">return</span> result;</div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span>}</div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span> </div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno"><a class="line" href="classvotca_1_1xtp_1_1Orbitals.html#a9aefc57e4347f374d3510f9a031038f9">   68</a></span>std::vector&lt;Index&gt; <a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#a9aefc57e4347f374d3510f9a031038f9">Orbitals::SortEnergies</a>() {</div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span>  std::vector&lt;Index&gt; index = std::vector&lt;Index&gt;(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#aa7de90dfd160a1dd838e0ef6e07e58d3">mos_</a>.<a class="code hl_function" href="classvotca_1_1tools_1_1EigenSystem.html#a8e7c2db1e04dcae085b3ba95d298dedd">eigenvalues</a>().size());</div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>  std::iota(index.begin(), index.end(), 0);</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span>  std::stable_sort(index.begin(), index.end(), [<span class="keyword">this</span>](<a class="code hl_typedef" href="namespacevotca.html#ad2c9da4f7634ac9c89e02a192345f276">Index</a> i1, <a class="code hl_typedef" href="namespacevotca.html#ad2c9da4f7634ac9c89e02a192345f276">Index</a> i2) {</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span>    return this-&gt;MOs().eigenvalues()[i1] &lt; this-&gt;MOs().eigenvalues()[i2];</div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span>  });</div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>  <span class="keywordflow">return</span> index;</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span>}</div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span> </div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno"><a class="line" href="classvotca_1_1xtp_1_1Orbitals.html#adcab9d59437f5a1cfca97c18596b9fad">   82</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#adcab9d59437f5a1cfca97c18596b9fad">Orbitals::SetupDftBasis</a>(std::string basis_name) {</div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>  <span class="keywordflow">if</span> (this-&gt;<a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#ac5a83ad06a7e5ca059787674811cd858">QMAtoms</a>().size() == 0) {</div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span>    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Can&#39;t setup AOBasis without atoms&quot;</span>);</div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>  }</div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span>  <a class="code hl_class" href="classvotca_1_1xtp_1_1BasisSet.html">BasisSet</a> bs;</div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span>  bs.<a class="code hl_function" href="classvotca_1_1xtp_1_1BasisSet.html#a1e8646dc8d3f6c07e67cac0eecd21e93">Load</a>(basis_name);</div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>  <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a4aa6c1ce5ac6f1d6f80f13d52a039c2c">dftbasis_</a>.<a class="code hl_function" href="classvotca_1_1xtp_1_1AOBasis.html#a3638e1261da1fff40c3608c01fac8307">Fill</a>(bs, this-&gt;<a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#ac5a83ad06a7e5ca059787674811cd858">QMAtoms</a>());</div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>}</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span> </div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno"><a class="line" href="classvotca_1_1xtp_1_1Orbitals.html#a8b8b606ff6c1c7742cd6f69af0f992cf">   91</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#a8b8b606ff6c1c7742cd6f69af0f992cf">Orbitals::SetupAuxBasis</a>(std::string aux_basis_name) {</div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span>  <span class="keywordflow">if</span> (this-&gt;<a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#ac5a83ad06a7e5ca059787674811cd858">QMAtoms</a>().size() == 0) {</div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span>    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Can&#39;t setup Aux AOBasis without atoms&quot;</span>);</div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>  }</div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span>  <a class="code hl_class" href="classvotca_1_1xtp_1_1BasisSet.html">BasisSet</a> bs;</div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span>  bs.<a class="code hl_function" href="classvotca_1_1xtp_1_1BasisSet.html#a1e8646dc8d3f6c07e67cac0eecd21e93">Load</a>(aux_basis_name);</div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>  <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#ac343e12cc6b5e6d708e6fd9ab3970b11">auxbasis_</a>.<a class="code hl_function" href="classvotca_1_1xtp_1_1AOBasis.html#a3638e1261da1fff40c3608c01fac8307">Fill</a>(bs, this-&gt;<a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#ac5a83ad06a7e5ca059787674811cd858">QMAtoms</a>());</div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span>}</div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span> </div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span><span class="comment">/*</span></div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span><span class="comment"> * Returns the density matrix relative to the ground state, for the full density</span></div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span><span class="comment"> * use DensityMatrixFull</span></div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span><span class="comment"> */</span></div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno"><a class="line" href="classvotca_1_1xtp_1_1Orbitals.html#a7c807131c81c48cf0be8d5a810eb7941">  104</a></span>Eigen::MatrixXd <a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#a7c807131c81c48cf0be8d5a810eb7941">Orbitals::DensityMatrixWithoutGS</a>(<span class="keyword">const</span> <a class="code hl_class" href="classvotca_1_1xtp_1_1QMState.html">QMState</a>&amp; state)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span>  <span class="keywordflow">if</span> (state.<a class="code hl_function" href="classvotca_1_1xtp_1_1QMState.html#aa30e0b21e5dff10052e30077a8c0410d">Type</a>().<a class="code hl_function" href="classvotca_1_1xtp_1_1QMStateType.html#a958c0ba19ba206b9f4374d62576dd2eb">isExciton</a>()) {</div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span>    std::array&lt;Eigen::MatrixXd, 2&gt; DMAT = <a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#ae17bc4b6ebc754292e20a648ebba023e">DensityMatrixExcitedState</a>(state);</div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span>    <span class="keywordflow">return</span> DMAT[1] - DMAT[0];</div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (state.<a class="code hl_function" href="classvotca_1_1xtp_1_1QMState.html#aa30e0b21e5dff10052e30077a8c0410d">Type</a>().<a class="code hl_function" href="classvotca_1_1xtp_1_1QMStateType.html#a3179e227d625ddd4ebd80fd8144f5666">isKSState</a>() || state.<a class="code hl_function" href="classvotca_1_1xtp_1_1QMState.html#aa30e0b21e5dff10052e30077a8c0410d">Type</a>().<a class="code hl_function" href="classvotca_1_1xtp_1_1QMStateType.html#a31c4856f68f540aef4abb5e70084a9c5">isPQPState</a>()) {</div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#aae17c5ef36a4607f2f200ca9ab66c927">DensityMatrixKSstate</a>(state);</div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (state.<a class="code hl_function" href="classvotca_1_1xtp_1_1QMState.html#aa30e0b21e5dff10052e30077a8c0410d">Type</a>() == <a class="code hl_enumvalue" href="classvotca_1_1xtp_1_1QMStateType.html#ac99cbd6d6ed98f669041f0840b09dfe7ac38ed43cdfb00d13f8d30dd9861f072b">QMStateType::DQPstate</a>) {</div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span>    Eigen::MatrixXd DMATQP = <a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#ab1ba720a9628298e50bcc7780e4c7784">DensityMatrixQuasiParticle</a>(state);</div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span>    <span class="keywordflow">if</span> (state.<a class="code hl_function" href="classvotca_1_1xtp_1_1QMState.html#a70412e35addab60844009b9a589db477">StateIdx</a>() &gt; <a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#a180caaa2c175edb63e4a1b8cc9da09b7">getHomo</a>()) {</div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>      <span class="keywordflow">return</span> DMATQP;</div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>      <span class="keywordflow">return</span> -DMATQP;</div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>    }</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>    <span class="keywordflow">throw</span> std::runtime_error(</div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span>        <span class="stringliteral">&quot;DensityMatrixWithoutGS does not yet implement QMStateType:&quot;</span> +</div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>        state.<a class="code hl_function" href="classvotca_1_1xtp_1_1QMState.html#aa30e0b21e5dff10052e30077a8c0410d">Type</a>().<a class="code hl_function" href="classvotca_1_1xtp_1_1QMStateType.html#a0a88e40efdabb7a94057b6518cd271ad">ToLongString</a>());</div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span>  }</div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span>}</div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span> </div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span><span class="comment">/*</span></div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span><span class="comment"> * Returns the density matrix with the ground state density, for the partial</span></div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span><span class="comment"> * density relative to the ground state use DensityMatrixWithoutGS</span></div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span><span class="comment"> */</span></div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno"><a class="line" href="classvotca_1_1xtp_1_1Orbitals.html#a86c86146758f19c44f7f1cb4b93ed6a3">  128</a></span>Eigen::MatrixXd <a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#a86c86146758f19c44f7f1cb4b93ed6a3">Orbitals::DensityMatrixFull</a>(<span class="keyword">const</span> <a class="code hl_class" href="classvotca_1_1xtp_1_1QMState.html">QMState</a>&amp; state)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span>  <span class="keywordflow">if</span> (state.<a class="code hl_function" href="classvotca_1_1xtp_1_1QMState.html#a9ad29285bd6dbf88e111f927c2695e48">isTransition</a>()) {</div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span>    <span class="keywordflow">return</span> this-&gt;<a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#a1d3c3224a7064ba7c09f3d9bcc1b09a7">TransitionDensityMatrix</a>(state);</div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span>  }</div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span>  Eigen::MatrixXd result = this-&gt;<a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#ac54132162019b4fbb2d431007297ff59">DensityMatrixGroundState</a>();</div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span>  <span class="keywordflow">if</span> (state.<a class="code hl_function" href="classvotca_1_1xtp_1_1QMState.html#aa30e0b21e5dff10052e30077a8c0410d">Type</a>().<a class="code hl_function" href="classvotca_1_1xtp_1_1QMStateType.html#a958c0ba19ba206b9f4374d62576dd2eb">isExciton</a>()) {</div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span>    std::array&lt;Eigen::MatrixXd, 2&gt; DMAT = <a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#ae17bc4b6ebc754292e20a648ebba023e">DensityMatrixExcitedState</a>(state);</div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>    result = result - DMAT[0] + DMAT[1];  <span class="comment">// Ground state + hole_contribution +</span></div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>                                          <span class="comment">// electron contribution</span></div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (state.<a class="code hl_function" href="classvotca_1_1xtp_1_1QMState.html#aa30e0b21e5dff10052e30077a8c0410d">Type</a>() == <a class="code hl_enumvalue" href="classvotca_1_1xtp_1_1QMStateType.html#ac99cbd6d6ed98f669041f0840b09dfe7ac38ed43cdfb00d13f8d30dd9861f072b">QMStateType::DQPstate</a>) {</div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>    Eigen::MatrixXd DMATQP = <a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#ab1ba720a9628298e50bcc7780e4c7784">DensityMatrixQuasiParticle</a>(state);</div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>    <span class="keywordflow">if</span> (state.<a class="code hl_function" href="classvotca_1_1xtp_1_1QMState.html#a70412e35addab60844009b9a589db477">StateIdx</a>() &gt; <a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#a180caaa2c175edb63e4a1b8cc9da09b7">getHomo</a>()) {</div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>      result += DMATQP;</div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>      result -= DMATQP;</div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span>    }</div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (state.<a class="code hl_function" href="classvotca_1_1xtp_1_1QMState.html#aa30e0b21e5dff10052e30077a8c0410d">Type</a>() != <a class="code hl_enumvalue" href="classvotca_1_1xtp_1_1QMStateType.html#ac99cbd6d6ed98f669041f0840b09dfe7a3f229c61861798e442a17b3f0889d4b5">QMStateType::Gstate</a>) {</div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span>    <span class="keywordflow">throw</span> std::runtime_error(</div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span>        <span class="stringliteral">&quot;DensityMatrixFull does not yet implement QMStateType:&quot;</span> +</div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>        state.<a class="code hl_function" href="classvotca_1_1xtp_1_1QMState.html#aa30e0b21e5dff10052e30077a8c0410d">Type</a>().<a class="code hl_function" href="classvotca_1_1xtp_1_1QMStateType.html#a0a88e40efdabb7a94057b6518cd271ad">ToLongString</a>());</div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span>  }</div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>  <span class="keywordflow">return</span> result;</div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>}</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span> </div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span><span class="comment">// Determine ground state density matrix</span></div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno"><a class="line" href="classvotca_1_1xtp_1_1Orbitals.html#ac54132162019b4fbb2d431007297ff59">  153</a></span>Eigen::MatrixXd <a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#ac54132162019b4fbb2d431007297ff59">Orbitals::DensityMatrixGroundState</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>  <span class="keywordflow">if</span> (!<a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#a4652e57816ac2a9e1510619e84bfce14">hasMOs</a>()) {</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Orbitals file does not contain MO coefficients&quot;</span>);</div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span>  }</div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>  Eigen::MatrixXd occstates = <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#aa7de90dfd160a1dd838e0ef6e07e58d3">mos_</a>.<a class="code hl_function" href="classvotca_1_1tools_1_1EigenSystem.html#afd8f46808af0552ff1a6ef84a42fe595">eigenvectors</a>().leftCols(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#acbeb7caec928a11684f1ff366ff59df1">occupied_levels_</a>);</div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>  Eigen::MatrixXd dmatGS = 2.0 * occstates * occstates.transpose();</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>  <span class="keywordflow">return</span> dmatGS;</div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>}</div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span> </div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span><span class="comment">// Density matrix for a single KS orbital</span></div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno"><a class="line" href="classvotca_1_1xtp_1_1Orbitals.html#aae17c5ef36a4607f2f200ca9ab66c927">  163</a></span>Eigen::MatrixXd <a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#aae17c5ef36a4607f2f200ca9ab66c927">Orbitals::DensityMatrixKSstate</a>(<span class="keyword">const</span> <a class="code hl_class" href="classvotca_1_1xtp_1_1QMState.html">QMState</a>&amp; state)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>  <span class="keywordflow">if</span> (!<a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#a4652e57816ac2a9e1510619e84bfce14">hasMOs</a>()) {</div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Orbitals file does not contain MO coefficients&quot;</span>);</div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>  }</div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>  <span class="keywordflow">if</span> (state.<a class="code hl_function" href="classvotca_1_1xtp_1_1QMState.html#aa30e0b21e5dff10052e30077a8c0410d">Type</a>() != <a class="code hl_enumvalue" href="classvotca_1_1xtp_1_1QMStateType.html#ac99cbd6d6ed98f669041f0840b09dfe7a734e21875c92fc7531db01ec3af9a745">QMStateType::KSstate</a> &amp;&amp;</div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span>      state.<a class="code hl_function" href="classvotca_1_1xtp_1_1QMState.html#aa30e0b21e5dff10052e30077a8c0410d">Type</a>() != <a class="code hl_enumvalue" href="classvotca_1_1xtp_1_1QMStateType.html#ac99cbd6d6ed98f669041f0840b09dfe7ae0acab0b2ea033ec422edf6307460c21">QMStateType::PQPstate</a>) {</div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span>    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;State:&quot;</span> + state.<a class="code hl_function" href="classvotca_1_1xtp_1_1QMState.html#a538bcb5ebbb52080e9da42ba19e96580">ToString</a>() +</div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span>                             <span class="stringliteral">&quot; is not a Kohn Sham state&quot;</span>);</div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span>  }</div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span>  Eigen::VectorXd KSstate = <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#aa7de90dfd160a1dd838e0ef6e07e58d3">mos_</a>.<a class="code hl_function" href="classvotca_1_1tools_1_1EigenSystem.html#afd8f46808af0552ff1a6ef84a42fe595">eigenvectors</a>().col(state.<a class="code hl_function" href="classvotca_1_1xtp_1_1QMState.html#a70412e35addab60844009b9a589db477">StateIdx</a>());</div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>  Eigen::MatrixXd dmatKS = KSstate * KSstate.transpose();</div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span>  <span class="keywordflow">return</span> dmatKS;</div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>}</div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span> </div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno"><a class="line" href="classvotca_1_1xtp_1_1Orbitals.html#a27fa02e785479c75e0d83581e5a4050e">  177</a></span>Eigen::MatrixXd <a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#a27fa02e785479c75e0d83581e5a4050e">Orbitals::CalculateQParticleAORepresentation</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span>  <span class="keywordflow">if</span> (!<a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#a120e88f83b42812bf8354aa36c4c9e70">hasQPdiag</a>()) {</div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span>    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Orbitals file does not contain QP coefficients&quot;</span>);</div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>  }</div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>  <span class="keywordflow">return</span> <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#aa7de90dfd160a1dd838e0ef6e07e58d3">mos_</a>.<a class="code hl_function" href="classvotca_1_1tools_1_1EigenSystem.html#afd8f46808af0552ff1a6ef84a42fe595">eigenvectors</a>().middleCols(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#ab6c4b68ab342ea95c03d25336d2b8813">qpmin_</a>, <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a4d4b98307e22f87e591a1812a959d807">qpmax_</a> - <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#ab6c4b68ab342ea95c03d25336d2b8813">qpmin_</a> + 1) *</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>         <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#aac5c74b33ec36fbeaafdd154d1a6c722">QPdiag_</a>.<a class="code hl_function" href="classvotca_1_1tools_1_1EigenSystem.html#afd8f46808af0552ff1a6ef84a42fe595">eigenvectors</a>();</div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>}</div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span> </div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span><span class="comment">// Determine QuasiParticle Density Matrix</span></div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno"><a class="line" href="classvotca_1_1xtp_1_1Orbitals.html#ab1ba720a9628298e50bcc7780e4c7784">  186</a></span>Eigen::MatrixXd <a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#ab1ba720a9628298e50bcc7780e4c7784">Orbitals::DensityMatrixQuasiParticle</a>(</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>    <span class="keyword">const</span> <a class="code hl_class" href="classvotca_1_1xtp_1_1QMState.html">QMState</a>&amp; state)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span>  <span class="keywordflow">if</span> (state.<a class="code hl_function" href="classvotca_1_1xtp_1_1QMState.html#aa30e0b21e5dff10052e30077a8c0410d">Type</a>() != <a class="code hl_enumvalue" href="classvotca_1_1xtp_1_1QMStateType.html#ac99cbd6d6ed98f669041f0840b09dfe7ac38ed43cdfb00d13f8d30dd9861f072b">QMStateType::DQPstate</a>) {</div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span>    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;State:&quot;</span> + state.<a class="code hl_function" href="classvotca_1_1xtp_1_1QMState.html#a538bcb5ebbb52080e9da42ba19e96580">ToString</a>() +</div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>                             <span class="stringliteral">&quot; is not a quasiparticle state&quot;</span>);</div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span>  }</div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span>  Eigen::MatrixXd lambda = <a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#a27fa02e785479c75e0d83581e5a4050e">CalculateQParticleAORepresentation</a>();</div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span>  Eigen::MatrixXd dmatQP = lambda.col(state.<a class="code hl_function" href="classvotca_1_1xtp_1_1QMState.html#a70412e35addab60844009b9a589db477">StateIdx</a>() - <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#ab6c4b68ab342ea95c03d25336d2b8813">qpmin_</a>) *</div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span>                           lambda.col(state.<a class="code hl_function" href="classvotca_1_1xtp_1_1QMState.html#a70412e35addab60844009b9a589db477">StateIdx</a>() - <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#ab6c4b68ab342ea95c03d25336d2b8813">qpmin_</a>).transpose();</div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span>  <span class="keywordflow">return</span> dmatQP;</div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span>}</div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span> </div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno"><a class="line" href="classvotca_1_1xtp_1_1Orbitals.html#aefad140d4ee0d2f0e8ebd099055d701d">  198</a></span>Eigen::Vector3d <a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#aefad140d4ee0d2f0e8ebd099055d701d">Orbitals::CalcElDipole</a>(<span class="keyword">const</span> <a class="code hl_class" href="classvotca_1_1xtp_1_1QMState.html">QMState</a>&amp; state)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span>  Eigen::Vector3d nuclei_dip = Eigen::Vector3d::Zero();</div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>  <span class="keywordflow">if</span> (!state.<a class="code hl_function" href="classvotca_1_1xtp_1_1QMState.html#a9ad29285bd6dbf88e111f927c2695e48">isTransition</a>()) {</div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code hl_class" href="classvotca_1_1xtp_1_1QMAtom.html">QMAtom</a>&amp; atom : <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#af7e77d477a6ab54b0214c01d07b8887f">atoms_</a>) {</div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span>      nuclei_dip += (atom.getPos() - <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#af7e77d477a6ab54b0214c01d07b8887f">atoms_</a>.<a class="code hl_function" href="classvotca_1_1xtp_1_1AtomContainer.html#ab7e0b5b18022220498df92e7742b3cf4">getPos</a>()) * atom.getNuccharge();</div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>    }</div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span>  }</div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>  <a class="code hl_class" href="classvotca_1_1xtp_1_1AOBasis.html">AOBasis</a> basis = <a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#af5b81973c667c1651e7f1a933cb88fa7">getDftBasis</a>();</div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span>  <a class="code hl_class" href="classvotca_1_1xtp_1_1AODipole.html">AODipole</a> dipole;</div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>  dipole.<a class="code hl_function" href="classvotca_1_1xtp_1_1AODipole.html#a40668742fd6156242bfd06e60c71cd88">setCenter</a>(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#af7e77d477a6ab54b0214c01d07b8887f">atoms_</a>.<a class="code hl_function" href="classvotca_1_1xtp_1_1AtomContainer.html#ab7e0b5b18022220498df92e7742b3cf4">getPos</a>());</div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>  dipole.<a class="code hl_function" href="classvotca_1_1xtp_1_1AODipole.html#aea0e297102a02c92c6d2b626efbad29e">Fill</a>(basis);</div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span> </div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span>  Eigen::MatrixXd dmat = this-&gt;<a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#a86c86146758f19c44f7f1cb4b93ed6a3">DensityMatrixFull</a>(state);</div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>  Eigen::Vector3d electronic_dip;</div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>  <span class="keywordflow">for</span> (<a class="code hl_typedef" href="namespacevotca.html#ad2c9da4f7634ac9c89e02a192345f276">Index</a> i = 0; i &lt; 3; ++i) {</div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>    electronic_dip(i) = dmat.cwiseProduct(dipole.<a class="code hl_function" href="classvotca_1_1xtp_1_1AODipole.html#ab91f50dafeceb8155bd361c4a12969fb">Matrix</a>()[i]).sum();</div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>  }</div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span>  <span class="keywordflow">return</span> nuclei_dip - electronic_dip;</div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span>}</div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span> </div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno"><a class="line" href="classvotca_1_1xtp_1_1Orbitals.html#a1d3c3224a7064ba7c09f3d9bcc1b09a7">  218</a></span>Eigen::MatrixXd <a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#a1d3c3224a7064ba7c09f3d9bcc1b09a7">Orbitals::TransitionDensityMatrix</a>(<span class="keyword">const</span> <a class="code hl_class" href="classvotca_1_1xtp_1_1QMState.html">QMState</a>&amp; state)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>  <span class="keywordflow">if</span> (state.<a class="code hl_function" href="classvotca_1_1xtp_1_1QMState.html#aa30e0b21e5dff10052e30077a8c0410d">Type</a>() != <a class="code hl_enumvalue" href="classvotca_1_1xtp_1_1QMStateType.html#ac99cbd6d6ed98f669041f0840b09dfe7ac2ca29ef89597f341a74e08f205c4552">QMStateType::Singlet</a>) {</div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span>    <span class="keywordflow">throw</span> std::runtime_error(</div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span>        <span class="stringliteral">&quot;Spin type not known for transition density matrix. Available only for &quot;</span></div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span>        <span class="stringliteral">&quot;singlet&quot;</span>);</div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>  }</div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span>  <span class="keyword">const</span> Eigen::MatrixXd&amp; BSECoefs = <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a3901d86f0481b0fe1c38ce5c6e86dd34">BSE_singlet_</a>.<a class="code hl_function" href="classvotca_1_1tools_1_1EigenSystem.html#afd8f46808af0552ff1a6ef84a42fe595">eigenvectors</a>();</div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>  <span class="keywordflow">if</span> (BSECoefs.cols() &lt; state.<a class="code hl_function" href="classvotca_1_1xtp_1_1QMState.html#a70412e35addab60844009b9a589db477">StateIdx</a>() + 1 || BSECoefs.rows() &lt; 2) {</div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Orbitals object has no information about state:&quot;</span> +</div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span>                             state.<a class="code hl_function" href="classvotca_1_1xtp_1_1QMState.html#a538bcb5ebbb52080e9da42ba19e96580">ToString</a>());</div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>  }</div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span> </div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span>  <span class="comment">// The Transition dipole is sqrt2 bigger because of the spin, the excited</span></div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span>  <span class="comment">// state is a linear combination of 2 slater determinants, where either alpha</span></div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>  <span class="comment">// or beta spin electron is excited</span></div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span> </div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span>  <span class="comment">/*Trying to implement D_{alpha,beta}=</span></div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span><span class="comment">   * sqrt2*sum_{i}^{occ}sum_{j}^{virt}{BSEcoef(i,j)*MOcoef(alpha,i)*MOcoef(beta,j)}</span></div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span><span class="comment">   */</span></div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>  <span class="comment">// c stands for conduction band and thus virtual orbitals</span></div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>  <span class="comment">// v stand for valence band and thus occupied orbitals</span></div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span> </div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>  Eigen::VectorXd coeffs = BSECoefs.col(state.<a class="code hl_function" href="classvotca_1_1xtp_1_1QMState.html#a70412e35addab60844009b9a589db477">StateIdx</a>());</div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span> </div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span>  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a83029c41b0a8ca0933bc5abbe64e55fd">useTDA_</a>) {</div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span>    coeffs += <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a3901d86f0481b0fe1c38ce5c6e86dd34">BSE_singlet_</a>.<a class="code hl_function" href="classvotca_1_1tools_1_1EigenSystem.html#a705cf773bc4108779d4b617ec0230136">eigenvectors2</a>().col(state.<a class="code hl_function" href="classvotca_1_1xtp_1_1QMState.html#a70412e35addab60844009b9a589db477">StateIdx</a>());</div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span>  }</div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>  coeffs *= std::sqrt(2.0);</div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span>  <span class="keyword">auto</span> occlevels = <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#aa7de90dfd160a1dd838e0ef6e07e58d3">mos_</a>.<a class="code hl_function" href="classvotca_1_1tools_1_1EigenSystem.html#afd8f46808af0552ff1a6ef84a42fe595">eigenvectors</a>().middleCols(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a019c308b9fda2ca4a0287c15df838c2e">bse_vmin_</a>, <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a558fe820c96cbcbea288396d9d54e9ff">bse_vtotal_</a>);</div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>  <span class="keyword">auto</span> virtlevels = <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#aa7de90dfd160a1dd838e0ef6e07e58d3">mos_</a>.<a class="code hl_function" href="classvotca_1_1tools_1_1EigenSystem.html#afd8f46808af0552ff1a6ef84a42fe595">eigenvectors</a>().middleCols(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a0ce477afbebc6dcdde2be08370fedbb4">bse_cmin_</a>, <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a5795bda46e15d19f671c03797f49a8f7">bse_ctotal_</a>);</div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>  Eigen::Map&lt;const Eigen::MatrixXd&gt; mat(coeffs.data(), <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a5795bda46e15d19f671c03797f49a8f7">bse_ctotal_</a>,</div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span>                                        <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a558fe820c96cbcbea288396d9d54e9ff">bse_vtotal_</a>);</div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span> </div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span>  <span class="keywordflow">return</span> occlevels * mat.transpose() * virtlevels.transpose();</div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span>}</div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span> </div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno"><a class="line" href="classvotca_1_1xtp_1_1Orbitals.html#ae17bc4b6ebc754292e20a648ebba023e">  254</a></span>std::array&lt;Eigen::MatrixXd, 2&gt; <a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#ae17bc4b6ebc754292e20a648ebba023e">Orbitals::DensityMatrixExcitedState</a>(</div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span>    <span class="keyword">const</span> <a class="code hl_class" href="classvotca_1_1xtp_1_1QMState.html">QMState</a>&amp; state)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span>  std::array&lt;Eigen::MatrixXd, 2&gt; dmat = <a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#a2ad86a0b1463f04bf716af8765570b11">DensityMatrixExcitedState_R</a>(state);</div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span>  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a83029c41b0a8ca0933bc5abbe64e55fd">useTDA_</a>) {</div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span>    std::array&lt;Eigen::MatrixXd, 2&gt; dmat_AR =</div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span>        <a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#a9cfac3693d61b6ef7c079deb01b493af">DensityMatrixExcitedState_AR</a>(state);</div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span>    dmat[0] -= dmat_AR[0];</div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span>    dmat[1] -= dmat_AR[1];</div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span>  }</div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span>  <span class="keywordflow">return</span> dmat;</div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span>}</div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span> </div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span><span class="comment">// Excited state density matrix</span></div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span> </div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno"><a class="line" href="classvotca_1_1xtp_1_1Orbitals.html#a2ad86a0b1463f04bf716af8765570b11">  268</a></span>std::array&lt;Eigen::MatrixXd, 2&gt; <a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#a2ad86a0b1463f04bf716af8765570b11">Orbitals::DensityMatrixExcitedState_R</a>(</div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>    <span class="keyword">const</span> <a class="code hl_class" href="classvotca_1_1xtp_1_1QMState.html">QMState</a>&amp; state)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span>  <span class="keywordflow">if</span> (!state.<a class="code hl_function" href="classvotca_1_1xtp_1_1QMState.html#aa30e0b21e5dff10052e30077a8c0410d">Type</a>().<a class="code hl_function" href="classvotca_1_1xtp_1_1QMStateType.html#a958c0ba19ba206b9f4374d62576dd2eb">isExciton</a>()) {</div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span>    <span class="keywordflow">throw</span> std::runtime_error(</div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span>        <span class="stringliteral">&quot;Spin type not known for density matrix. Available are singlet and &quot;</span></div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span>        <span class="stringliteral">&quot;triplet&quot;</span>);</div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>  }</div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span> </div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span>  <span class="keyword">const</span> Eigen::MatrixXd&amp; BSECoefs = (state.<a class="code hl_function" href="classvotca_1_1xtp_1_1QMState.html#aa30e0b21e5dff10052e30077a8c0410d">Type</a>() == <a class="code hl_enumvalue" href="classvotca_1_1xtp_1_1QMStateType.html#ac99cbd6d6ed98f669041f0840b09dfe7ac2ca29ef89597f341a74e08f205c4552">QMStateType::Singlet</a>)</div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span>                                        ? <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a3901d86f0481b0fe1c38ce5c6e86dd34">BSE_singlet_</a>.<a class="code hl_function" href="classvotca_1_1tools_1_1EigenSystem.html#afd8f46808af0552ff1a6ef84a42fe595">eigenvectors</a>()</div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span>                                        : <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a8f706b2f707e8ab94f9947d4dce92eb0">BSE_triplet_</a>.<a class="code hl_function" href="classvotca_1_1tools_1_1EigenSystem.html#afd8f46808af0552ff1a6ef84a42fe595">eigenvectors</a>();</div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span>  <span class="keywordflow">if</span> (BSECoefs.cols() &lt; state.<a class="code hl_function" href="classvotca_1_1xtp_1_1QMState.html#a70412e35addab60844009b9a589db477">StateIdx</a>() + 1 || BSECoefs.rows() &lt; 2) {</div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span>    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Orbitals object has no information about state:&quot;</span> +</div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>                             state.<a class="code hl_function" href="classvotca_1_1xtp_1_1QMState.html#a538bcb5ebbb52080e9da42ba19e96580">ToString</a>());</div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span>  }</div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span><span class="comment">  /******</span></div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span><span class="comment">   *</span></div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span><span class="comment">   *    Density matrix for GW-BSE based excitations</span></div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span><span class="comment">   *</span></div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span><span class="comment">   *    - electron contribution</span></div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span><span class="comment">   *      D_ab = \sum{vc} \sum{c&#39;} A_{vc}A_{vc&#39;} mo_a(c)mo_b(c&#39;)</span></div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span><span class="comment">   *</span></div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span><span class="comment">   *    - hole contribution</span></div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span><span class="comment">   *      D_ab = \sum{vc} \sum{v&#39;} A_{vc}A_{v&#39;c} mo_a(v)mo_b(v&#39;)</span></div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span><span class="comment">   *</span></div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span><span class="comment">   */</span></div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span> </div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span>  Eigen::VectorXd coeffs = BSECoefs.col(state.<a class="code hl_function" href="classvotca_1_1xtp_1_1QMState.html#a70412e35addab60844009b9a589db477">StateIdx</a>());</div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span> </div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span>  std::array&lt;Eigen::MatrixXd, 2&gt; dmatEX;</div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span>  <span class="comment">// hole part as matrix products</span></div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span>  Eigen::MatrixXd occlevels =</div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span>      <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#aa7de90dfd160a1dd838e0ef6e07e58d3">mos_</a>.<a class="code hl_function" href="classvotca_1_1tools_1_1EigenSystem.html#afd8f46808af0552ff1a6ef84a42fe595">eigenvectors</a>().middleCols(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a019c308b9fda2ca4a0287c15df838c2e">bse_vmin_</a>, <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a558fe820c96cbcbea288396d9d54e9ff">bse_vtotal_</a>);</div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span>  dmatEX[0] = occlevels * <a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#a8858d3cf8e9ef6df2192c1823343e1ab">CalcAuxMat_vv</a>(coeffs) * occlevels.transpose();</div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span> </div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span>  <span class="comment">// electron part as matrix products</span></div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span>  Eigen::MatrixXd virtlevels =</div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span>      <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#aa7de90dfd160a1dd838e0ef6e07e58d3">mos_</a>.<a class="code hl_function" href="classvotca_1_1tools_1_1EigenSystem.html#afd8f46808af0552ff1a6ef84a42fe595">eigenvectors</a>().middleCols(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a0ce477afbebc6dcdde2be08370fedbb4">bse_cmin_</a>, <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a5795bda46e15d19f671c03797f49a8f7">bse_ctotal_</a>);</div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span>  dmatEX[1] = virtlevels * <a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#a694e0adac36aa08474a8be7f7e96655d">CalcAuxMat_cc</a>(coeffs) * virtlevels.transpose();</div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span> </div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span>  <span class="keywordflow">return</span> dmatEX;</div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span>}</div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span> </div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno"><a class="line" href="classvotca_1_1xtp_1_1Orbitals.html#a8858d3cf8e9ef6df2192c1823343e1ab">  311</a></span>Eigen::MatrixXd <a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#a8858d3cf8e9ef6df2192c1823343e1ab">Orbitals::CalcAuxMat_vv</a>(<span class="keyword">const</span> Eigen::VectorXd&amp; coeffs)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span>  <span class="keyword">const</span> Eigen::Map&lt;const Eigen::MatrixXd&gt; mat(coeffs.data(), <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a5795bda46e15d19f671c03797f49a8f7">bse_ctotal_</a>,</div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span>                                              <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a558fe820c96cbcbea288396d9d54e9ff">bse_vtotal_</a>);</div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span>  <span class="keywordflow">return</span> mat.transpose() * mat;</div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span>}</div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span> </div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno"><a class="line" href="classvotca_1_1xtp_1_1Orbitals.html#a694e0adac36aa08474a8be7f7e96655d">  317</a></span>Eigen::MatrixXd <a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#a694e0adac36aa08474a8be7f7e96655d">Orbitals::CalcAuxMat_cc</a>(<span class="keyword">const</span> Eigen::VectorXd&amp; coeffs)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span>  <span class="keyword">const</span> Eigen::Map&lt;const Eigen::MatrixXd&gt; mat(coeffs.data(), <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a5795bda46e15d19f671c03797f49a8f7">bse_ctotal_</a>,</div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span>                                              <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a558fe820c96cbcbea288396d9d54e9ff">bse_vtotal_</a>);</div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span>  <span class="keywordflow">return</span> mat * mat.transpose();</div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span>}</div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span> </div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno"><a class="line" href="classvotca_1_1xtp_1_1Orbitals.html#a9cfac3693d61b6ef7c079deb01b493af">  323</a></span>std::array&lt;Eigen::MatrixXd, 2&gt; <a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#a9cfac3693d61b6ef7c079deb01b493af">Orbitals::DensityMatrixExcitedState_AR</a>(</div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span>    <span class="keyword">const</span> <a class="code hl_class" href="classvotca_1_1xtp_1_1QMState.html">QMState</a>&amp; state)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span> </div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span>  <span class="keywordflow">if</span> (!state.<a class="code hl_function" href="classvotca_1_1xtp_1_1QMState.html#aa30e0b21e5dff10052e30077a8c0410d">Type</a>().<a class="code hl_function" href="classvotca_1_1xtp_1_1QMStateType.html#a958c0ba19ba206b9f4374d62576dd2eb">isExciton</a>()) {</div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span>    <span class="keywordflow">throw</span> std::runtime_error(</div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span>        <span class="stringliteral">&quot;Spin type not known for density matrix. Available are singlet and &quot;</span></div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span>        <span class="stringliteral">&quot;triplet&quot;</span>);</div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span>  }</div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span> </div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span>  <span class="keyword">const</span> Eigen::MatrixXd&amp; BSECoefs_AR = (state.<a class="code hl_function" href="classvotca_1_1xtp_1_1QMState.html#aa30e0b21e5dff10052e30077a8c0410d">Type</a>() == <a class="code hl_enumvalue" href="classvotca_1_1xtp_1_1QMStateType.html#ac99cbd6d6ed98f669041f0840b09dfe7ac2ca29ef89597f341a74e08f205c4552">QMStateType::Singlet</a>)</div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span>                                           ? <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a3901d86f0481b0fe1c38ce5c6e86dd34">BSE_singlet_</a>.<a class="code hl_function" href="classvotca_1_1tools_1_1EigenSystem.html#a705cf773bc4108779d4b617ec0230136">eigenvectors2</a>()</div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span>                                           : <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a8f706b2f707e8ab94f9947d4dce92eb0">BSE_triplet_</a>.<a class="code hl_function" href="classvotca_1_1tools_1_1EigenSystem.html#a705cf773bc4108779d4b617ec0230136">eigenvectors2</a>();</div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span>  <span class="keywordflow">if</span> (BSECoefs_AR.cols() &lt; state.<a class="code hl_function" href="classvotca_1_1xtp_1_1QMState.html#a70412e35addab60844009b9a589db477">StateIdx</a>() + 1 || BSECoefs_AR.rows() &lt; 2) {</div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span>    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Orbitals object has no information about state:&quot;</span> +</div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span>                             state.<a class="code hl_function" href="classvotca_1_1xtp_1_1QMState.html#a538bcb5ebbb52080e9da42ba19e96580">ToString</a>());</div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span>  }</div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span><span class="comment">  /******</span></div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span><span class="comment">   *</span></div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span><span class="comment">   *    Density matrix for GW-BSE based excitations</span></div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span><span class="comment">   *</span></div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span><span class="comment">   *    - electron contribution</span></div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span><span class="comment">   *      D_ab = \sum{vc} \sum{v&#39;} B_{vc}B_{v&#39;c} mo_a(v)mo_b(v&#39;)</span></div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span><span class="comment">   *</span></div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span><span class="comment">   *    - hole contribution</span></div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span><span class="comment">   *      D_ab = \sum{vc} \sum{c&#39;} B_{vc}B_{vc&#39;} mo_a(c)mo_b(c&#39;)</span></div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span><span class="comment">   *</span></div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span><span class="comment">   *</span></div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span><span class="comment">   *   more efficient:</span></div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span><span class="comment">   *</span></div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span><span class="comment">   *   - electron contribution</span></div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span><span class="comment">   *      D_ab = \sum{v} \sum{v&#39;} mo_a(v)mo_b(v&#39;) [ \sum{c} B_{vc}B_{v&#39;c} ]</span></div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span><span class="comment">   *           = \sum{v} \sum{v&#39;} mo_a(v)mo_b(v&#39;) B_{vv&#39;}</span></div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span><span class="comment">   *</span></div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span><span class="comment">   *   - hole contribution</span></div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span><span class="comment">   *      D_ab = \sum{c} \sum{c&#39;} mo_a(c)mo_b(c&#39;) [ \sum{v} B_{vc}B_{vc&#39;} ]</span></div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span><span class="comment">   *           = \sum{c} \sum{c&#39;} mo_a(c)mo_b(c&#39;) B_{cc&#39;}</span></div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span><span class="comment">   *</span></div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span><span class="comment">   */</span></div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span> </div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span>  Eigen::VectorXd coeffs = BSECoefs_AR.col(state.<a class="code hl_function" href="classvotca_1_1xtp_1_1QMState.html#a70412e35addab60844009b9a589db477">StateIdx</a>());</div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span> </div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span>  std::array&lt;Eigen::MatrixXd, 2&gt; dmatAR;</div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span>  Eigen::MatrixXd virtlevels =</div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span>      <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#aa7de90dfd160a1dd838e0ef6e07e58d3">mos_</a>.<a class="code hl_function" href="classvotca_1_1tools_1_1EigenSystem.html#afd8f46808af0552ff1a6ef84a42fe595">eigenvectors</a>().middleCols(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a0ce477afbebc6dcdde2be08370fedbb4">bse_cmin_</a>, <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a5795bda46e15d19f671c03797f49a8f7">bse_ctotal_</a>);</div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span>  dmatAR[0] = virtlevels * <a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#a694e0adac36aa08474a8be7f7e96655d">CalcAuxMat_cc</a>(coeffs) * virtlevels.transpose();</div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span>  <span class="comment">// electron part as matrix products</span></div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span>  Eigen::MatrixXd occlevels =</div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span>      <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#aa7de90dfd160a1dd838e0ef6e07e58d3">mos_</a>.<a class="code hl_function" href="classvotca_1_1tools_1_1EigenSystem.html#afd8f46808af0552ff1a6ef84a42fe595">eigenvectors</a>().middleCols(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a019c308b9fda2ca4a0287c15df838c2e">bse_vmin_</a>, <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a558fe820c96cbcbea288396d9d54e9ff">bse_vtotal_</a>);</div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span>  dmatAR[1] = occlevels * <a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#a8858d3cf8e9ef6df2192c1823343e1ab">CalcAuxMat_vv</a>(coeffs) * occlevels.transpose();</div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span> </div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span>  <span class="keywordflow">return</span> dmatAR;</div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span>}</div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span> </div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno"><a class="line" href="classvotca_1_1xtp_1_1Orbitals.html#a76309d578fd7165002f6581ca468e4d0">  376</a></span>Eigen::VectorXd <a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#a76309d578fd7165002f6581ca468e4d0">Orbitals::Oscillatorstrengths</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span> </div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span>  <a class="code hl_typedef" href="namespacevotca.html#ad2c9da4f7634ac9c89e02a192345f276">Index</a> size = <a class="code hl_typedef" href="namespacevotca.html#ad2c9da4f7634ac9c89e02a192345f276">Index</a>(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a76efd09e2816d4c6aa7168973314ddb0">transition_dipoles_</a>.size());</div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span>  <span class="keywordflow">if</span> (size &gt; <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a3901d86f0481b0fe1c38ce5c6e86dd34">BSE_singlet_</a>.<a class="code hl_function" href="classvotca_1_1tools_1_1EigenSystem.html#a8e7c2db1e04dcae085b3ba95d298dedd">eigenvalues</a>().size()) {</div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span>    size = <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a3901d86f0481b0fe1c38ce5c6e86dd34">BSE_singlet_</a>.<a class="code hl_function" href="classvotca_1_1tools_1_1EigenSystem.html#a8e7c2db1e04dcae085b3ba95d298dedd">eigenvalues</a>().size();</div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span>  }</div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span>  Eigen::VectorXd oscs = Eigen::VectorXd::Zero(size);</div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span>  <span class="keywordflow">for</span> (<a class="code hl_typedef" href="namespacevotca.html#ad2c9da4f7634ac9c89e02a192345f276">Index</a> i = 0; i &lt; size; ++i) {</div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span>    oscs(i) = <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a76efd09e2816d4c6aa7168973314ddb0">transition_dipoles_</a>[i].squaredNorm() * 2.0 / 3.0 *</div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span>              (<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a3901d86f0481b0fe1c38ce5c6e86dd34">BSE_singlet_</a>.<a class="code hl_function" href="classvotca_1_1tools_1_1EigenSystem.html#a8e7c2db1e04dcae085b3ba95d298dedd">eigenvalues</a>()(i));</div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span>  }</div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span>  <span class="keywordflow">return</span> oscs;</div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span>}</div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span> </div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno"><a class="line" href="classvotca_1_1xtp_1_1Orbitals.html#a4a0ccbe7eed6b7e78131b398f79975a2">  390</a></span><span class="keywordtype">double</span> <a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#a4a0ccbe7eed6b7e78131b398f79975a2">Orbitals::getTotalStateEnergy</a>(<span class="keyword">const</span> <a class="code hl_class" href="classvotca_1_1xtp_1_1QMState.html">QMState</a>&amp; state)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span>  <span class="keywordtype">double</span> total_energy = <a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#a1e49d7abbe9d82622c501bc20b1e6a3c">getDFTTotalEnergy</a>();</div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span>  <span class="keywordflow">if</span> (state.<a class="code hl_function" href="classvotca_1_1xtp_1_1QMState.html#aa30e0b21e5dff10052e30077a8c0410d">Type</a>() == <a class="code hl_enumvalue" href="classvotca_1_1xtp_1_1QMStateType.html#ac99cbd6d6ed98f669041f0840b09dfe7a3f229c61861798e442a17b3f0889d4b5">QMStateType::Gstate</a>) {</div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span>    <span class="keywordflow">return</span> total_energy;</div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span>  }</div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span>  total_energy += <a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#a9d3e91cd86895b521605fac9a043207b">getExcitedStateEnergy</a>(state);</div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span>  <span class="keywordflow">return</span> total_energy;</div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span>}</div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span> </div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno"><a class="line" href="classvotca_1_1xtp_1_1Orbitals.html#a9d3e91cd86895b521605fac9a043207b">  399</a></span><span class="keywordtype">double</span> <a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#a9d3e91cd86895b521605fac9a043207b">Orbitals::getExcitedStateEnergy</a>(<span class="keyword">const</span> <a class="code hl_class" href="classvotca_1_1xtp_1_1QMState.html">QMState</a>&amp; state)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span> </div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span>  <span class="keywordtype">double</span> omega = 0.0;</div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span>  <span class="keywordflow">if</span> (state.<a class="code hl_function" href="classvotca_1_1xtp_1_1QMState.html#a9ad29285bd6dbf88e111f927c2695e48">isTransition</a>()) {</div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span>    <span class="keywordflow">throw</span> std::runtime_error(</div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span>        <span class="stringliteral">&quot;Total Energy does not exist for transition state&quot;</span>);</div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span>  }</div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span> </div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span>  <span class="keywordflow">if</span> (state.<a class="code hl_function" href="classvotca_1_1xtp_1_1QMState.html#aa30e0b21e5dff10052e30077a8c0410d">Type</a>() == <a class="code hl_enumvalue" href="classvotca_1_1xtp_1_1QMStateType.html#ac99cbd6d6ed98f669041f0840b09dfe7ac2ca29ef89597f341a74e08f205c4552">QMStateType::Singlet</a>) {</div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a3901d86f0481b0fe1c38ce5c6e86dd34">BSE_singlet_</a>.<a class="code hl_function" href="classvotca_1_1tools_1_1EigenSystem.html#a8e7c2db1e04dcae085b3ba95d298dedd">eigenvalues</a>().size() &lt; state.<a class="code hl_function" href="classvotca_1_1xtp_1_1QMState.html#a70412e35addab60844009b9a589db477">StateIdx</a>() + 1) {</div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span>      <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Orbitals::getTotalEnergy You want &quot;</span> +</div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span>                               state.<a class="code hl_function" href="classvotca_1_1xtp_1_1QMState.html#a538bcb5ebbb52080e9da42ba19e96580">ToString</a>() +</div>
<div class="line"><a id="l00411" name="l00411"></a><span class="lineno">  411</span>                               <span class="stringliteral">&quot; which has not been calculated&quot;</span>);</div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno">  412</span>    }</div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span>    omega = <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a3901d86f0481b0fe1c38ce5c6e86dd34">BSE_singlet_</a>.<a class="code hl_function" href="classvotca_1_1tools_1_1EigenSystem.html#a8e7c2db1e04dcae085b3ba95d298dedd">eigenvalues</a>()[state.<a class="code hl_function" href="classvotca_1_1xtp_1_1QMState.html#a70412e35addab60844009b9a589db477">StateIdx</a>()];</div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (state.<a class="code hl_function" href="classvotca_1_1xtp_1_1QMState.html#aa30e0b21e5dff10052e30077a8c0410d">Type</a>() == <a class="code hl_enumvalue" href="classvotca_1_1xtp_1_1QMStateType.html#ac99cbd6d6ed98f669041f0840b09dfe7a9d38a794b81a5e5fa8b32d8fc153b015">QMStateType::Triplet</a>) {</div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a8f706b2f707e8ab94f9947d4dce92eb0">BSE_triplet_</a>.<a class="code hl_function" href="classvotca_1_1tools_1_1EigenSystem.html#a8e7c2db1e04dcae085b3ba95d298dedd">eigenvalues</a>().size() &lt; state.<a class="code hl_function" href="classvotca_1_1xtp_1_1QMState.html#a70412e35addab60844009b9a589db477">StateIdx</a>() + 1) {</div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span>      <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Orbitals::getTotalEnergy You want &quot;</span> +</div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span>                               state.<a class="code hl_function" href="classvotca_1_1xtp_1_1QMState.html#a538bcb5ebbb52080e9da42ba19e96580">ToString</a>() +</div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span>                               <span class="stringliteral">&quot; which has not been calculated&quot;</span>);</div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span>    }</div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span>    omega = <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a8f706b2f707e8ab94f9947d4dce92eb0">BSE_triplet_</a>.<a class="code hl_function" href="classvotca_1_1tools_1_1EigenSystem.html#a8e7c2db1e04dcae085b3ba95d298dedd">eigenvalues</a>()[state.<a class="code hl_function" href="classvotca_1_1xtp_1_1QMState.html#a70412e35addab60844009b9a589db477">StateIdx</a>()];</div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (state.<a class="code hl_function" href="classvotca_1_1xtp_1_1QMState.html#aa30e0b21e5dff10052e30077a8c0410d">Type</a>() == <a class="code hl_enumvalue" href="classvotca_1_1xtp_1_1QMStateType.html#ac99cbd6d6ed98f669041f0840b09dfe7ac38ed43cdfb00d13f8d30dd9861f072b">QMStateType::DQPstate</a>) {</div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#aac5c74b33ec36fbeaafdd154d1a6c722">QPdiag_</a>.<a class="code hl_function" href="classvotca_1_1tools_1_1EigenSystem.html#a8e7c2db1e04dcae085b3ba95d298dedd">eigenvalues</a>().size() &lt; state.<a class="code hl_function" href="classvotca_1_1xtp_1_1QMState.html#a70412e35addab60844009b9a589db477">StateIdx</a>() + 1 - <a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#ac2971b02f8728af8270dc9f33b73fd02">getGWAmin</a>()) {</div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span>      <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Orbitals::getTotalEnergy You want &quot;</span> +</div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno">  424</span>                               state.<a class="code hl_function" href="classvotca_1_1xtp_1_1QMState.html#a538bcb5ebbb52080e9da42ba19e96580">ToString</a>() +</div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span>                               <span class="stringliteral">&quot; which has not been calculated&quot;</span>);</div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span>    }</div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#aac5c74b33ec36fbeaafdd154d1a6c722">QPdiag_</a>.<a class="code hl_function" href="classvotca_1_1tools_1_1EigenSystem.html#a8e7c2db1e04dcae085b3ba95d298dedd">eigenvalues</a>()[state.<a class="code hl_function" href="classvotca_1_1xtp_1_1QMState.html#a70412e35addab60844009b9a589db477">StateIdx</a>() - <a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#ac2971b02f8728af8270dc9f33b73fd02">getGWAmin</a>()];</div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (state.<a class="code hl_function" href="classvotca_1_1xtp_1_1QMState.html#aa30e0b21e5dff10052e30077a8c0410d">Type</a>() == <a class="code hl_enumvalue" href="classvotca_1_1xtp_1_1QMStateType.html#ac99cbd6d6ed98f669041f0840b09dfe7a734e21875c92fc7531db01ec3af9a745">QMStateType::KSstate</a>) {</div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#aa7de90dfd160a1dd838e0ef6e07e58d3">mos_</a>.<a class="code hl_function" href="classvotca_1_1tools_1_1EigenSystem.html#a8e7c2db1e04dcae085b3ba95d298dedd">eigenvalues</a>().size() &lt; state.<a class="code hl_function" href="classvotca_1_1xtp_1_1QMState.html#a70412e35addab60844009b9a589db477">StateIdx</a>() + 1) {</div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span>      <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Orbitals::getTotalEnergy You want &quot;</span> +</div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span>                               state.<a class="code hl_function" href="classvotca_1_1xtp_1_1QMState.html#a538bcb5ebbb52080e9da42ba19e96580">ToString</a>() +</div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span>                               <span class="stringliteral">&quot; which has not been calculated&quot;</span>);</div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span>    }</div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#aa7de90dfd160a1dd838e0ef6e07e58d3">mos_</a>.<a class="code hl_function" href="classvotca_1_1tools_1_1EigenSystem.html#a8e7c2db1e04dcae085b3ba95d298dedd">eigenvalues</a>()[state.<a class="code hl_function" href="classvotca_1_1xtp_1_1QMState.html#a70412e35addab60844009b9a589db477">StateIdx</a>()];</div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (state.<a class="code hl_function" href="classvotca_1_1xtp_1_1QMState.html#aa30e0b21e5dff10052e30077a8c0410d">Type</a>() == <a class="code hl_enumvalue" href="classvotca_1_1xtp_1_1QMStateType.html#ac99cbd6d6ed98f669041f0840b09dfe7ae0acab0b2ea033ec422edf6307460c21">QMStateType::PQPstate</a>) {</div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span>    <span class="keywordflow">if</span> (this-&gt;<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#ad870997ffd78d9f55e3ae4d6dc874a87">QPpert_energies_</a>.rows() &lt; state.<a class="code hl_function" href="classvotca_1_1xtp_1_1QMState.html#a70412e35addab60844009b9a589db477">StateIdx</a>() + 1 - <a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#ac2971b02f8728af8270dc9f33b73fd02">getGWAmin</a>()) {</div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span>      <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Orbitals::getTotalEnergy You want &quot;</span> +</div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span>                               state.<a class="code hl_function" href="classvotca_1_1xtp_1_1QMState.html#a538bcb5ebbb52080e9da42ba19e96580">ToString</a>() +</div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span>                               <span class="stringliteral">&quot; which has not been calculated&quot;</span>);</div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span>    }</div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#ad870997ffd78d9f55e3ae4d6dc874a87">QPpert_energies_</a>(state.<a class="code hl_function" href="classvotca_1_1xtp_1_1QMState.html#a70412e35addab60844009b9a589db477">StateIdx</a>() - <a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#ac2971b02f8728af8270dc9f33b73fd02">getGWAmin</a>(), 3);</div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (state.<a class="code hl_function" href="classvotca_1_1xtp_1_1QMState.html#aa30e0b21e5dff10052e30077a8c0410d">Type</a>() == <a class="code hl_enumvalue" href="classvotca_1_1xtp_1_1QMStateType.html#ac99cbd6d6ed98f669041f0840b09dfe7a56ff4f345deb58de7c991b71d0f9765e">QMStateType::LMOstate</a>) {</div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a304e2b3db425c758f159717312263016">lmos_energies_</a>.size() &lt; state.<a class="code hl_function" href="classvotca_1_1xtp_1_1QMState.html#a70412e35addab60844009b9a589db477">StateIdx</a>() + 1) {</div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span>      <span class="keywordflow">throw</span> std::runtime_error(</div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno">  445</span>          <span class="stringliteral">&quot;Orbitals::getTotalEnergy You want &quot;</span> + state.<a class="code hl_function" href="classvotca_1_1xtp_1_1QMState.html#a538bcb5ebbb52080e9da42ba19e96580">ToString</a>() +</div>
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno">  446</span>          <span class="stringliteral">&quot; which is a LMO for virtual orbitals. Not implemented.&quot;</span>);</div>
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno">  447</span>    }</div>
<div class="line"><a id="l00448" name="l00448"></a><span class="lineno">  448</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a304e2b3db425c758f159717312263016">lmos_energies_</a>(state.<a class="code hl_function" href="classvotca_1_1xtp_1_1QMState.html#a70412e35addab60844009b9a589db477">StateIdx</a>());</div>
<div class="line"><a id="l00449" name="l00449"></a><span class="lineno">  449</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00450" name="l00450"></a><span class="lineno">  450</span>    <span class="keywordflow">throw</span> std::runtime_error(</div>
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno">  451</span>        <span class="stringliteral">&quot;GetTotalEnergy only knows states:singlet,triplet,KS,DQP,PQP,LMOs&quot;</span>);</div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno">  452</span>  }</div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span>  <span class="keywordflow">return</span> omega;  <span class="comment">//  e.g. hartree</span></div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span>}</div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno">  455</span> </div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno"><a class="line" href="classvotca_1_1xtp_1_1Orbitals.html#a62d22f5ad32fdcc936eda4a14ebace3a">  456</a></span>std::array&lt;Eigen::MatrixXd, 3&gt; <a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#a62d22f5ad32fdcc936eda4a14ebace3a">Orbitals::CalcFreeTransition_Dipoles</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span>  <span class="keyword">const</span> Eigen::MatrixXd&amp; dft_orbitals = <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#aa7de90dfd160a1dd838e0ef6e07e58d3">mos_</a>.<a class="code hl_function" href="classvotca_1_1tools_1_1EigenSystem.html#afd8f46808af0552ff1a6ef84a42fe595">eigenvectors</a>();</div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span>  <a class="code hl_class" href="classvotca_1_1xtp_1_1AOBasis.html">AOBasis</a> basis = <a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#af5b81973c667c1651e7f1a933cb88fa7">getDftBasis</a>();</div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span>  <span class="comment">// Testing electric dipole AOMatrix</span></div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span>  <a class="code hl_class" href="classvotca_1_1xtp_1_1AODipole.html">AODipole</a> dft_dipole;</div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span>  dft_dipole.<a class="code hl_function" href="classvotca_1_1xtp_1_1AODipole.html#aea0e297102a02c92c6d2b626efbad29e">Fill</a>(basis);</div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span> </div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span>  <span class="comment">// now transition dipole elements for free interlevel transitions</span></div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno">  464</span>  std::array&lt;Eigen::MatrixXd, 3&gt; interlevel_dipoles;</div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span> </div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno">  466</span>  Eigen::MatrixXd empty = dft_orbitals.middleCols(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a0ce477afbebc6dcdde2be08370fedbb4">bse_cmin_</a>, <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a5795bda46e15d19f671c03797f49a8f7">bse_ctotal_</a>);</div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno">  467</span>  Eigen::MatrixXd occ = dft_orbitals.middleCols(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a019c308b9fda2ca4a0287c15df838c2e">bse_vmin_</a>, <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a558fe820c96cbcbea288396d9d54e9ff">bse_vtotal_</a>);</div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno">  468</span>  <span class="keywordflow">for</span> (<a class="code hl_typedef" href="namespacevotca.html#ad2c9da4f7634ac9c89e02a192345f276">Index</a> i = 0; i &lt; 3; i++) {</div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno">  469</span>    interlevel_dipoles[i] = empty.transpose() * dft_dipole.<a class="code hl_function" href="classvotca_1_1xtp_1_1AODipole.html#ab91f50dafeceb8155bd361c4a12969fb">Matrix</a>()[i] * occ;</div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span>  }</div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno">  471</span>  <span class="keywordflow">return</span> interlevel_dipoles;</div>
<div class="line"><a id="l00472" name="l00472"></a><span class="lineno">  472</span>}</div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno">  473</span> </div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno"><a class="line" href="classvotca_1_1xtp_1_1Orbitals.html#a11cdff1529e5aa6cbf542976d372d4ac">  474</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#a11cdff1529e5aa6cbf542976d372d4ac">Orbitals::CalcCoupledTransition_Dipoles</a>() {</div>
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno">  475</span>  std::array&lt;Eigen::MatrixXd, 3&gt; interlevel_dipoles =</div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span>      <a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#a62d22f5ad32fdcc936eda4a14ebace3a">CalcFreeTransition_Dipoles</a>();</div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno">  477</span>  <a class="code hl_typedef" href="namespacevotca.html#ad2c9da4f7634ac9c89e02a192345f276">Index</a> numofstates = <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a3901d86f0481b0fe1c38ce5c6e86dd34">BSE_singlet_</a>.<a class="code hl_function" href="classvotca_1_1tools_1_1EigenSystem.html#a8e7c2db1e04dcae085b3ba95d298dedd">eigenvalues</a>().size();</div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno">  478</span>  <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a76efd09e2816d4c6aa7168973314ddb0">transition_dipoles_</a>.resize(0);</div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno">  479</span>  <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a76efd09e2816d4c6aa7168973314ddb0">transition_dipoles_</a>.reserve(numofstates);</div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno">  480</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> sqrt2 = std::sqrt(2.0);</div>
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno">  481</span>  <span class="keywordflow">for</span> (<a class="code hl_typedef" href="namespacevotca.html#ad2c9da4f7634ac9c89e02a192345f276">Index</a> i_exc = 0; i_exc &lt; numofstates; i_exc++) {</div>
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno">  482</span> </div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span>    Eigen::VectorXd coeffs = <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a3901d86f0481b0fe1c38ce5c6e86dd34">BSE_singlet_</a>.<a class="code hl_function" href="classvotca_1_1tools_1_1EigenSystem.html#afd8f46808af0552ff1a6ef84a42fe595">eigenvectors</a>().col(i_exc);</div>
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno">  484</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a83029c41b0a8ca0933bc5abbe64e55fd">useTDA_</a>) {</div>
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno">  485</span>      coeffs += <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a3901d86f0481b0fe1c38ce5c6e86dd34">BSE_singlet_</a>.<a class="code hl_function" href="classvotca_1_1tools_1_1EigenSystem.html#a705cf773bc4108779d4b617ec0230136">eigenvectors2</a>().col(i_exc);</div>
<div class="line"><a id="l00486" name="l00486"></a><span class="lineno">  486</span>    }</div>
<div class="line"><a id="l00487" name="l00487"></a><span class="lineno">  487</span>    Eigen::Map&lt;Eigen::MatrixXd&gt; mat(coeffs.data(), <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a5795bda46e15d19f671c03797f49a8f7">bse_ctotal_</a>, <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a558fe820c96cbcbea288396d9d54e9ff">bse_vtotal_</a>);</div>
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno">  488</span>    Eigen::Vector3d tdipole = Eigen::Vector3d::Zero();</div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno">  489</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="namespacevotca.html#ad2c9da4f7634ac9c89e02a192345f276">Index</a> i = 0; i &lt; 3; i++) {</div>
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno">  490</span>      tdipole[i] = mat.cwiseProduct(interlevel_dipoles[i]).sum();</div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno">  491</span>    }</div>
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno">  492</span>    <span class="comment">// The Transition dipole is sqrt2 bigger because of the spin, the</span></div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno">  493</span>    <span class="comment">// excited state is a linear combination of 2 slater determinants,</span></div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span>    <span class="comment">// where either alpha or beta spin electron is excited</span></div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno">  495</span>    <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a76efd09e2816d4c6aa7168973314ddb0">transition_dipoles_</a>.push_back(-sqrt2 * tdipole);  <span class="comment">//- because electrons are</span></div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno">  496</span>                                                      <span class="comment">// negatively charged</span></div>
<div class="line"><a id="l00497" name="l00497"></a><span class="lineno">  497</span>  }</div>
<div class="line"><a id="l00498" name="l00498"></a><span class="lineno">  498</span>}</div>
<div class="line"><a id="l00499" name="l00499"></a><span class="lineno">  499</span> </div>
<div class="line"><a id="l00500" name="l00500"></a><span class="lineno"><a class="line" href="classvotca_1_1xtp_1_1Orbitals.html#af6f9e7eca2118d8a3d164a5633a3687a">  500</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#af6f9e7eca2118d8a3d164a5633a3687a">Orbitals::OrderMOsbyEnergy</a>() {</div>
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno">  501</span>  std::vector&lt;Index&gt; sort_index = <a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#a9aefc57e4347f374d3510f9a031038f9">SortEnergies</a>();</div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno">  502</span>  <a class="code hl_class" href="classvotca_1_1tools_1_1EigenSystem.html">tools::EigenSystem</a> MO_copy = <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#aa7de90dfd160a1dd838e0ef6e07e58d3">mos_</a>;</div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span>  <a class="code hl_typedef" href="namespacevotca.html#ad2c9da4f7634ac9c89e02a192345f276">Index</a> size = <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#aa7de90dfd160a1dd838e0ef6e07e58d3">mos_</a>.<a class="code hl_function" href="classvotca_1_1tools_1_1EigenSystem.html#a8e7c2db1e04dcae085b3ba95d298dedd">eigenvalues</a>().size();</div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span>  <span class="keywordflow">for</span> (<a class="code hl_typedef" href="namespacevotca.html#ad2c9da4f7634ac9c89e02a192345f276">Index</a> i = 0; i &lt; size; ++i) {</div>
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno">  505</span>    <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#aa7de90dfd160a1dd838e0ef6e07e58d3">mos_</a>.<a class="code hl_function" href="classvotca_1_1tools_1_1EigenSystem.html#a8e7c2db1e04dcae085b3ba95d298dedd">eigenvalues</a>()(i) = MO_copy.<a class="code hl_function" href="classvotca_1_1tools_1_1EigenSystem.html#a8e7c2db1e04dcae085b3ba95d298dedd">eigenvalues</a>()(sort_index[i]);</div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno">  506</span>  }</div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span>  <span class="keywordflow">for</span> (<a class="code hl_typedef" href="namespacevotca.html#ad2c9da4f7634ac9c89e02a192345f276">Index</a> i = 0; i &lt; size; ++i) {</div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span>    <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#aa7de90dfd160a1dd838e0ef6e07e58d3">mos_</a>.<a class="code hl_function" href="classvotca_1_1tools_1_1EigenSystem.html#afd8f46808af0552ff1a6ef84a42fe595">eigenvectors</a>().col(i) = MO_copy.<a class="code hl_function" href="classvotca_1_1tools_1_1EigenSystem.html#afd8f46808af0552ff1a6ef84a42fe595">eigenvectors</a>().col(sort_index[i]);</div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno">  509</span>  }</div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span>}</div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span> </div>
<div class="line"><a id="l00519" name="l00519"></a><span class="lineno"><a class="line" href="classvotca_1_1xtp_1_1Orbitals.html#a41a587073015356cea394d0d99ca18b3">  519</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#a41a587073015356cea394d0d99ca18b3">Orbitals::PrepareDimerGuess</a>(<span class="keyword">const</span> <a class="code hl_class" href="classvotca_1_1xtp_1_1Orbitals.html">Orbitals</a>&amp; orbitalsA,</div>
<div class="line"><a id="l00520" name="l00520"></a><span class="lineno">  520</span>                                 <span class="keyword">const</span> <a class="code hl_class" href="classvotca_1_1xtp_1_1Orbitals.html">Orbitals</a>&amp; orbitalsB) {</div>
<div class="line"><a id="l00521" name="l00521"></a><span class="lineno">  521</span> </div>
<div class="line"><a id="l00522" name="l00522"></a><span class="lineno">  522</span>  <span class="comment">// constructing the direct product orbA x orbB</span></div>
<div class="line"><a id="l00523" name="l00523"></a><span class="lineno">  523</span>  <a class="code hl_typedef" href="namespacevotca.html#ad2c9da4f7634ac9c89e02a192345f276">Index</a> basisA = orbitalsA.<a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#abb47a17f7c8b9a00615bd39b47280e6d">getBasisSetSize</a>();</div>
<div class="line"><a id="l00524" name="l00524"></a><span class="lineno">  524</span>  <a class="code hl_typedef" href="namespacevotca.html#ad2c9da4f7634ac9c89e02a192345f276">Index</a> basisB = orbitalsB.<a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#abb47a17f7c8b9a00615bd39b47280e6d">getBasisSetSize</a>();</div>
<div class="line"><a id="l00525" name="l00525"></a><span class="lineno">  525</span> </div>
<div class="line"><a id="l00526" name="l00526"></a><span class="lineno">  526</span>  <a class="code hl_typedef" href="namespacevotca.html#ad2c9da4f7634ac9c89e02a192345f276">Index</a> electronsA = orbitalsA.<a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#a5db16540d57ba3b4a27179d303621338">getNumberOfAlphaElectrons</a>();</div>
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno">  527</span>  <a class="code hl_typedef" href="namespacevotca.html#ad2c9da4f7634ac9c89e02a192345f276">Index</a> electronsB = orbitalsB.<a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#a5db16540d57ba3b4a27179d303621338">getNumberOfAlphaElectrons</a>();</div>
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno">  528</span> </div>
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno">  529</span>  <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#aa7de90dfd160a1dd838e0ef6e07e58d3">mos_</a>.<a class="code hl_function" href="classvotca_1_1tools_1_1EigenSystem.html#afd8f46808af0552ff1a6ef84a42fe595">eigenvectors</a>() = Eigen::MatrixXd::Zero(basisA + basisB, basisA + basisB);</div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span> </div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span>  <span class="comment">// AxB = | A 0 |  //   A = [EA, EB]  //</span></div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno">  532</span>  <span class="comment">//       | 0 B |  //                 //</span></div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span>  <span class="keywordflow">if</span> (orbitalsA.<a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#adacd859d9719647bca294b9d2e094a48">getDFTbasisName</a>() != orbitalsB.<a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#adacd859d9719647bca294b9d2e094a48">getDFTbasisName</a>()) {</div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span>    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Basissets of Orbitals A and B differ &quot;</span> +</div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno">  535</span>                             orbitalsA.<a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#adacd859d9719647bca294b9d2e094a48">getDFTbasisName</a>() + <span class="stringliteral">&quot;:&quot;</span> +</div>
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno">  536</span>                             orbitalsB.<a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#adacd859d9719647bca294b9d2e094a48">getDFTbasisName</a>());</div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span>  }</div>
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno">  538</span>  this-&gt;<a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#adcab9d59437f5a1cfca97c18596b9fad">SetupDftBasis</a>(orbitalsA.<a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#adacd859d9719647bca294b9d2e094a48">getDFTbasisName</a>());</div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span>  <span class="keywordflow">if</span> (orbitalsA.<a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#ada61929c2682423290344d8fe65f36dd">getECPName</a>() != orbitalsB.<a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#ada61929c2682423290344d8fe65f36dd">getECPName</a>()) {</div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span>    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;ECPs of Orbitals A and B differ &quot;</span> +</div>
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno">  541</span>                             orbitalsA.<a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#ada61929c2682423290344d8fe65f36dd">getECPName</a>() + <span class="stringliteral">&quot;:&quot;</span> +</div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno">  542</span>                             orbitalsB.<a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#ada61929c2682423290344d8fe65f36dd">getECPName</a>());</div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span>  }</div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno">  544</span>  this-&gt;<a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#aa21cdb66a5a9f0fe7eac3e7e9f03673b">setECPName</a>(orbitalsA.<a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#ada61929c2682423290344d8fe65f36dd">getECPName</a>());</div>
<div class="line"><a id="l00545" name="l00545"></a><span class="lineno">  545</span>  this-&gt;<a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#aa2dcab363f170efe3bc1c66828eb6694">setNumberOfOccupiedLevels</a>(electronsA + electronsB);</div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno">  546</span>  this-&gt;<a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#a6f459f45583890e0f8c203888977cfce">setNumberOfAlphaElectrons</a>(electronsA + electronsB);</div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno">  547</span> </div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno">  548</span>  <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#aa7de90dfd160a1dd838e0ef6e07e58d3">mos_</a>.<a class="code hl_function" href="classvotca_1_1tools_1_1EigenSystem.html#afd8f46808af0552ff1a6ef84a42fe595">eigenvectors</a>().topLeftCorner(basisA, basisA) =</div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno">  549</span>      orbitalsA.<a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#ac4583263da9e2f946951ab955035abdf">MOs</a>().<a class="code hl_function" href="classvotca_1_1tools_1_1EigenSystem.html#afd8f46808af0552ff1a6ef84a42fe595">eigenvectors</a>();</div>
<div class="line"><a id="l00550" name="l00550"></a><span class="lineno">  550</span>  <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#aa7de90dfd160a1dd838e0ef6e07e58d3">mos_</a>.<a class="code hl_function" href="classvotca_1_1tools_1_1EigenSystem.html#afd8f46808af0552ff1a6ef84a42fe595">eigenvectors</a>().bottomRightCorner(basisB, basisB) =</div>
<div class="line"><a id="l00551" name="l00551"></a><span class="lineno">  551</span>      orbitalsB.<a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#ac4583263da9e2f946951ab955035abdf">MOs</a>().<a class="code hl_function" href="classvotca_1_1tools_1_1EigenSystem.html#afd8f46808af0552ff1a6ef84a42fe595">eigenvectors</a>();</div>
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno">  552</span> </div>
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno">  553</span>  <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#aa7de90dfd160a1dd838e0ef6e07e58d3">mos_</a>.<a class="code hl_function" href="classvotca_1_1tools_1_1EigenSystem.html#a8e7c2db1e04dcae085b3ba95d298dedd">eigenvalues</a>().resize(basisA + basisB);</div>
<div class="line"><a id="l00554" name="l00554"></a><span class="lineno">  554</span> </div>
<div class="line"><a id="l00555" name="l00555"></a><span class="lineno">  555</span>  <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#aa7de90dfd160a1dd838e0ef6e07e58d3">mos_</a>.<a class="code hl_function" href="classvotca_1_1tools_1_1EigenSystem.html#a8e7c2db1e04dcae085b3ba95d298dedd">eigenvalues</a>().head(basisA) = orbitalsA.<a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#ac4583263da9e2f946951ab955035abdf">MOs</a>().<a class="code hl_function" href="classvotca_1_1tools_1_1EigenSystem.html#a8e7c2db1e04dcae085b3ba95d298dedd">eigenvalues</a>();</div>
<div class="line"><a id="l00556" name="l00556"></a><span class="lineno">  556</span>  <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#aa7de90dfd160a1dd838e0ef6e07e58d3">mos_</a>.<a class="code hl_function" href="classvotca_1_1tools_1_1EigenSystem.html#a8e7c2db1e04dcae085b3ba95d298dedd">eigenvalues</a>().tail(basisB) = orbitalsB.<a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#ac4583263da9e2f946951ab955035abdf">MOs</a>().<a class="code hl_function" href="classvotca_1_1tools_1_1EigenSystem.html#a8e7c2db1e04dcae085b3ba95d298dedd">eigenvalues</a>();</div>
<div class="line"><a id="l00557" name="l00557"></a><span class="lineno">  557</span> </div>
<div class="line"><a id="l00558" name="l00558"></a><span class="lineno">  558</span>  <a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#af6f9e7eca2118d8a3d164a5633a3687a">OrderMOsbyEnergy</a>();</div>
<div class="line"><a id="l00559" name="l00559"></a><span class="lineno">  559</span> </div>
<div class="line"><a id="l00560" name="l00560"></a><span class="lineno">  560</span>  <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00561" name="l00561"></a><span class="lineno">  561</span>}</div>
<div class="line"><a id="l00562" name="l00562"></a><span class="lineno">  562</span> </div>
<div class="line"><a id="l00563" name="l00563"></a><span class="lineno"><a class="line" href="classvotca_1_1xtp_1_1Orbitals.html#ad88f75689f181f9249c0ab1c9252b6d4">  563</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#ad88f75689f181f9249c0ab1c9252b6d4">Orbitals::WriteToCpt</a>(<span class="keyword">const</span> std::string&amp; filename)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00564" name="l00564"></a><span class="lineno">  564</span>  <a class="code hl_class" href="classvotca_1_1xtp_1_1CheckpointFile.html">CheckpointFile</a> cpf(filename, <a class="code hl_enumvalue" href="namespacevotca_1_1xtp.html#ac8a3228f3752676abb9e23158681ec50a294ce20cdefa29be3be0735cb62e715d">CheckpointAccessLevel::CREATE</a>);</div>
<div class="line"><a id="l00565" name="l00565"></a><span class="lineno">  565</span>  <a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#ad88f75689f181f9249c0ab1c9252b6d4">WriteToCpt</a>(cpf);</div>
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno">  566</span>}</div>
<div class="line"><a id="l00567" name="l00567"></a><span class="lineno">  567</span> </div>
<div class="line"><a id="l00568" name="l00568"></a><span class="lineno"><a class="line" href="classvotca_1_1xtp_1_1Orbitals.html#a72ddbe4c0af7a2ac0286eb0d084a76bd">  568</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#ad88f75689f181f9249c0ab1c9252b6d4">Orbitals::WriteToCpt</a>(<a class="code hl_class" href="classvotca_1_1xtp_1_1CheckpointFile.html">CheckpointFile</a> f)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00569" name="l00569"></a><span class="lineno">  569</span>  <a class="code hl_class" href="classvotca_1_1xtp_1_1CheckpointWriter.html">CheckpointWriter</a> writer = f.<a class="code hl_function" href="classvotca_1_1xtp_1_1CheckpointFile.html#ad319fa7f695339c87749e4e4c5e10fbc">getWriter</a>(<span class="stringliteral">&quot;/QMdata&quot;</span>);</div>
<div class="line"><a id="l00570" name="l00570"></a><span class="lineno">  570</span>  <a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#ad88f75689f181f9249c0ab1c9252b6d4">WriteToCpt</a>(writer);</div>
<div class="line"><a id="l00571" name="l00571"></a><span class="lineno">  571</span>  <a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#a7de1c8ea52402b0c82e2455f61e98c8d">WriteBasisSetsToCpt</a>(writer);</div>
<div class="line"><a id="l00572" name="l00572"></a><span class="lineno">  572</span>}</div>
<div class="line"><a id="l00573" name="l00573"></a><span class="lineno">  573</span> </div>
<div class="line"><a id="l00574" name="l00574"></a><span class="lineno"><a class="line" href="classvotca_1_1xtp_1_1Orbitals.html#a7de1c8ea52402b0c82e2455f61e98c8d">  574</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#a7de1c8ea52402b0c82e2455f61e98c8d">Orbitals::WriteBasisSetsToCpt</a>(<a class="code hl_class" href="classvotca_1_1xtp_1_1CheckpointWriter.html">CheckpointWriter</a> w)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00575" name="l00575"></a><span class="lineno">  575</span>  <a class="code hl_class" href="classvotca_1_1xtp_1_1CheckpointWriter.html">CheckpointWriter</a> dftWriter = w.<a class="code hl_function" href="classvotca_1_1xtp_1_1CheckpointWriter.html#a78ce9e4c33cb65827075ae49624884df">openChild</a>(<span class="stringliteral">&quot;dft&quot;</span>);</div>
<div class="line"><a id="l00576" name="l00576"></a><span class="lineno">  576</span>  <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a4aa6c1ce5ac6f1d6f80f13d52a039c2c">dftbasis_</a>.<a class="code hl_function" href="classvotca_1_1xtp_1_1AOBasis.html#a86e322e256c12c5ab2e2a13044c11395">WriteToCpt</a>(dftWriter);</div>
<div class="line"><a id="l00577" name="l00577"></a><span class="lineno">  577</span>  <a class="code hl_class" href="classvotca_1_1xtp_1_1CheckpointWriter.html">CheckpointWriter</a> auxWriter = w.<a class="code hl_function" href="classvotca_1_1xtp_1_1CheckpointWriter.html#a78ce9e4c33cb65827075ae49624884df">openChild</a>(<span class="stringliteral">&quot;aux&quot;</span>);</div>
<div class="line"><a id="l00578" name="l00578"></a><span class="lineno">  578</span>  <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#ac343e12cc6b5e6d708e6fd9ab3970b11">auxbasis_</a>.<a class="code hl_function" href="classvotca_1_1xtp_1_1AOBasis.html#a86e322e256c12c5ab2e2a13044c11395">WriteToCpt</a>(auxWriter);</div>
<div class="line"><a id="l00579" name="l00579"></a><span class="lineno">  579</span>}</div>
<div class="line"><a id="l00580" name="l00580"></a><span class="lineno">  580</span> </div>
<div class="line"><a id="l00581" name="l00581"></a><span class="lineno"><a class="line" href="classvotca_1_1xtp_1_1Orbitals.html#a6a691bbe1765b99d3c14cebceb447188">  581</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#ad88f75689f181f9249c0ab1c9252b6d4">Orbitals::WriteToCpt</a>(<a class="code hl_class" href="classvotca_1_1xtp_1_1CheckpointWriter.html">CheckpointWriter</a> w)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00582" name="l00582"></a><span class="lineno">  582</span>  w(<a class="code hl_function" href="namespacevotca_1_1xtp.html#a3b11bfd421bce407b7040b254e5ced05">XtpVersionStr</a>(), <span class="stringliteral">&quot;XTPVersion&quot;</span>);</div>
<div class="line"><a id="l00583" name="l00583"></a><span class="lineno">  583</span>  w(<a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#a77cbe26b9ffd389e8af85ae09dba3562">orbitals_version</a>(), <span class="stringliteral">&quot;version&quot;</span>);</div>
<div class="line"><a id="l00584" name="l00584"></a><span class="lineno">  584</span>  w(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a2f5b8affcf9cb39392b5aaefbbffe375">basis_set_size_</a>, <span class="stringliteral">&quot;basis_set_size&quot;</span>);</div>
<div class="line"><a id="l00585" name="l00585"></a><span class="lineno">  585</span>  w(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#acbeb7caec928a11684f1ff366ff59df1">occupied_levels_</a>, <span class="stringliteral">&quot;occupied_levels&quot;</span>);</div>
<div class="line"><a id="l00586" name="l00586"></a><span class="lineno">  586</span>  w(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#aea075152677ce6bcaf842dedd8ba07e7">number_alpha_electrons_</a>, <span class="stringliteral">&quot;number_alpha_electrons&quot;</span>);</div>
<div class="line"><a id="l00587" name="l00587"></a><span class="lineno">  587</span> </div>
<div class="line"><a id="l00588" name="l00588"></a><span class="lineno">  588</span>  w(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#aa7de90dfd160a1dd838e0ef6e07e58d3">mos_</a>, <span class="stringliteral">&quot;mos&quot;</span>);</div>
<div class="line"><a id="l00589" name="l00589"></a><span class="lineno">  589</span>  w(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a4fba652bab475583863c37d38c40c3ef">active_electrons_</a>, <span class="stringliteral">&quot;active_electrons&quot;</span>);</div>
<div class="line"><a id="l00590" name="l00590"></a><span class="lineno">  590</span>  w(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#ac7674b36b098e7e09cb4c950824dbe42">mos_embedding_</a>, <span class="stringliteral">&quot;mos_embedding&quot;</span>);</div>
<div class="line"><a id="l00591" name="l00591"></a><span class="lineno">  591</span>  w(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a79b3229a2642b98241ae5100e75c0719">lmos_</a>, <span class="stringliteral">&quot;LMOs&quot;</span>);</div>
<div class="line"><a id="l00592" name="l00592"></a><span class="lineno">  592</span>  w(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a304e2b3db425c758f159717312263016">lmos_energies_</a>, <span class="stringliteral">&quot;LMOs_energies&quot;</span>);</div>
<div class="line"><a id="l00593" name="l00593"></a><span class="lineno">  593</span> </div>
<div class="line"><a id="l00594" name="l00594"></a><span class="lineno">  594</span>  <a class="code hl_class" href="classvotca_1_1xtp_1_1CheckpointWriter.html">CheckpointWriter</a> molgroup = w.<a class="code hl_function" href="classvotca_1_1xtp_1_1CheckpointWriter.html#a78ce9e4c33cb65827075ae49624884df">openChild</a>(<span class="stringliteral">&quot;qmmolecule&quot;</span>);</div>
<div class="line"><a id="l00595" name="l00595"></a><span class="lineno">  595</span>  <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#af7e77d477a6ab54b0214c01d07b8887f">atoms_</a>.<a class="code hl_function" href="classvotca_1_1xtp_1_1AtomContainer.html#a04e6531d3130971e7ab62986b764aeab">WriteToCpt</a>(molgroup);</div>
<div class="line"><a id="l00596" name="l00596"></a><span class="lineno">  596</span> </div>
<div class="line"><a id="l00597" name="l00597"></a><span class="lineno">  597</span>  w(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#aef4feb1701a23cc426584c53a7839ae5">qm_energy_</a>, <span class="stringliteral">&quot;qm_energy&quot;</span>);</div>
<div class="line"><a id="l00598" name="l00598"></a><span class="lineno">  598</span>  w(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a8c17f47cb508cb22680dd430e16adc6b">qm_package_</a>, <span class="stringliteral">&quot;qm_package&quot;</span>);</div>
<div class="line"><a id="l00599" name="l00599"></a><span class="lineno">  599</span> </div>
<div class="line"><a id="l00600" name="l00600"></a><span class="lineno">  600</span>  w(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a6a44a4319f15d3f4022acb194ba70076">rpamin_</a>, <span class="stringliteral">&quot;rpamin&quot;</span>);</div>
<div class="line"><a id="l00601" name="l00601"></a><span class="lineno">  601</span>  w(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#aea2ed9a51f7ece9dd773654234125c9e">rpamax_</a>, <span class="stringliteral">&quot;rpamax&quot;</span>);</div>
<div class="line"><a id="l00602" name="l00602"></a><span class="lineno">  602</span>  w(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#ab6c4b68ab342ea95c03d25336d2b8813">qpmin_</a>, <span class="stringliteral">&quot;qpmin&quot;</span>);</div>
<div class="line"><a id="l00603" name="l00603"></a><span class="lineno">  603</span>  w(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a4d4b98307e22f87e591a1812a959d807">qpmax_</a>, <span class="stringliteral">&quot;qpmax&quot;</span>);</div>
<div class="line"><a id="l00604" name="l00604"></a><span class="lineno">  604</span>  w(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a019c308b9fda2ca4a0287c15df838c2e">bse_vmin_</a>, <span class="stringliteral">&quot;bse_vmin&quot;</span>);</div>
<div class="line"><a id="l00605" name="l00605"></a><span class="lineno">  605</span>  w(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#acd753d714099af878d22c73e9e981afd">bse_cmax_</a>, <span class="stringliteral">&quot;bse_cmax&quot;</span>);</div>
<div class="line"><a id="l00606" name="l00606"></a><span class="lineno">  606</span>  w(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a7968485ad53f67e20aede0bd47fae597">functionalname_</a>, <span class="stringliteral">&quot;XCFunctional&quot;</span>);</div>
<div class="line"><a id="l00607" name="l00607"></a><span class="lineno">  607</span>  w(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a45fd3dd6cfb1af473af238948cc27470">grid_quality_</a>, <span class="stringliteral">&quot;XC_grid_quality&quot;</span>);</div>
<div class="line"><a id="l00608" name="l00608"></a><span class="lineno">  608</span>  w(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a40ede97da45d7dbc493e70051711e3f2">ScaHFX_</a>, <span class="stringliteral">&quot;ScaHFX&quot;</span>);</div>
<div class="line"><a id="l00609" name="l00609"></a><span class="lineno">  609</span> </div>
<div class="line"><a id="l00610" name="l00610"></a><span class="lineno">  610</span>  w(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a83029c41b0a8ca0933bc5abbe64e55fd">useTDA_</a>, <span class="stringliteral">&quot;useTDA&quot;</span>);</div>
<div class="line"><a id="l00611" name="l00611"></a><span class="lineno">  611</span>  w(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#ae96163a724d7162d59d1f7b2f024ca5d">ECP_</a>, <span class="stringliteral">&quot;ECP&quot;</span>);</div>
<div class="line"><a id="l00612" name="l00612"></a><span class="lineno">  612</span> </div>
<div class="line"><a id="l00613" name="l00613"></a><span class="lineno">  613</span>  w(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a15ab546770dc2e8a292664ddeda5fb8f">rpa_inputenergies_</a>, <span class="stringliteral">&quot;RPA_inputenergies&quot;</span>);</div>
<div class="line"><a id="l00614" name="l00614"></a><span class="lineno">  614</span>  w(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#ad870997ffd78d9f55e3ae4d6dc874a87">QPpert_energies_</a>, <span class="stringliteral">&quot;QPpert_energies&quot;</span>);</div>
<div class="line"><a id="l00615" name="l00615"></a><span class="lineno">  615</span> </div>
<div class="line"><a id="l00616" name="l00616"></a><span class="lineno">  616</span>  w(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#aac5c74b33ec36fbeaafdd154d1a6c722">QPdiag_</a>, <span class="stringliteral">&quot;QPdiag&quot;</span>);</div>
<div class="line"><a id="l00617" name="l00617"></a><span class="lineno">  617</span> </div>
<div class="line"><a id="l00618" name="l00618"></a><span class="lineno">  618</span>  w(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a3901d86f0481b0fe1c38ce5c6e86dd34">BSE_singlet_</a>, <span class="stringliteral">&quot;BSE_singlet&quot;</span>);</div>
<div class="line"><a id="l00619" name="l00619"></a><span class="lineno">  619</span> </div>
<div class="line"><a id="l00620" name="l00620"></a><span class="lineno">  620</span>  w(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a76efd09e2816d4c6aa7168973314ddb0">transition_dipoles_</a>, <span class="stringliteral">&quot;transition_dipoles&quot;</span>);</div>
<div class="line"><a id="l00621" name="l00621"></a><span class="lineno">  621</span> </div>
<div class="line"><a id="l00622" name="l00622"></a><span class="lineno">  622</span>  w(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a8f706b2f707e8ab94f9947d4dce92eb0">BSE_triplet_</a>, <span class="stringliteral">&quot;BSE_triplet&quot;</span>);</div>
<div class="line"><a id="l00623" name="l00623"></a><span class="lineno">  623</span> </div>
<div class="line"><a id="l00624" name="l00624"></a><span class="lineno">  624</span>  w(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#acb49fb909223157852bb573e0e1a8428">use_Hqp_offdiag_</a>, <span class="stringliteral">&quot;use_Hqp_offdiag&quot;</span>);</div>
<div class="line"><a id="l00625" name="l00625"></a><span class="lineno">  625</span> </div>
<div class="line"><a id="l00626" name="l00626"></a><span class="lineno">  626</span>  w(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#abfcfa4abb9e4dfc0d073b347c995b3cb">BSE_singlet_energies_dynamic_</a>, <span class="stringliteral">&quot;BSE_singlet_dynamic&quot;</span>);</div>
<div class="line"><a id="l00627" name="l00627"></a><span class="lineno">  627</span> </div>
<div class="line"><a id="l00628" name="l00628"></a><span class="lineno">  628</span>  w(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a4b101fea55c3f302c1c550d0aaadb9df">BSE_triplet_energies_dynamic_</a>, <span class="stringliteral">&quot;BSE_triplet_dynamic&quot;</span>);</div>
<div class="line"><a id="l00629" name="l00629"></a><span class="lineno">  629</span>}</div>
<div class="line"><a id="l00630" name="l00630"></a><span class="lineno">  630</span> </div>
<div class="line"><a id="l00631" name="l00631"></a><span class="lineno"><a class="line" href="classvotca_1_1xtp_1_1Orbitals.html#acf1cb49e9bc057eccd9e8cc4ea81b60b">  631</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#acf1cb49e9bc057eccd9e8cc4ea81b60b">Orbitals::ReadFromCpt</a>(<span class="keyword">const</span> std::string&amp; filename) {</div>
<div class="line"><a id="l00632" name="l00632"></a><span class="lineno">  632</span>  <a class="code hl_class" href="classvotca_1_1xtp_1_1CheckpointFile.html">CheckpointFile</a> cpf(filename, <a class="code hl_enumvalue" href="namespacevotca_1_1xtp.html#ac8a3228f3752676abb9e23158681ec50a3466fab4975481651940ed328aa990e4">CheckpointAccessLevel::READ</a>);</div>
<div class="line"><a id="l00633" name="l00633"></a><span class="lineno">  633</span>  <a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#acf1cb49e9bc057eccd9e8cc4ea81b60b">ReadFromCpt</a>(cpf);</div>
<div class="line"><a id="l00634" name="l00634"></a><span class="lineno">  634</span>}</div>
<div class="line"><a id="l00635" name="l00635"></a><span class="lineno">  635</span> </div>
<div class="line"><a id="l00636" name="l00636"></a><span class="lineno"><a class="line" href="classvotca_1_1xtp_1_1Orbitals.html#ab33e6e026d4d7a7114eab67fe15cbc75">  636</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#acf1cb49e9bc057eccd9e8cc4ea81b60b">Orbitals::ReadFromCpt</a>(<a class="code hl_class" href="classvotca_1_1xtp_1_1CheckpointFile.html">CheckpointFile</a> f) {</div>
<div class="line"><a id="l00637" name="l00637"></a><span class="lineno">  637</span>  <a class="code hl_class" href="classvotca_1_1xtp_1_1CheckpointReader.html">CheckpointReader</a> reader = f.<a class="code hl_function" href="classvotca_1_1xtp_1_1CheckpointFile.html#a50ed07f6719ba2381fc510251dc3089c">getReader</a>(<span class="stringliteral">&quot;/QMdata&quot;</span>);</div>
<div class="line"><a id="l00638" name="l00638"></a><span class="lineno">  638</span>  <a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#acf1cb49e9bc057eccd9e8cc4ea81b60b">ReadFromCpt</a>(reader);</div>
<div class="line"><a id="l00639" name="l00639"></a><span class="lineno">  639</span>  <a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#a1b405de9e2d38dc0dfbfd09dcf290d31">ReadBasisSetsFromCpt</a>(reader);</div>
<div class="line"><a id="l00640" name="l00640"></a><span class="lineno">  640</span>}</div>
<div class="line"><a id="l00641" name="l00641"></a><span class="lineno">  641</span> </div>
<div class="line"><a id="l00642" name="l00642"></a><span class="lineno"><a class="line" href="classvotca_1_1xtp_1_1Orbitals.html#a1b405de9e2d38dc0dfbfd09dcf290d31">  642</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#a1b405de9e2d38dc0dfbfd09dcf290d31">Orbitals::ReadBasisSetsFromCpt</a>(<a class="code hl_class" href="classvotca_1_1xtp_1_1CheckpointReader.html">CheckpointReader</a> r) {</div>
<div class="line"><a id="l00643" name="l00643"></a><span class="lineno">  643</span>  <a class="code hl_class" href="classvotca_1_1xtp_1_1CheckpointReader.html">CheckpointReader</a> dftReader = r.<a class="code hl_function" href="classvotca_1_1xtp_1_1CheckpointReader.html#ab1a8ab5ce25c90037b18b1648e8ff98e">openChild</a>(<span class="stringliteral">&quot;dft&quot;</span>);</div>
<div class="line"><a id="l00644" name="l00644"></a><span class="lineno">  644</span>  <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a4aa6c1ce5ac6f1d6f80f13d52a039c2c">dftbasis_</a>.<a class="code hl_function" href="classvotca_1_1xtp_1_1AOBasis.html#a8f1f130b9a0bb9cdd8b51e0d8b6a5e68">ReadFromCpt</a>(dftReader);</div>
<div class="line"><a id="l00645" name="l00645"></a><span class="lineno">  645</span>  <a class="code hl_class" href="classvotca_1_1xtp_1_1CheckpointReader.html">CheckpointReader</a> auxReader = r.<a class="code hl_function" href="classvotca_1_1xtp_1_1CheckpointReader.html#ab1a8ab5ce25c90037b18b1648e8ff98e">openChild</a>(<span class="stringliteral">&quot;aux&quot;</span>);</div>
<div class="line"><a id="l00646" name="l00646"></a><span class="lineno">  646</span>  <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#ac343e12cc6b5e6d708e6fd9ab3970b11">auxbasis_</a>.<a class="code hl_function" href="classvotca_1_1xtp_1_1AOBasis.html#a8f1f130b9a0bb9cdd8b51e0d8b6a5e68">ReadFromCpt</a>(auxReader);</div>
<div class="line"><a id="l00647" name="l00647"></a><span class="lineno">  647</span>}</div>
<div class="line"><a id="l00648" name="l00648"></a><span class="lineno">  648</span> </div>
<div class="line"><a id="l00649" name="l00649"></a><span class="lineno"><a class="line" href="classvotca_1_1xtp_1_1Orbitals.html#a552ffd5405a5850ebd8ee20c470b58c3">  649</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#acf1cb49e9bc057eccd9e8cc4ea81b60b">Orbitals::ReadFromCpt</a>(<a class="code hl_class" href="classvotca_1_1xtp_1_1CheckpointReader.html">CheckpointReader</a> r) {</div>
<div class="line"><a id="l00650" name="l00650"></a><span class="lineno">  650</span>  r(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a2f5b8affcf9cb39392b5aaefbbffe375">basis_set_size_</a>, <span class="stringliteral">&quot;basis_set_size&quot;</span>);</div>
<div class="line"><a id="l00651" name="l00651"></a><span class="lineno">  651</span>  r(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#acbeb7caec928a11684f1ff366ff59df1">occupied_levels_</a>, <span class="stringliteral">&quot;occupied_levels&quot;</span>);</div>
<div class="line"><a id="l00652" name="l00652"></a><span class="lineno">  652</span>  r(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#aea075152677ce6bcaf842dedd8ba07e7">number_alpha_electrons_</a>, <span class="stringliteral">&quot;number_alpha_electrons&quot;</span>);</div>
<div class="line"><a id="l00653" name="l00653"></a><span class="lineno">  653</span>  <span class="keywordtype">int</span> version;</div>
<div class="line"><a id="l00654" name="l00654"></a><span class="lineno">  654</span>  r(version, <span class="stringliteral">&quot;version&quot;</span>);</div>
<div class="line"><a id="l00655" name="l00655"></a><span class="lineno">  655</span>  <span class="comment">// Read qmatoms</span></div>
<div class="line"><a id="l00656" name="l00656"></a><span class="lineno">  656</span>  <a class="code hl_class" href="classvotca_1_1xtp_1_1CheckpointReader.html">CheckpointReader</a> molgroup = r.<a class="code hl_function" href="classvotca_1_1xtp_1_1CheckpointReader.html#ab1a8ab5ce25c90037b18b1648e8ff98e">openChild</a>(<span class="stringliteral">&quot;qmmolecule&quot;</span>);</div>
<div class="line"><a id="l00657" name="l00657"></a><span class="lineno">  657</span>  <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#af7e77d477a6ab54b0214c01d07b8887f">atoms_</a>.<a class="code hl_function" href="classvotca_1_1xtp_1_1AtomContainer.html#a599735cbc5531cac9967b5cfcc2bcdd5">ReadFromCpt</a>(molgroup);</div>
<div class="line"><a id="l00658" name="l00658"></a><span class="lineno">  658</span> </div>
<div class="line"><a id="l00659" name="l00659"></a><span class="lineno">  659</span>  r(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#aef4feb1701a23cc426584c53a7839ae5">qm_energy_</a>, <span class="stringliteral">&quot;qm_energy&quot;</span>);</div>
<div class="line"><a id="l00660" name="l00660"></a><span class="lineno">  660</span>  r(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a8c17f47cb508cb22680dd430e16adc6b">qm_package_</a>, <span class="stringliteral">&quot;qm_package&quot;</span>);</div>
<div class="line"><a id="l00661" name="l00661"></a><span class="lineno">  661</span>  <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l00662" name="l00662"></a><span class="lineno">  662</span>    r(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a79b3229a2642b98241ae5100e75c0719">lmos_</a>, <span class="stringliteral">&quot;LMOs&quot;</span>);</div>
<div class="line"><a id="l00663" name="l00663"></a><span class="lineno">  663</span>    r(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a304e2b3db425c758f159717312263016">lmos_energies_</a>, <span class="stringliteral">&quot;LMOs_energies&quot;</span>);</div>
<div class="line"><a id="l00664" name="l00664"></a><span class="lineno">  664</span>  } <span class="keywordflow">catch</span> (std::runtime_error&amp; <a class="code hl_enumvalue" href="namespacevotca_1_1tools.html#ad593ffcbc7a96312e5f11b81700aad17a5dd80bccefb34f7ef1ca94ef17e9612f">e</a>) {</div>
<div class="line"><a id="l00665" name="l00665"></a><span class="lineno">  665</span>    ;</div>
<div class="line"><a id="l00666" name="l00666"></a><span class="lineno">  666</span>  }</div>
<div class="line"><a id="l00667" name="l00667"></a><span class="lineno">  667</span> </div>
<div class="line"><a id="l00668" name="l00668"></a><span class="lineno">  668</span>  r(version, <span class="stringliteral">&quot;version&quot;</span>);</div>
<div class="line"><a id="l00669" name="l00669"></a><span class="lineno">  669</span>  r(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#aa7de90dfd160a1dd838e0ef6e07e58d3">mos_</a>, <span class="stringliteral">&quot;mos&quot;</span>);</div>
<div class="line"><a id="l00670" name="l00670"></a><span class="lineno">  670</span>  r(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#ac7674b36b098e7e09cb4c950824dbe42">mos_embedding_</a>, <span class="stringliteral">&quot;mos_embedding&quot;</span>);</div>
<div class="line"><a id="l00671" name="l00671"></a><span class="lineno">  671</span>  r(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a4fba652bab475583863c37d38c40c3ef">active_electrons_</a>, <span class="stringliteral">&quot;active_electrons&quot;</span>);</div>
<div class="line"><a id="l00672" name="l00672"></a><span class="lineno">  672</span> </div>
<div class="line"><a id="l00673" name="l00673"></a><span class="lineno">  673</span>  <span class="keywordflow">if</span> (version &lt; 3) {</div>
<div class="line"><a id="l00674" name="l00674"></a><span class="lineno">  674</span>    <span class="comment">// clang-format off</span></div>
<div class="line"><a id="l00675" name="l00675"></a><span class="lineno">  675</span>    std::array&lt;Index, 49&gt; votcaOrder_old = {</div>
<div class="line"><a id="l00676" name="l00676"></a><span class="lineno">  676</span>        0,                             <span class="comment">// s</span></div>
<div class="line"><a id="l00677" name="l00677"></a><span class="lineno">  677</span>        0, -1, 1,                      <span class="comment">// p</span></div>
<div class="line"><a id="l00678" name="l00678"></a><span class="lineno">  678</span>        0, -1, 1, -2, 2,               <span class="comment">// d</span></div>
<div class="line"><a id="l00679" name="l00679"></a><span class="lineno">  679</span>        0, -1, 1, -2, 2, -3, 3,        <span class="comment">// f</span></div>
<div class="line"><a id="l00680" name="l00680"></a><span class="lineno">  680</span>        0, -1, 1, -2, 2, -3, 3, -4, 4,  <span class="comment">// g</span></div>
<div class="line"><a id="l00681" name="l00681"></a><span class="lineno">  681</span>        0, -1, 1, -2, 2, -3, 3, -4, 4,-5,5,  <span class="comment">// h</span></div>
<div class="line"><a id="l00682" name="l00682"></a><span class="lineno">  682</span>        0, -1, 1, -2, 2, -3, 3, -4, 4,-5,5,-6,6  <span class="comment">// i</span></div>
<div class="line"><a id="l00683" name="l00683"></a><span class="lineno">  683</span>    };</div>
<div class="line"><a id="l00684" name="l00684"></a><span class="lineno">  684</span>    <span class="comment">// clang-format on</span></div>
<div class="line"><a id="l00685" name="l00685"></a><span class="lineno">  685</span> </div>
<div class="line"><a id="l00686" name="l00686"></a><span class="lineno">  686</span>    std::array&lt;Index, 49&gt; multiplier;</div>
<div class="line"><a id="l00687" name="l00687"></a><span class="lineno">  687</span>    multiplier.fill(1);</div>
<div class="line"><a id="l00688" name="l00688"></a><span class="lineno">  688</span>    <a class="code hl_class" href="classvotca_1_1xtp_1_1OrbReorder.html">OrbReorder</a> ord(votcaOrder_old, multiplier);</div>
<div class="line"><a id="l00689" name="l00689"></a><span class="lineno">  689</span>    ord.<a class="code hl_function" href="classvotca_1_1xtp_1_1OrbReorder.html#a4b6c8d385e57855d8631db04e5dd162f">reorderOrbitals</a>(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#aa7de90dfd160a1dd838e0ef6e07e58d3">mos_</a>.<a class="code hl_function" href="classvotca_1_1tools_1_1EigenSystem.html#afd8f46808af0552ff1a6ef84a42fe595">eigenvectors</a>(), this-&gt;getDftBasis());</div>
<div class="line"><a id="l00690" name="l00690"></a><span class="lineno">  690</span>  }</div>
<div class="line"><a id="l00691" name="l00691"></a><span class="lineno">  691</span> </div>
<div class="line"><a id="l00692" name="l00692"></a><span class="lineno">  692</span>  <span class="keywordflow">if</span> (version &lt; 5) {  <span class="comment">// we need to construct the basissets, NB. can only be</span></div>
<div class="line"><a id="l00693" name="l00693"></a><span class="lineno">  693</span>                      <span class="comment">// done after reading the atoms.</span></div>
<div class="line"><a id="l00694" name="l00694"></a><span class="lineno">  694</span>    std::string dft_basis_name;</div>
<div class="line"><a id="l00695" name="l00695"></a><span class="lineno">  695</span>    std::string aux_basis_name;</div>
<div class="line"><a id="l00696" name="l00696"></a><span class="lineno">  696</span>    r(dft_basis_name, <span class="stringliteral">&quot;dftbasis&quot;</span>);</div>
<div class="line"><a id="l00697" name="l00697"></a><span class="lineno">  697</span>    r(aux_basis_name, <span class="stringliteral">&quot;auxbasis&quot;</span>);</div>
<div class="line"><a id="l00698" name="l00698"></a><span class="lineno">  698</span>    this-&gt;<a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#adcab9d59437f5a1cfca97c18596b9fad">SetupDftBasis</a>(dft_basis_name);</div>
<div class="line"><a id="l00699" name="l00699"></a><span class="lineno">  699</span>    this-&gt;<a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#a8b8b606ff6c1c7742cd6f69af0f992cf">SetupAuxBasis</a>(aux_basis_name);</div>
<div class="line"><a id="l00700" name="l00700"></a><span class="lineno">  700</span>  }</div>
<div class="line"><a id="l00701" name="l00701"></a><span class="lineno">  701</span> </div>
<div class="line"><a id="l00702" name="l00702"></a><span class="lineno">  702</span>  r(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a6a44a4319f15d3f4022acb194ba70076">rpamin_</a>, <span class="stringliteral">&quot;rpamin&quot;</span>);</div>
<div class="line"><a id="l00703" name="l00703"></a><span class="lineno">  703</span>  r(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#aea2ed9a51f7ece9dd773654234125c9e">rpamax_</a>, <span class="stringliteral">&quot;rpamax&quot;</span>);</div>
<div class="line"><a id="l00704" name="l00704"></a><span class="lineno">  704</span>  r(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#ab6c4b68ab342ea95c03d25336d2b8813">qpmin_</a>, <span class="stringliteral">&quot;qpmin&quot;</span>);</div>
<div class="line"><a id="l00705" name="l00705"></a><span class="lineno">  705</span>  r(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a4d4b98307e22f87e591a1812a959d807">qpmax_</a>, <span class="stringliteral">&quot;qpmax&quot;</span>);</div>
<div class="line"><a id="l00706" name="l00706"></a><span class="lineno">  706</span>  r(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a019c308b9fda2ca4a0287c15df838c2e">bse_vmin_</a>, <span class="stringliteral">&quot;bse_vmin&quot;</span>);</div>
<div class="line"><a id="l00707" name="l00707"></a><span class="lineno">  707</span>  r(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#acd753d714099af878d22c73e9e981afd">bse_cmax_</a>, <span class="stringliteral">&quot;bse_cmax&quot;</span>);</div>
<div class="line"><a id="l00708" name="l00708"></a><span class="lineno">  708</span>  <a class="code hl_function" href="classvotca_1_1xtp_1_1Orbitals.html#a940ca87fa9c14c993af1dae642d1b070">setBSEindices</a>(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a019c308b9fda2ca4a0287c15df838c2e">bse_vmin_</a>, <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#acd753d714099af878d22c73e9e981afd">bse_cmax_</a>);</div>
<div class="line"><a id="l00709" name="l00709"></a><span class="lineno">  709</span>  <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l00710" name="l00710"></a><span class="lineno">  710</span>    r(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a7968485ad53f67e20aede0bd47fae597">functionalname_</a>, <span class="stringliteral">&quot;XCFunctional&quot;</span>);</div>
<div class="line"><a id="l00711" name="l00711"></a><span class="lineno">  711</span>    r(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a45fd3dd6cfb1af473af238948cc27470">grid_quality_</a>, <span class="stringliteral">&quot;XC_grid_quality&quot;</span>);</div>
<div class="line"><a id="l00712" name="l00712"></a><span class="lineno">  712</span>  } <span class="keywordflow">catch</span> (std::runtime_error&amp; <a class="code hl_enumvalue" href="namespacevotca_1_1tools.html#ad593ffcbc7a96312e5f11b81700aad17a5dd80bccefb34f7ef1ca94ef17e9612f">e</a>) {</div>
<div class="line"><a id="l00713" name="l00713"></a><span class="lineno">  713</span>    <a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a45fd3dd6cfb1af473af238948cc27470">grid_quality_</a> = <span class="stringliteral">&quot;medium&quot;</span>;</div>
<div class="line"><a id="l00714" name="l00714"></a><span class="lineno">  714</span>  }</div>
<div class="line"><a id="l00715" name="l00715"></a><span class="lineno">  715</span>  r(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a40ede97da45d7dbc493e70051711e3f2">ScaHFX_</a>, <span class="stringliteral">&quot;ScaHFX&quot;</span>);</div>
<div class="line"><a id="l00716" name="l00716"></a><span class="lineno">  716</span>  r(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a83029c41b0a8ca0933bc5abbe64e55fd">useTDA_</a>, <span class="stringliteral">&quot;useTDA&quot;</span>);</div>
<div class="line"><a id="l00717" name="l00717"></a><span class="lineno">  717</span>  r(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#ae96163a724d7162d59d1f7b2f024ca5d">ECP_</a>, <span class="stringliteral">&quot;ECP&quot;</span>);</div>
<div class="line"><a id="l00718" name="l00718"></a><span class="lineno">  718</span> </div>
<div class="line"><a id="l00719" name="l00719"></a><span class="lineno">  719</span>  r(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a15ab546770dc2e8a292664ddeda5fb8f">rpa_inputenergies_</a>, <span class="stringliteral">&quot;RPA_inputenergies&quot;</span>);</div>
<div class="line"><a id="l00720" name="l00720"></a><span class="lineno">  720</span>  r(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#ad870997ffd78d9f55e3ae4d6dc874a87">QPpert_energies_</a>, <span class="stringliteral">&quot;QPpert_energies&quot;</span>);</div>
<div class="line"><a id="l00721" name="l00721"></a><span class="lineno">  721</span>  r(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#aac5c74b33ec36fbeaafdd154d1a6c722">QPdiag_</a>, <span class="stringliteral">&quot;QPdiag&quot;</span>);</div>
<div class="line"><a id="l00722" name="l00722"></a><span class="lineno">  722</span> </div>
<div class="line"><a id="l00723" name="l00723"></a><span class="lineno">  723</span>  r(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a3901d86f0481b0fe1c38ce5c6e86dd34">BSE_singlet_</a>, <span class="stringliteral">&quot;BSE_singlet&quot;</span>);</div>
<div class="line"><a id="l00724" name="l00724"></a><span class="lineno">  724</span> </div>
<div class="line"><a id="l00725" name="l00725"></a><span class="lineno">  725</span>  r(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a76efd09e2816d4c6aa7168973314ddb0">transition_dipoles_</a>, <span class="stringliteral">&quot;transition_dipoles&quot;</span>);</div>
<div class="line"><a id="l00726" name="l00726"></a><span class="lineno">  726</span> </div>
<div class="line"><a id="l00727" name="l00727"></a><span class="lineno">  727</span>  r(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a8f706b2f707e8ab94f9947d4dce92eb0">BSE_triplet_</a>, <span class="stringliteral">&quot;BSE_triplet&quot;</span>);</div>
<div class="line"><a id="l00728" name="l00728"></a><span class="lineno">  728</span> </div>
<div class="line"><a id="l00729" name="l00729"></a><span class="lineno">  729</span>  r(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#acb49fb909223157852bb573e0e1a8428">use_Hqp_offdiag_</a>, <span class="stringliteral">&quot;use_Hqp_offdiag&quot;</span>);</div>
<div class="line"><a id="l00730" name="l00730"></a><span class="lineno">  730</span> </div>
<div class="line"><a id="l00731" name="l00731"></a><span class="lineno">  731</span>  <span class="keywordflow">if</span> (version &gt; 1) {</div>
<div class="line"><a id="l00732" name="l00732"></a><span class="lineno">  732</span>    r(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#abfcfa4abb9e4dfc0d073b347c995b3cb">BSE_singlet_energies_dynamic_</a>, <span class="stringliteral">&quot;BSE_singlet_dynamic&quot;</span>);</div>
<div class="line"><a id="l00733" name="l00733"></a><span class="lineno">  733</span> </div>
<div class="line"><a id="l00734" name="l00734"></a><span class="lineno">  734</span>    r(<a class="code hl_variable" href="classvotca_1_1xtp_1_1Orbitals.html#a4b101fea55c3f302c1c550d0aaadb9df">BSE_triplet_energies_dynamic_</a>, <span class="stringliteral">&quot;BSE_triplet_dynamic&quot;</span>);</div>
<div class="line"><a id="l00735" name="l00735"></a><span class="lineno">  735</span>  }</div>
<div class="line"><a id="l00736" name="l00736"></a><span class="lineno">  736</span>}</div>
<div class="line"><a id="l00737" name="l00737"></a><span class="lineno">  737</span>}  <span class="comment">// namespace xtp</span></div>
<div class="line"><a id="l00738" name="l00738"></a><span class="lineno">  738</span>}  <span class="comment">// namespace votca</span></div>
<div class="ttc" id="aaomatrix_8h_html"><div class="ttname"><a href="aomatrix_8h.html">aomatrix.h</a></div></div>
<div class="ttc" id="aclassvotca_1_1tools_1_1EigenSystem_html"><div class="ttname"><a href="classvotca_1_1tools_1_1EigenSystem.html">votca::tools::EigenSystem</a></div><div class="ttdef"><b>Definition:</b> <a href="eigensystem_8h_source.html#l00027">eigensystem.h:27</a></div></div>
<div class="ttc" id="aclassvotca_1_1tools_1_1EigenSystem_html_a705cf773bc4108779d4b617ec0230136"><div class="ttname"><a href="classvotca_1_1tools_1_1EigenSystem.html#a705cf773bc4108779d4b617ec0230136">votca::tools::EigenSystem::eigenvectors2</a></div><div class="ttdeci">const Eigen::MatrixXd &amp; eigenvectors2() const</div><div class="ttdef"><b>Definition:</b> <a href="eigensystem_8h_source.html#l00036">eigensystem.h:36</a></div></div>
<div class="ttc" id="aclassvotca_1_1tools_1_1EigenSystem_html_a8e7c2db1e04dcae085b3ba95d298dedd"><div class="ttname"><a href="classvotca_1_1tools_1_1EigenSystem.html#a8e7c2db1e04dcae085b3ba95d298dedd">votca::tools::EigenSystem::eigenvalues</a></div><div class="ttdeci">const Eigen::VectorXd &amp; eigenvalues() const</div><div class="ttdef"><b>Definition:</b> <a href="eigensystem_8h_source.html#l00030">eigensystem.h:30</a></div></div>
<div class="ttc" id="aclassvotca_1_1tools_1_1EigenSystem_html_afd8f46808af0552ff1a6ef84a42fe595"><div class="ttname"><a href="classvotca_1_1tools_1_1EigenSystem.html#afd8f46808af0552ff1a6ef84a42fe595">votca::tools::EigenSystem::eigenvectors</a></div><div class="ttdeci">const Eigen::MatrixXd &amp; eigenvectors() const</div><div class="ttdef"><b>Definition:</b> <a href="eigensystem_8h_source.html#l00033">eigensystem.h:33</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1AOBasis_html"><div class="ttname"><a href="classvotca_1_1xtp_1_1AOBasis.html">votca::xtp::AOBasis</a></div><div class="ttdoc">Container to hold Basisfunctions for all atoms.</div><div class="ttdef"><b>Definition:</b> <a href="aobasis_8h_source.html#l00042">aobasis.h:42</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1AOBasis_html_a3638e1261da1fff40c3608c01fac8307"><div class="ttname"><a href="classvotca_1_1xtp_1_1AOBasis.html#a3638e1261da1fff40c3608c01fac8307">votca::xtp::AOBasis::Fill</a></div><div class="ttdeci">void Fill(const BasisSet &amp;bs, const QMMolecule &amp;atoms)</div><div class="ttdef"><b>Definition:</b> <a href="aobasis_8cc_source.html#l00085">aobasis.cc:85</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1AOBasis_html_a86e322e256c12c5ab2e2a13044c11395"><div class="ttname"><a href="classvotca_1_1xtp_1_1AOBasis.html#a86e322e256c12c5ab2e2a13044c11395">votca::xtp::AOBasis::WriteToCpt</a></div><div class="ttdeci">void WriteToCpt(CheckpointWriter &amp;w) const</div><div class="ttdef"><b>Definition:</b> <a href="aobasis_8cc_source.html#l00141">aobasis.cc:141</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1AOBasis_html_a8f1f130b9a0bb9cdd8b51e0d8b6a5e68"><div class="ttname"><a href="classvotca_1_1xtp_1_1AOBasis.html#a8f1f130b9a0bb9cdd8b51e0d8b6a5e68">votca::xtp::AOBasis::ReadFromCpt</a></div><div class="ttdeci">void ReadFromCpt(CheckpointReader &amp;r)</div><div class="ttdef"><b>Definition:</b> <a href="aobasis_8cc_source.html#l00163">aobasis.cc:163</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1AODipole_html"><div class="ttname"><a href="classvotca_1_1xtp_1_1AODipole.html">votca::xtp::AODipole</a></div><div class="ttdef"><b>Definition:</b> <a href="aomatrix_8h_source.html#l00088">aomatrix.h:88</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1AODipole_html_a40668742fd6156242bfd06e60c71cd88"><div class="ttname"><a href="classvotca_1_1xtp_1_1AODipole.html#a40668742fd6156242bfd06e60c71cd88">votca::xtp::AODipole::setCenter</a></div><div class="ttdeci">void setCenter(const Eigen::Vector3d &amp;r)</div><div class="ttdef"><b>Definition:</b> <a href="aomatrix_8h_source.html#l00094">aomatrix.h:94</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1AODipole_html_ab91f50dafeceb8155bd361c4a12969fb"><div class="ttname"><a href="classvotca_1_1xtp_1_1AODipole.html#ab91f50dafeceb8155bd361c4a12969fb">votca::xtp::AODipole::Matrix</a></div><div class="ttdeci">const std::array&lt; Eigen::MatrixXd, 3 &gt; &amp; Matrix() const</div><div class="ttdef"><b>Definition:</b> <a href="aomatrix_8h_source.html#l00092">aomatrix.h:92</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1AODipole_html_aea0e297102a02c92c6d2b626efbad29e"><div class="ttname"><a href="classvotca_1_1xtp_1_1AODipole.html#aea0e297102a02c92c6d2b626efbad29e">votca::xtp::AODipole::Fill</a></div><div class="ttdeci">void Fill(const AOBasis &amp;aobasis) final</div><div class="ttdef"><b>Definition:</b> <a href="libint2__calls_8cc_source.html#l00193">libint2_calls.cc:193</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1AtomContainer_html_a04e6531d3130971e7ab62986b764aeab"><div class="ttname"><a href="classvotca_1_1xtp_1_1AtomContainer.html#a04e6531d3130971e7ab62986b764aeab">votca::xtp::AtomContainer::WriteToCpt</a></div><div class="ttdeci">virtual void WriteToCpt(CheckpointWriter &amp;w) const</div><div class="ttdef"><b>Definition:</b> <a href="atomcontainer_8h_source.html#l00155">atomcontainer.h:155</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1AtomContainer_html_a599735cbc5531cac9967b5cfcc2bcdd5"><div class="ttname"><a href="classvotca_1_1xtp_1_1AtomContainer.html#a599735cbc5531cac9967b5cfcc2bcdd5">votca::xtp::AtomContainer::ReadFromCpt</a></div><div class="ttdeci">virtual void ReadFromCpt(CheckpointReader &amp;r)</div><div class="ttdef"><b>Definition:</b> <a href="atomcontainer_8h_source.html#l00168">atomcontainer.h:168</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1AtomContainer_html_ab7e0b5b18022220498df92e7742b3cf4"><div class="ttname"><a href="classvotca_1_1xtp_1_1AtomContainer.html#ab7e0b5b18022220498df92e7742b3cf4">votca::xtp::AtomContainer::getPos</a></div><div class="ttdeci">const Eigen::Vector3d &amp; getPos() const</div><div class="ttdef"><b>Definition:</b> <a href="atomcontainer_8h_source.html#l00094">atomcontainer.h:94</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1BasisSet_html"><div class="ttname"><a href="classvotca_1_1xtp_1_1BasisSet.html">votca::xtp::BasisSet</a></div><div class="ttdef"><b>Definition:</b> <a href="basisset_8h_source.html#l00134">basisset.h:134</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1BasisSet_html_a1e8646dc8d3f6c07e67cac0eecd21e93"><div class="ttname"><a href="classvotca_1_1xtp_1_1BasisSet.html#a1e8646dc8d3f6c07e67cac0eecd21e93">votca::xtp::BasisSet::Load</a></div><div class="ttdeci">void Load(const std::string &amp;name)</div><div class="ttdef"><b>Definition:</b> <a href="basisset_8cc_source.html#l00149">basisset.cc:149</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1CheckpointFile_html"><div class="ttname"><a href="classvotca_1_1xtp_1_1CheckpointFile.html">votca::xtp::CheckpointFile</a></div><div class="ttdef"><b>Definition:</b> <a href="checkpoint_8h_source.html#l00044">checkpoint.h:44</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1CheckpointFile_html_a50ed07f6719ba2381fc510251dc3089c"><div class="ttname"><a href="classvotca_1_1xtp_1_1CheckpointFile.html#a50ed07f6719ba2381fc510251dc3089c">votca::xtp::CheckpointFile::getReader</a></div><div class="ttdeci">CheckpointReader getReader()</div><div class="ttdef"><b>Definition:</b> <a href="checkpoint_8cc_source.html#l00134">checkpoint.cc:134</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1CheckpointFile_html_ad319fa7f695339c87749e4e4c5e10fbc"><div class="ttname"><a href="classvotca_1_1xtp_1_1CheckpointFile.html#ad319fa7f695339c87749e4e4c5e10fbc">votca::xtp::CheckpointFile::getWriter</a></div><div class="ttdeci">CheckpointWriter getWriter()</div><div class="ttdef"><b>Definition:</b> <a href="checkpoint_8cc_source.html#l00121">checkpoint.cc:121</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1CheckpointReader_html"><div class="ttname"><a href="classvotca_1_1xtp_1_1CheckpointReader.html">votca::xtp::CheckpointReader</a></div><div class="ttdef"><b>Definition:</b> <a href="checkpointreader_8h_source.html#l00041">checkpointreader.h:41</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1CheckpointReader_html_ab1a8ab5ce25c90037b18b1648e8ff98e"><div class="ttname"><a href="classvotca_1_1xtp_1_1CheckpointReader.html#ab1a8ab5ce25c90037b18b1648e8ff98e">votca::xtp::CheckpointReader::openChild</a></div><div class="ttdeci">CheckpointReader openChild(const std::string &amp;childName) const</div><div class="ttdef"><b>Definition:</b> <a href="checkpointreader_8h_source.html#l00104">checkpointreader.h:104</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1CheckpointWriter_html"><div class="ttname"><a href="classvotca_1_1xtp_1_1CheckpointWriter.html">votca::xtp::CheckpointWriter</a></div><div class="ttdef"><b>Definition:</b> <a href="checkpointwriter_8h_source.html#l00044">checkpointwriter.h:44</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1CheckpointWriter_html_a78ce9e4c33cb65827075ae49624884df"><div class="ttname"><a href="classvotca_1_1xtp_1_1CheckpointWriter.html#a78ce9e4c33cb65827075ae49624884df">votca::xtp::CheckpointWriter::openChild</a></div><div class="ttdeci">CheckpointWriter openChild(const std::string &amp;childName) const</div><div class="ttdef"><b>Definition:</b> <a href="checkpointwriter_8h_source.html#l00109">checkpointwriter.h:109</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1OrbReorder_html"><div class="ttname"><a href="classvotca_1_1xtp_1_1OrbReorder.html">votca::xtp::OrbReorder</a></div><div class="ttdef"><b>Definition:</b> <a href="orbreorder_8h_source.html#l00036">orbreorder.h:36</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1OrbReorder_html_a4b6c8d385e57855d8631db04e5dd162f"><div class="ttname"><a href="classvotca_1_1xtp_1_1OrbReorder.html#a4b6c8d385e57855d8631db04e5dd162f">votca::xtp::OrbReorder::reorderOrbitals</a></div><div class="ttdeci">void reorderOrbitals(Eigen::MatrixXd &amp;moCoefficients, const AOBasis &amp;basis)</div><div class="ttdef"><b>Definition:</b> <a href="orbreorder_8cc_source.html#l00074">orbreorder.cc:74</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html">votca::xtp::Orbitals</a></div><div class="ttdoc">container for molecular orbitals</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8h_source.html#l00046">orbitals.h:46</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_a019c308b9fda2ca4a0287c15df838c2e"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#a019c308b9fda2ca4a0287c15df838c2e">votca::xtp::Orbitals::bse_vmin_</a></div><div class="ttdeci">Index bse_vmin_</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8h_source.html#l00429">orbitals.h:429</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_a0ce477afbebc6dcdde2be08370fedbb4"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#a0ce477afbebc6dcdde2be08370fedbb4">votca::xtp::Orbitals::bse_cmin_</a></div><div class="ttdeci">Index bse_cmin_</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8h_source.html#l00431">orbitals.h:431</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_a11cdff1529e5aa6cbf542976d372d4ac"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#a11cdff1529e5aa6cbf542976d372d4ac">votca::xtp::Orbitals::CalcCoupledTransition_Dipoles</a></div><div class="ttdeci">void CalcCoupledTransition_Dipoles()</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8cc_source.html#l00474">orbitals.cc:474</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_a120e88f83b42812bf8354aa36c4c9e70"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#a120e88f83b42812bf8354aa36c4c9e70">votca::xtp::Orbitals::hasQPdiag</a></div><div class="ttdeci">bool hasQPdiag() const</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8h_source.html#l00276">orbitals.h:276</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_a15ab546770dc2e8a292664ddeda5fb8f"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#a15ab546770dc2e8a292664ddeda5fb8f">votca::xtp::Orbitals::rpa_inputenergies_</a></div><div class="ttdeci">Eigen::VectorXd rpa_inputenergies_</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8h_source.html#l00443">orbitals.h:443</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_a180caaa2c175edb63e4a1b8cc9da09b7"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#a180caaa2c175edb63e4a1b8cc9da09b7">votca::xtp::Orbitals::getHomo</a></div><div class="ttdeci">Index getHomo() const</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8h_source.html#l00062">orbitals.h:62</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_a1b405de9e2d38dc0dfbfd09dcf290d31"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#a1b405de9e2d38dc0dfbfd09dcf290d31">votca::xtp::Orbitals::ReadBasisSetsFromCpt</a></div><div class="ttdeci">void ReadBasisSetsFromCpt(CheckpointReader r)</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8cc_source.html#l00642">orbitals.cc:642</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_a1d3c3224a7064ba7c09f3d9bcc1b09a7"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#a1d3c3224a7064ba7c09f3d9bcc1b09a7">votca::xtp::Orbitals::TransitionDensityMatrix</a></div><div class="ttdeci">Eigen::MatrixXd TransitionDensityMatrix(const QMState &amp;state) const</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8cc_source.html#l00218">orbitals.cc:218</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_a1e49d7abbe9d82622c501bc20b1e6a3c"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#a1e49d7abbe9d82622c501bc20b1e6a3c">votca::xtp::Orbitals::getDFTTotalEnergy</a></div><div class="ttdeci">double getDFTTotalEnergy() const</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8h_source.html#l00155">orbitals.h:155</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_a27fa02e785479c75e0d83581e5a4050e"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#a27fa02e785479c75e0d83581e5a4050e">votca::xtp::Orbitals::CalculateQParticleAORepresentation</a></div><div class="ttdeci">Eigen::MatrixXd CalculateQParticleAORepresentation() const</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8cc_source.html#l00177">orbitals.cc:177</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_a2ad86a0b1463f04bf716af8765570b11"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#a2ad86a0b1463f04bf716af8765570b11">votca::xtp::Orbitals::DensityMatrixExcitedState_R</a></div><div class="ttdeci">std::array&lt; Eigen::MatrixXd, 2 &gt; DensityMatrixExcitedState_R(const QMState &amp;state) const</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8cc_source.html#l00268">orbitals.cc:268</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_a2f5b8affcf9cb39392b5aaefbbffe375"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#a2f5b8affcf9cb39392b5aaefbbffe375">votca::xtp::Orbitals::basis_set_size_</a></div><div class="ttdeci">Index basis_set_size_</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8h_source.html#l00403">orbitals.h:403</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_a304e2b3db425c758f159717312263016"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#a304e2b3db425c758f159717312263016">votca::xtp::Orbitals::lmos_energies_</a></div><div class="ttdeci">Eigen::VectorXd lmos_energies_</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8h_source.html#l00413">orbitals.h:413</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_a3901d86f0481b0fe1c38ce5c6e86dd34"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#a3901d86f0481b0fe1c38ce5c6e86dd34">votca::xtp::Orbitals::BSE_singlet_</a></div><div class="ttdeci">tools::EigenSystem BSE_singlet_</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8h_source.html#l00450">orbitals.h:450</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_a40ede97da45d7dbc493e70051711e3f2"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#a40ede97da45d7dbc493e70051711e3f2">votca::xtp::Orbitals::ScaHFX_</a></div><div class="ttdeci">double ScaHFX_</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8h_source.html#l00437">orbitals.h:437</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_a41a587073015356cea394d0d99ca18b3"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#a41a587073015356cea394d0d99ca18b3">votca::xtp::Orbitals::PrepareDimerGuess</a></div><div class="ttdeci">void PrepareDimerGuess(const Orbitals &amp;orbitalsA, const Orbitals &amp;orbitalsB)</div><div class="ttdoc">Guess for a dimer based on monomer orbitals.</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8cc_source.html#l00519">orbitals.cc:519</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_a45fd3dd6cfb1af473af238948cc27470"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#a45fd3dd6cfb1af473af238948cc27470">votca::xtp::Orbitals::grid_quality_</a></div><div class="ttdeci">std::string grid_quality_</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8h_source.html#l00440">orbitals.h:440</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_a4652e57816ac2a9e1510619e84bfce14"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#a4652e57816ac2a9e1510619e84bfce14">votca::xtp::Orbitals::hasMOs</a></div><div class="ttdeci">bool hasMOs() const</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8h_source.html#l00100">orbitals.h:100</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_a4a0ccbe7eed6b7e78131b398f79975a2"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#a4a0ccbe7eed6b7e78131b398f79975a2">votca::xtp::Orbitals::getTotalStateEnergy</a></div><div class="ttdeci">double getTotalStateEnergy(const QMState &amp;state) const</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8cc_source.html#l00390">orbitals.cc:390</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_a4aa6c1ce5ac6f1d6f80f13d52a039c2c"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#a4aa6c1ce5ac6f1d6f80f13d52a039c2c">votca::xtp::Orbitals::dftbasis_</a></div><div class="ttdeci">AOBasis dftbasis_</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8h_source.html#l00418">orbitals.h:418</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_a4b101fea55c3f302c1c550d0aaadb9df"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#a4b101fea55c3f302c1c550d0aaadb9df">votca::xtp::Orbitals::BSE_triplet_energies_dynamic_</a></div><div class="ttdeci">Eigen::VectorXd BSE_triplet_energies_dynamic_</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8h_source.html#l00456">orbitals.h:456</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_a4d4b98307e22f87e591a1812a959d807"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#a4d4b98307e22f87e591a1812a959d807">votca::xtp::Orbitals::qpmax_</a></div><div class="ttdeci">Index qpmax_</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8h_source.html#l00428">orbitals.h:428</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_a4fba652bab475583863c37d38c40c3ef"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#a4fba652bab475583863c37d38c40c3ef">votca::xtp::Orbitals::active_electrons_</a></div><div class="ttdeci">Index active_electrons_</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8h_source.html#l00414">orbitals.h:414</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_a558fe820c96cbcbea288396d9d54e9ff"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#a558fe820c96cbcbea288396d9d54e9ff">votca::xtp::Orbitals::bse_vtotal_</a></div><div class="ttdeci">Index bse_vtotal_</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8h_source.html#l00434">orbitals.h:434</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_a5795bda46e15d19f671c03797f49a8f7"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#a5795bda46e15d19f671c03797f49a8f7">votca::xtp::Orbitals::bse_ctotal_</a></div><div class="ttdeci">Index bse_ctotal_</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8h_source.html#l00435">orbitals.h:435</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_a5b244837b85d38e4f16d5ad3cc6a33a2"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#a5b244837b85d38e4f16d5ad3cc6a33a2">votca::xtp::Orbitals::CheckDegeneracy</a></div><div class="ttdeci">std::vector&lt; Index &gt; CheckDegeneracy(Index level, double energy_difference) const</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8cc_source.html#l00046">orbitals.cc:46</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_a5db16540d57ba3b4a27179d303621338"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#a5db16540d57ba3b4a27179d303621338">votca::xtp::Orbitals::getNumberOfAlphaElectrons</a></div><div class="ttdeci">Index getNumberOfAlphaElectrons() const</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8h_source.html#l00079">orbitals.h:79</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_a62d22f5ad32fdcc936eda4a14ebace3a"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#a62d22f5ad32fdcc936eda4a14ebace3a">votca::xtp::Orbitals::CalcFreeTransition_Dipoles</a></div><div class="ttdeci">std::array&lt; Eigen::MatrixXd, 3 &gt; CalcFreeTransition_Dipoles() const</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8cc_source.html#l00456">orbitals.cc:456</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_a694e0adac36aa08474a8be7f7e96655d"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#a694e0adac36aa08474a8be7f7e96655d">votca::xtp::Orbitals::CalcAuxMat_cc</a></div><div class="ttdeci">Eigen::MatrixXd CalcAuxMat_cc(const Eigen::VectorXd &amp;coeffs) const</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8cc_source.html#l00317">orbitals.cc:317</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_a6a44a4319f15d3f4022acb194ba70076"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#a6a44a4319f15d3f4022acb194ba70076">votca::xtp::Orbitals::rpamin_</a></div><div class="ttdeci">Index rpamin_</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8h_source.html#l00424">orbitals.h:424</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_a6f459f45583890e0f8c203888977cfce"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#a6f459f45583890e0f8c203888977cfce">votca::xtp::Orbitals::setNumberOfAlphaElectrons</a></div><div class="ttdeci">void setNumberOfAlphaElectrons(Index electrons)</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8h_source.html#l00081">orbitals.h:81</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_a76309d578fd7165002f6581ca468e4d0"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#a76309d578fd7165002f6581ca468e4d0">votca::xtp::Orbitals::Oscillatorstrengths</a></div><div class="ttdeci">Eigen::VectorXd Oscillatorstrengths() const</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8cc_source.html#l00376">orbitals.cc:376</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_a76efd09e2816d4c6aa7168973314ddb0"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#a76efd09e2816d4c6aa7168973314ddb0">votca::xtp::Orbitals::transition_dipoles_</a></div><div class="ttdeci">std::vector&lt; Eigen::Vector3d &gt; transition_dipoles_</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8h_source.html#l00451">orbitals.h:451</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_a77cbe26b9ffd389e8af85ae09dba3562"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#a77cbe26b9ffd389e8af85ae09dba3562">votca::xtp::Orbitals::orbitals_version</a></div><div class="ttdeci">static constexpr int orbitals_version()</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8h_source.html#l00464">orbitals.h:464</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_a7968485ad53f67e20aede0bd47fae597"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#a7968485ad53f67e20aede0bd47fae597">votca::xtp::Orbitals::functionalname_</a></div><div class="ttdeci">std::string functionalname_</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8h_source.html#l00439">orbitals.h:439</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_a79b3229a2642b98241ae5100e75c0719"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#a79b3229a2642b98241ae5100e75c0719">votca::xtp::Orbitals::lmos_</a></div><div class="ttdeci">Eigen::MatrixXd lmos_</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8h_source.html#l00412">orbitals.h:412</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_a7c807131c81c48cf0be8d5a810eb7941"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#a7c807131c81c48cf0be8d5a810eb7941">votca::xtp::Orbitals::DensityMatrixWithoutGS</a></div><div class="ttdeci">Eigen::MatrixXd DensityMatrixWithoutGS(const QMState &amp;state) const</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8cc_source.html#l00104">orbitals.cc:104</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_a7de1c8ea52402b0c82e2455f61e98c8d"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#a7de1c8ea52402b0c82e2455f61e98c8d">votca::xtp::Orbitals::WriteBasisSetsToCpt</a></div><div class="ttdeci">void WriteBasisSetsToCpt(CheckpointWriter w) const</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8cc_source.html#l00574">orbitals.cc:574</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_a83029c41b0a8ca0933bc5abbe64e55fd"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#a83029c41b0a8ca0933bc5abbe64e55fd">votca::xtp::Orbitals::useTDA_</a></div><div class="ttdeci">bool useTDA_</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8h_source.html#l00407">orbitals.h:407</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_a86c86146758f19c44f7f1cb4b93ed6a3"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#a86c86146758f19c44f7f1cb4b93ed6a3">votca::xtp::Orbitals::DensityMatrixFull</a></div><div class="ttdeci">Eigen::MatrixXd DensityMatrixFull(const QMState &amp;state) const</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8cc_source.html#l00128">orbitals.cc:128</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_a8858d3cf8e9ef6df2192c1823343e1ab"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#a8858d3cf8e9ef6df2192c1823343e1ab">votca::xtp::Orbitals::CalcAuxMat_vv</a></div><div class="ttdeci">Eigen::MatrixXd CalcAuxMat_vv(const Eigen::VectorXd &amp;coeffs) const</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8cc_source.html#l00311">orbitals.cc:311</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_a8b8b606ff6c1c7742cd6f69af0f992cf"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#a8b8b606ff6c1c7742cd6f69af0f992cf">votca::xtp::Orbitals::SetupAuxBasis</a></div><div class="ttdeci">void SetupAuxBasis(std::string aux_basis_name)</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8cc_source.html#l00091">orbitals.cc:91</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_a8c17f47cb508cb22680dd430e16adc6b"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#a8c17f47cb508cb22680dd430e16adc6b">votca::xtp::Orbitals::qm_package_</a></div><div class="ttdeci">std::string qm_package_</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8h_source.html#l00441">orbitals.h:441</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_a8f706b2f707e8ab94f9947d4dce92eb0"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#a8f706b2f707e8ab94f9947d4dce92eb0">votca::xtp::Orbitals::BSE_triplet_</a></div><div class="ttdeci">tools::EigenSystem BSE_triplet_</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8h_source.html#l00452">orbitals.h:452</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_a940ca87fa9c14c993af1dae642d1b070"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#a940ca87fa9c14c993af1dae642d1b070">votca::xtp::Orbitals::setBSEindices</a></div><div class="ttdeci">void setBSEindices(Index vmin, Index cmax)</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8h_source.html#l00235">orbitals.h:235</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_a9aefc57e4347f374d3510f9a031038f9"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#a9aefc57e4347f374d3510f9a031038f9">votca::xtp::Orbitals::SortEnergies</a></div><div class="ttdeci">std::vector&lt; Index &gt; SortEnergies()</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8cc_source.html#l00068">orbitals.cc:68</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_a9cfac3693d61b6ef7c079deb01b493af"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#a9cfac3693d61b6ef7c079deb01b493af">votca::xtp::Orbitals::DensityMatrixExcitedState_AR</a></div><div class="ttdeci">std::array&lt; Eigen::MatrixXd, 2 &gt; DensityMatrixExcitedState_AR(const QMState &amp;state) const</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8cc_source.html#l00323">orbitals.cc:323</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_a9d3e91cd86895b521605fac9a043207b"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#a9d3e91cd86895b521605fac9a043207b">votca::xtp::Orbitals::getExcitedStateEnergy</a></div><div class="ttdeci">double getExcitedStateEnergy(const QMState &amp;state) const</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8cc_source.html#l00399">orbitals.cc:399</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_aa21cdb66a5a9f0fe7eac3e7e9f03673b"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#aa21cdb66a5a9f0fe7eac3e7e9f03673b">votca::xtp::Orbitals::setECPName</a></div><div class="ttdeci">void setECPName(const std::string &amp;ECP)</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8h_source.html#l00089">orbitals.h:89</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_aa2dcab363f170efe3bc1c66828eb6694"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#aa2dcab363f170efe3bc1c66828eb6694">votca::xtp::Orbitals::setNumberOfOccupiedLevels</a></div><div class="ttdeci">void setNumberOfOccupiedLevels(Index occupied_levels)</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8h_source.html#l00069">orbitals.h:69</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_aa5e2e7fe2eaffd23911c1b4e0c16da26"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#aa5e2e7fe2eaffd23911c1b4e0c16da26">votca::xtp::Orbitals::Orbitals</a></div><div class="ttdeci">Orbitals()</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8cc_source.html#l00037">orbitals.cc:37</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_aa7de90dfd160a1dd838e0ef6e07e58d3"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#aa7de90dfd160a1dd838e0ef6e07e58d3">votca::xtp::Orbitals::mos_</a></div><div class="ttdeci">tools::EigenSystem mos_</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8h_source.html#l00409">orbitals.h:409</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_aac5c74b33ec36fbeaafdd154d1a6c722"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#aac5c74b33ec36fbeaafdd154d1a6c722">votca::xtp::Orbitals::QPdiag_</a></div><div class="ttdeci">tools::EigenSystem QPdiag_</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8h_source.html#l00448">orbitals.h:448</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_aae17c5ef36a4607f2f200ca9ab66c927"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#aae17c5ef36a4607f2f200ca9ab66c927">votca::xtp::Orbitals::DensityMatrixKSstate</a></div><div class="ttdeci">Eigen::MatrixXd DensityMatrixKSstate(const QMState &amp;state) const</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8cc_source.html#l00163">orbitals.cc:163</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_ab1ba720a9628298e50bcc7780e4c7784"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#ab1ba720a9628298e50bcc7780e4c7784">votca::xtp::Orbitals::DensityMatrixQuasiParticle</a></div><div class="ttdeci">Eigen::MatrixXd DensityMatrixQuasiParticle(const QMState &amp;state) const</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8cc_source.html#l00186">orbitals.cc:186</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_ab6c4b68ab342ea95c03d25336d2b8813"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#ab6c4b68ab342ea95c03d25336d2b8813">votca::xtp::Orbitals::qpmin_</a></div><div class="ttdeci">Index qpmin_</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8h_source.html#l00427">orbitals.h:427</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_abb47a17f7c8b9a00615bd39b47280e6d"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#abb47a17f7c8b9a00615bd39b47280e6d">votca::xtp::Orbitals::getBasisSetSize</a></div><div class="ttdeci">Index getBasisSetSize() const</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8h_source.html#l00058">orbitals.h:58</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_abfcfa4abb9e4dfc0d073b347c995b3cb"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#abfcfa4abb9e4dfc0d073b347c995b3cb">votca::xtp::Orbitals::BSE_singlet_energies_dynamic_</a></div><div class="ttdeci">Eigen::VectorXd BSE_singlet_energies_dynamic_</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8h_source.html#l00455">orbitals.h:455</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_ac2971b02f8728af8270dc9f33b73fd02"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#ac2971b02f8728af8270dc9f33b73fd02">votca::xtp::Orbitals::getGWAmin</a></div><div class="ttdeci">Index getGWAmin() const</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8h_source.html#l00211">orbitals.h:211</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_ac343e12cc6b5e6d708e6fd9ab3970b11"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#ac343e12cc6b5e6d708e6fd9ab3970b11">votca::xtp::Orbitals::auxbasis_</a></div><div class="ttdeci">AOBasis auxbasis_</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8h_source.html#l00419">orbitals.h:419</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_ac4583263da9e2f946951ab955035abdf"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#ac4583263da9e2f946951ab955035abdf">votca::xtp::Orbitals::MOs</a></div><div class="ttdeci">const tools::EigenSystem &amp; MOs() const</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8h_source.html#l00102">orbitals.h:102</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_ac54132162019b4fbb2d431007297ff59"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#ac54132162019b4fbb2d431007297ff59">votca::xtp::Orbitals::DensityMatrixGroundState</a></div><div class="ttdeci">Eigen::MatrixXd DensityMatrixGroundState() const</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8cc_source.html#l00153">orbitals.cc:153</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_ac5a83ad06a7e5ca059787674811cd858"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#ac5a83ad06a7e5ca059787674811cd858">votca::xtp::Orbitals::QMAtoms</a></div><div class="ttdeci">const QMMolecule &amp; QMAtoms() const</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8h_source.html#l00134">orbitals.h:134</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_ac7674b36b098e7e09cb4c950824dbe42"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#ac7674b36b098e7e09cb4c950824dbe42">votca::xtp::Orbitals::mos_embedding_</a></div><div class="ttdeci">tools::EigenSystem mos_embedding_</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8h_source.html#l00410">orbitals.h:410</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_acb49fb909223157852bb573e0e1a8428"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#acb49fb909223157852bb573e0e1a8428">votca::xtp::Orbitals::use_Hqp_offdiag_</a></div><div class="ttdeci">bool use_Hqp_offdiag_</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8h_source.html#l00458">orbitals.h:458</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_acbeb7caec928a11684f1ff366ff59df1"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#acbeb7caec928a11684f1ff366ff59df1">votca::xtp::Orbitals::occupied_levels_</a></div><div class="ttdeci">Index occupied_levels_</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8h_source.html#l00404">orbitals.h:404</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_acd753d714099af878d22c73e9e981afd"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#acd753d714099af878d22c73e9e981afd">votca::xtp::Orbitals::bse_cmax_</a></div><div class="ttdeci">Index bse_cmax_</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8h_source.html#l00432">orbitals.h:432</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_acf1cb49e9bc057eccd9e8cc4ea81b60b"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#acf1cb49e9bc057eccd9e8cc4ea81b60b">votca::xtp::Orbitals::ReadFromCpt</a></div><div class="ttdeci">void ReadFromCpt(const std::string &amp;filename)</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8cc_source.html#l00631">orbitals.cc:631</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_ad870997ffd78d9f55e3ae4d6dc874a87"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#ad870997ffd78d9f55e3ae4d6dc874a87">votca::xtp::Orbitals::QPpert_energies_</a></div><div class="ttdeci">Eigen::VectorXd QPpert_energies_</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8h_source.html#l00445">orbitals.h:445</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_ad88f75689f181f9249c0ab1c9252b6d4"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#ad88f75689f181f9249c0ab1c9252b6d4">votca::xtp::Orbitals::WriteToCpt</a></div><div class="ttdeci">void WriteToCpt(const std::string &amp;filename) const</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8cc_source.html#l00563">orbitals.cc:563</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_ada61929c2682423290344d8fe65f36dd"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#ada61929c2682423290344d8fe65f36dd">votca::xtp::Orbitals::getECPName</a></div><div class="ttdeci">const std::string &amp; getECPName() const</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8h_source.html#l00087">orbitals.h:87</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_adacd859d9719647bca294b9d2e094a48"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#adacd859d9719647bca294b9d2e094a48">votca::xtp::Orbitals::getDFTbasisName</a></div><div class="ttdeci">const std::string &amp; getDFTbasisName() const</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8h_source.html#l00164">orbitals.h:164</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_adcab9d59437f5a1cfca97c18596b9fad"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#adcab9d59437f5a1cfca97c18596b9fad">votca::xtp::Orbitals::SetupDftBasis</a></div><div class="ttdeci">void SetupDftBasis(std::string basis_name)</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8cc_source.html#l00082">orbitals.cc:82</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_ae17bc4b6ebc754292e20a648ebba023e"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#ae17bc4b6ebc754292e20a648ebba023e">votca::xtp::Orbitals::DensityMatrixExcitedState</a></div><div class="ttdeci">std::array&lt; Eigen::MatrixXd, 2 &gt; DensityMatrixExcitedState(const QMState &amp;state) const</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8cc_source.html#l00254">orbitals.cc:254</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_ae96163a724d7162d59d1f7b2f024ca5d"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#ae96163a724d7162d59d1f7b2f024ca5d">votca::xtp::Orbitals::ECP_</a></div><div class="ttdeci">std::string ECP_</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8h_source.html#l00406">orbitals.h:406</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_aea075152677ce6bcaf842dedd8ba07e7"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#aea075152677ce6bcaf842dedd8ba07e7">votca::xtp::Orbitals::number_alpha_electrons_</a></div><div class="ttdeci">Index number_alpha_electrons_</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8h_source.html#l00405">orbitals.h:405</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_aea2ed9a51f7ece9dd773654234125c9e"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#aea2ed9a51f7ece9dd773654234125c9e">votca::xtp::Orbitals::rpamax_</a></div><div class="ttdeci">Index rpamax_</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8h_source.html#l00425">orbitals.h:425</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_aef4feb1701a23cc426584c53a7839ae5"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#aef4feb1701a23cc426584c53a7839ae5">votca::xtp::Orbitals::qm_energy_</a></div><div class="ttdeci">double qm_energy_</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8h_source.html#l00421">orbitals.h:421</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_aefad140d4ee0d2f0e8ebd099055d701d"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#aefad140d4ee0d2f0e8ebd099055d701d">votca::xtp::Orbitals::CalcElDipole</a></div><div class="ttdeci">Eigen::Vector3d CalcElDipole(const QMState &amp;state) const</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8cc_source.html#l00198">orbitals.cc:198</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_af5b81973c667c1651e7f1a933cb88fa7"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#af5b81973c667c1651e7f1a933cb88fa7">votca::xtp::Orbitals::getDftBasis</a></div><div class="ttdeci">const AOBasis &amp; getDftBasis() const</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8h_source.html#l00170">orbitals.h:170</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_af6f9e7eca2118d8a3d164a5633a3687a"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#af6f9e7eca2118d8a3d164a5633a3687a">votca::xtp::Orbitals::OrderMOsbyEnergy</a></div><div class="ttdeci">void OrderMOsbyEnergy()</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8cc_source.html#l00500">orbitals.cc:500</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1Orbitals_html_af7e77d477a6ab54b0214c01d07b8887f"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#af7e77d477a6ab54b0214c01d07b8887f">votca::xtp::Orbitals::atoms_</a></div><div class="ttdeci">QMMolecule atoms_</div><div class="ttdef"><b>Definition:</b> <a href="orbitals_8h_source.html#l00416">orbitals.h:416</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1QMAtom_html"><div class="ttname"><a href="classvotca_1_1xtp_1_1QMAtom.html">votca::xtp::QMAtom</a></div><div class="ttdoc">container for QM atoms</div><div class="ttdef"><b>Definition:</b> <a href="qmatom_8h_source.html#l00037">qmatom.h:37</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1QMStateType_html_a0a88e40efdabb7a94057b6518cd271ad"><div class="ttname"><a href="classvotca_1_1xtp_1_1QMStateType.html#a0a88e40efdabb7a94057b6518cd271ad">votca::xtp::QMStateType::ToLongString</a></div><div class="ttdeci">std::string ToLongString() const</div><div class="ttdef"><b>Definition:</b> <a href="qmstate_8cc_source.html#l00069">qmstate.cc:69</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1QMStateType_html_a3179e227d625ddd4ebd80fd8144f5666"><div class="ttname"><a href="classvotca_1_1xtp_1_1QMStateType.html#a3179e227d625ddd4ebd80fd8144f5666">votca::xtp::QMStateType::isKSState</a></div><div class="ttdeci">bool isKSState() const</div><div class="ttdef"><b>Definition:</b> <a href="qmstate_8h_source.html#l00089">qmstate.h:89</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1QMStateType_html_a31c4856f68f540aef4abb5e70084a9c5"><div class="ttname"><a href="classvotca_1_1xtp_1_1QMStateType.html#a31c4856f68f540aef4abb5e70084a9c5">votca::xtp::QMStateType::isPQPState</a></div><div class="ttdeci">bool isPQPState() const</div><div class="ttdef"><b>Definition:</b> <a href="qmstate_8h_source.html#l00091">qmstate.h:91</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1QMStateType_html_a958c0ba19ba206b9f4374d62576dd2eb"><div class="ttname"><a href="classvotca_1_1xtp_1_1QMStateType.html#a958c0ba19ba206b9f4374d62576dd2eb">votca::xtp::QMStateType::isExciton</a></div><div class="ttdeci">bool isExciton() const</div><div class="ttdef"><b>Definition:</b> <a href="qmstate_8h_source.html#l00071">qmstate.h:71</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1QMStateType_html_ac99cbd6d6ed98f669041f0840b09dfe7a3f229c61861798e442a17b3f0889d4b5"><div class="ttname"><a href="classvotca_1_1xtp_1_1QMStateType.html#ac99cbd6d6ed98f669041f0840b09dfe7a3f229c61861798e442a17b3f0889d4b5">votca::xtp::QMStateType::Gstate</a></div><div class="ttdeci">@ Gstate</div><div class="ttdef"><b>Definition:</b> <a href="qmstate_8h_source.html#l00040">qmstate.h:40</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1QMStateType_html_ac99cbd6d6ed98f669041f0840b09dfe7a56ff4f345deb58de7c991b71d0f9765e"><div class="ttname"><a href="classvotca_1_1xtp_1_1QMStateType.html#ac99cbd6d6ed98f669041f0840b09dfe7a56ff4f345deb58de7c991b71d0f9765e">votca::xtp::QMStateType::LMOstate</a></div><div class="ttdeci">@ LMOstate</div><div class="ttdef"><b>Definition:</b> <a href="qmstate_8h_source.html#l00045">qmstate.h:44</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1QMStateType_html_ac99cbd6d6ed98f669041f0840b09dfe7a734e21875c92fc7531db01ec3af9a745"><div class="ttname"><a href="classvotca_1_1xtp_1_1QMStateType.html#ac99cbd6d6ed98f669041f0840b09dfe7a734e21875c92fc7531db01ec3af9a745">votca::xtp::QMStateType::KSstate</a></div><div class="ttdeci">@ KSstate</div><div class="ttdef"><b>Definition:</b> <a href="qmstate_8h_source.html#l00043">qmstate.h:43</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1QMStateType_html_ac99cbd6d6ed98f669041f0840b09dfe7a9d38a794b81a5e5fa8b32d8fc153b015"><div class="ttname"><a href="classvotca_1_1xtp_1_1QMStateType.html#ac99cbd6d6ed98f669041f0840b09dfe7a9d38a794b81a5e5fa8b32d8fc153b015">votca::xtp::QMStateType::Triplet</a></div><div class="ttdeci">@ Triplet</div><div class="ttdef"><b>Definition:</b> <a href="qmstate_8h_source.html#l00039">qmstate.h:39</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1QMStateType_html_ac99cbd6d6ed98f669041f0840b09dfe7ac2ca29ef89597f341a74e08f205c4552"><div class="ttname"><a href="classvotca_1_1xtp_1_1QMStateType.html#ac99cbd6d6ed98f669041f0840b09dfe7ac2ca29ef89597f341a74e08f205c4552">votca::xtp::QMStateType::Singlet</a></div><div class="ttdeci">@ Singlet</div><div class="ttdef"><b>Definition:</b> <a href="qmstate_8h_source.html#l00038">qmstate.h:38</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1QMStateType_html_ac99cbd6d6ed98f669041f0840b09dfe7ac38ed43cdfb00d13f8d30dd9861f072b"><div class="ttname"><a href="classvotca_1_1xtp_1_1QMStateType.html#ac99cbd6d6ed98f669041f0840b09dfe7ac38ed43cdfb00d13f8d30dd9861f072b">votca::xtp::QMStateType::DQPstate</a></div><div class="ttdeci">@ DQPstate</div><div class="ttdef"><b>Definition:</b> <a href="qmstate_8h_source.html#l00042">qmstate.h:42</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1QMStateType_html_ac99cbd6d6ed98f669041f0840b09dfe7ae0acab0b2ea033ec422edf6307460c21"><div class="ttname"><a href="classvotca_1_1xtp_1_1QMStateType.html#ac99cbd6d6ed98f669041f0840b09dfe7ae0acab0b2ea033ec422edf6307460c21">votca::xtp::QMStateType::PQPstate</a></div><div class="ttdeci">@ PQPstate</div><div class="ttdef"><b>Definition:</b> <a href="qmstate_8h_source.html#l00041">qmstate.h:41</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1QMState_html"><div class="ttname"><a href="classvotca_1_1xtp_1_1QMState.html">votca::xtp::QMState</a></div><div class="ttdoc">Identifier for QMstates. Strings like S1 are converted into enum +zero indexed int.</div><div class="ttdef"><b>Definition:</b> <a href="qmstate_8h_source.html#l00132">qmstate.h:132</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1QMState_html_a538bcb5ebbb52080e9da42ba19e96580"><div class="ttname"><a href="classvotca_1_1xtp_1_1QMState.html#a538bcb5ebbb52080e9da42ba19e96580">votca::xtp::QMState::ToString</a></div><div class="ttdeci">std::string ToString() const</div><div class="ttdef"><b>Definition:</b> <a href="qmstate_8cc_source.html#l00146">qmstate.cc:146</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1QMState_html_a70412e35addab60844009b9a589db477"><div class="ttname"><a href="classvotca_1_1xtp_1_1QMState.html#a70412e35addab60844009b9a589db477">votca::xtp::QMState::StateIdx</a></div><div class="ttdeci">Index StateIdx() const</div><div class="ttdef"><b>Definition:</b> <a href="qmstate_8h_source.html#l00154">qmstate.h:154</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1QMState_html_a9ad29285bd6dbf88e111f927c2695e48"><div class="ttname"><a href="classvotca_1_1xtp_1_1QMState.html#a9ad29285bd6dbf88e111f927c2695e48">votca::xtp::QMState::isTransition</a></div><div class="ttdeci">bool isTransition() const</div><div class="ttdef"><b>Definition:</b> <a href="qmstate_8h_source.html#l00153">qmstate.h:153</a></div></div>
<div class="ttc" id="aclassvotca_1_1xtp_1_1QMState_html_aa30e0b21e5dff10052e30077a8c0410d"><div class="ttname"><a href="classvotca_1_1xtp_1_1QMState.html#aa30e0b21e5dff10052e30077a8c0410d">votca::xtp::QMState::Type</a></div><div class="ttdeci">const QMStateType &amp; Type() const</div><div class="ttdef"><b>Definition:</b> <a href="qmstate_8h_source.html#l00151">qmstate.h:151</a></div></div>
<div class="ttc" id="anamespacevotca_1_1tools_html_ad593ffcbc7a96312e5f11b81700aad17a5dd80bccefb34f7ef1ca94ef17e9612f"><div class="ttname"><a href="namespacevotca_1_1tools.html#ad593ffcbc7a96312e5f11b81700aad17a5dd80bccefb34f7ef1ca94ef17e9612f">votca::tools::e</a></div><div class="ttdeci">@ e</div><div class="ttdef"><b>Definition:</b> <a href="unitconverter_8h_source.html#l00059">unitconverter.h:59</a></div></div>
<div class="ttc" id="anamespacevotca_1_1xtp_html_a3b11bfd421bce407b7040b254e5ced05"><div class="ttname"><a href="namespacevotca_1_1xtp.html#a3b11bfd421bce407b7040b254e5ced05">votca::xtp::XtpVersionStr</a></div><div class="ttdeci">const std::string &amp; XtpVersionStr()</div><div class="ttdef"><b>Definition:</b> <a href="xtp_2src_2libxtp_2version_8cc_source.html#l00045">version.cc:45</a></div></div>
<div class="ttc" id="anamespacevotca_1_1xtp_html_ac8a3228f3752676abb9e23158681ec50a294ce20cdefa29be3be0735cb62e715d"><div class="ttname"><a href="namespacevotca_1_1xtp.html#ac8a3228f3752676abb9e23158681ec50a294ce20cdefa29be3be0735cb62e715d">votca::xtp::CheckpointAccessLevel::CREATE</a></div><div class="ttdeci">@ CREATE</div></div>
<div class="ttc" id="anamespacevotca_1_1xtp_html_ac8a3228f3752676abb9e23158681ec50a3466fab4975481651940ed328aa990e4"><div class="ttname"><a href="namespacevotca_1_1xtp.html#ac8a3228f3752676abb9e23158681ec50a3466fab4975481651940ed328aa990e4">votca::xtp::CheckpointAccessLevel::READ</a></div><div class="ttdeci">@ READ</div></div>
<div class="ttc" id="anamespacevotca_html"><div class="ttname"><a href="namespacevotca.html">votca</a></div><div class="ttdoc">Provides a means for comparing floating point numbers.</div><div class="ttdef"><b>Definition:</b> <a href="akimaspline_8h_source.html#l00029">akimaspline.h:29</a></div></div>
<div class="ttc" id="anamespacevotca_html_ad2c9da4f7634ac9c89e02a192345f276"><div class="ttname"><a href="namespacevotca.html#ad2c9da4f7634ac9c89e02a192345f276">votca::Index</a></div><div class="ttdeci">Eigen::Index Index</div><div class="ttdef"><b>Definition:</b> <a href="types_8h_source.html#l00026">types.h:26</a></div></div>
<div class="ttc" id="aorbitals_8h_html"><div class="ttname"><a href="orbitals_8h.html">orbitals.h</a></div></div>
<div class="ttc" id="aorbreorder_8h_html"><div class="ttname"><a href="orbreorder_8h.html">orbreorder.h</a></div></div>
<div class="ttc" id="aqmstate_8h_html"><div class="ttname"><a href="qmstate_8h.html">qmstate.h</a></div></div>
<div class="ttc" id="avc2index_8h_html"><div class="ttname"><a href="vc2index_8h.html">vc2index.h</a></div></div>
<div class="ttc" id="axtp_2include_2votca_2xtp_2version_8h_html"><div class="ttname"><a href="xtp_2include_2votca_2xtp_2version_8h.html">version.h</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5
</small></address>
</body>
</html>
