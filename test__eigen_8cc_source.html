<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>votca: /home/votca/votca/xtp/src/tests/test_eigen.cc Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">votca
   &#160;<span id="projectnumber">1.5-dev</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_74c2a4b3b0df7b8317fa7dedf91a69e4.html">xtp</a></li><li class="navelem"><a class="el" href="dir_939a47b76fcf2b405f4898a413fd95f4.html">src</a></li><li class="navelem"><a class="el" href="dir_545cd823820471ff674c958a4f96b7de.html">tests</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">test_eigen.cc</div>  </div>
</div><!--header-->
<div class="contents">
<a href="test__eigen_8cc.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * Copyright 2009-2018 The VOTCA Development Team (http://www.votca.org)</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> * you may not use this file except in compliance with the License.</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> *     http://www.apache.org/licenses/LICENSE-2.0</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> * Unless required by applicable law or agreed to in writing, software</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> * See the License for the specific language governing permissions and</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> * limitations under the License.</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00016"></a><span class="lineno"><a class="line" href="test__eigen_8cc.html#ab340a5e76af466a5f20ec5500d30a80b">   16</a></span>&#160;<span class="preprocessor">#define BOOST_TEST_MAIN</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;</div><div class="line"><a name="l00018"></a><span class="lineno"><a class="line" href="test__eigen_8cc.html#a6b2a3852db8bb19ab6909bac01859985">   18</a></span>&#160;<span class="preprocessor">#define BOOST_TEST_MODULE eigen_test</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &lt;boost/test/unit_test.hpp&gt;</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="xtp_2include_2votca_2xtp_2eigen_8h.html">votca/xtp/eigen.h</a>&gt;</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;BOOST_AUTO_TEST_SUITE(eigen_test)</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div><div class="line"><a name="l00026"></a><span class="lineno"><a class="line" href="test__eigen_8cc.html#a933b9cc14073742c53d2cf6a9b01bbe5">   26</a></span>&#160;<a class="code" href="test__eigen_8cc.html#a933b9cc14073742c53d2cf6a9b01bbe5">BOOST_AUTO_TEST_CASE</a>(symmetric_test) {</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  </div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  Eigen::MatrixXd notsym=Eigen::MatrixXd::Random(6,6);</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  </div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  Eigen::MatrixXd sym=notsym+notsym.transpose();</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  </div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <span class="keywordtype">bool</span> symmetry=<span class="keyword">true</span>;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="ImagePotential_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>=0;<a class="code" href="ImagePotential_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;sym.rows();++<a class="code" href="ImagePotential_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>){</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;=<a class="code" href="ImagePotential_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;++j){</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="namespacevotca_1_1tools.html#abc0c90bbc5f6f5ad2695b3377f7e5684">std::abs</a>(sym(<a class="code" href="ImagePotential_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>,j)-sym(j,<a class="code" href="ImagePotential_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>))&gt;1e-9){</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        symmetry=<span class="keyword">false</span>;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;      }</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    }</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  }</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  </div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  </div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  BOOST_CHECK_EQUAL(symmetry, 1);</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;}</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div><div class="line"><a name="l00047"></a><span class="lineno"><a class="line" href="test__eigen_8cc.html#a749370e02d2df20fbb3ab21ecde5ee5e">   47</a></span>&#160;<a class="code" href="test__eigen_8cc.html#a933b9cc14073742c53d2cf6a9b01bbe5">BOOST_AUTO_TEST_CASE</a>(inverse_test) {</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  Eigen::MatrixXd <a class="code" href="namespacevotca_1_1moo.html#a8343785fc9555e11a6f26bd83936f1a4a522b856dcae786b6fd48bd5e2d802f5f">m</a>=Eigen::MatrixXd::Zero(17,17);</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <a class="code" href="namespacevotca_1_1moo.html#a8343785fc9555e11a6f26bd83936f1a4a522b856dcae786b6fd48bd5e2d802f5f">m</a>&lt;&lt;-0.0107438,0.177662,-0.000893645,-0.000893645,-0.000893645,0.345174,-0.000591276,-0.000591276,-0.000591276,0.136613,0.110948,0.140527,0.115047,0.140527,0.115047,0.140527,0.115047,</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;2.183e-15,1.39936e-14,-0.2034,0.00238481,0.201015,-7.8295e-14,-0.174952,0.00205127,0.172901,-5.75953e-13,-7.55155e-13,-0.234829,-0.324284,0.232076,0.320482,0.00275331,0.00380215,</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;1.92294e-15,5.30409e-14,-0.114679,0.233489,-0.11881,-1.08691e-13,-0.0986399,0.200833,-0.102193,1.10298e-12,1.56415e-12,-0.132399,-0.182835,-0.137168,-0.189421,0.269568,0.372256,</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;9.81255e-05,-0.00180964,-0.165679,-0.165679,-0.165679,-0.00572861,-0.144589,-0.144589,-0.144589,-0.283887,-0.391777,0.0942211,0.13068,0.0942211,0.13068,0.0942211,0.13068,</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;0.0257368,-0.0923997,0.00531379,0.00531379,0.00531379,-2.45842,0.0248521,0.0248521,0.0248521,-0.0235266,0.870391,-0.021766,0.938627,-0.021766,0.938627,-0.021766,0.938627,</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;-6.05072e-15,-3.50553e-14,0.0320188,-0.217226,0.185207,2.84606e-13,0.164774,-1.11788,0.953107,-3.43579e-13,-7.51681e-12,-0.0107087,-0.224765,-0.0619426,-1.30011,0.0726513,1.52488,</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;-1.85212e-14,3.71612e-14,0.232345,-0.0884434,-0.143902,1.65531e-12,1.19569,-0.455144,-0.740541,-5.57708e-13,-1.28855e-11,-0.0777079,-1.63101,0.0481279,1.01016,0.0295799,0.620853,</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;-0.00067642,0.0030588,0.164587,0.164587,0.164587,0.0706733,0.85369,0.85369,0.85369,-0.0833538,-1.77428,0.0291688,0.555286,0.0291688,0.555286,0.0291688,0.555286,</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;2.67521e-15,1.49908e-14,-0.499711,0.0302687,0.469443,-8.25069e-14,0.794429,-0.0481205,-0.746308,-1.68595e-12,3.88068e-13,-0.631236,0.170551,0.593,-0.16022,0.0382355,-0.0103307,</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;-2.92301e-15,-4.20358e-14,0.253557,-0.559541,0.305984,2.74225e-14,-0.403099,0.889545,-0.486446,-4.63627e-12,1.28551e-12,0.320293,-0.0865389,0.386519,-0.104432,-0.706813,0.190971,</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;0.000103179,-0.000739357,-0.399322,-0.399322,-0.399322,-0.00417793,0.631921,0.631921,0.631921,-0.743087,0.196419,0.252682,-0.0664109,0.252682,-0.0664109,0.252682,-0.0664109,</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;0.00149008,-0.210613,0.0151116,0.0151116,0.0151116,-0.131439,-0.0188722,-0.0188722,-0.0188722,0.641757,-0.258506,0.662618,-0.303913,0.662618,-0.303913,0.662618,-0.303913,</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;-1.01256e-14,8.31141e-14,0.154221,-0.726494,0.572273,3.21687e-13,-0.180079,0.848303,-0.668224,-6.90137e-12,1.08126e-11,-0.16221,0.269927,-0.601918,1.00163,0.764127,-1.27156,</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;-1.4385e-14,4.61332e-14,0.749843,-0.241362,-0.508481,3.69788e-13,-0.875567,0.281831,0.593736,-1.00864e-11,1.59982e-11,-0.788686,1.31242,0.534821,-0.889976,0.253865,-0.422448,</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;8.45112e-05,-0.00427837,-0.539015,-0.539015,-0.539015,-0.00364986,0.62842,0.62842,0.62842,0.873707,-1.42717,-0.270316,0.466699,-0.270316,0.466699,-0.270316,0.466699,</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;0.220745,1.96298,0.000217492,0.000217492,0.000217492,-3.94464,-0.000657288,-0.000657288,-0.000657288,0.170958,0.775841,0.170979,0.77469,0.170979,0.77469,0.170979,0.77469,</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;-1.00858,0.364513,2.52534e-06,2.52534e-06,2.52534e-06,-0.192712,-5.74555e-07,-5.74555e-07,-5.74555e-07,-0.0243332,0.0351697,-0.0243273,0.0351687,-0.0243273,0.0351687,-0.0243273,0.0351687;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  </div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  Eigen::FullPivLU&lt;Eigen::MatrixXd&gt; dec(<a class="code" href="namespacevotca_1_1moo.html#a8343785fc9555e11a6f26bd83936f1a4a522b856dcae786b6fd48bd5e2d802f5f">m</a>);</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160; </div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="keywordtype">bool</span> check_inv=(<a class="code" href="namespacevotca_1_1moo.html#a8343785fc9555e11a6f26bd83936f1a4a522b856dcae786b6fd48bd5e2d802f5f">m</a>*dec.inverse()).isApprox(Eigen::MatrixXd::Identity(17,17),0.01);</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  </div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="keywordflow">if</span>(!check_inv){</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  std::cout&lt;&lt;dec.isInvertible()&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;dec.rank()&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;dec.rcond()&lt;&lt;std::endl;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  std::cout&lt;&lt;<a class="code" href="namespacevotca_1_1moo.html#a8343785fc9555e11a6f26bd83936f1a4a522b856dcae786b6fd48bd5e2d802f5f">m</a>*dec.solve(Eigen::MatrixXd::Identity(17,17))&lt;&lt;std::endl;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;}</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;BOOST_CHECK_EQUAL(check_inv, 1);</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;}</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;BOOST_AUTO_TEST_SUITE_END()</div><div class="ttc" id="test__eigen_8cc_html_a933b9cc14073742c53d2cf6a9b01bbe5"><div class="ttname"><a href="test__eigen_8cc.html#a933b9cc14073742c53d2cf6a9b01bbe5">BOOST_AUTO_TEST_CASE</a></div><div class="ttdeci">BOOST_AUTO_TEST_CASE(symmetric_test)</div><div class="ttdef"><b>Definition:</b> <a href="test__eigen_8cc_source.html#l00026">test_eigen.cc:26</a></div></div>
<div class="ttc" id="namespacevotca_1_1tools_html_abc0c90bbc5f6f5ad2695b3377f7e5684"><div class="ttname"><a href="namespacevotca_1_1tools.html#abc0c90bbc5f6f5ad2695b3377f7e5684">votca::tools::abs</a></div><div class="ttdeci">double abs(const vec &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="vec_8h_source.html#l00349">vec.h:349</a></div></div>
<div class="ttc" id="namespacevotca_1_1moo_html_a8343785fc9555e11a6f26bd83936f1a4a522b856dcae786b6fd48bd5e2d802f5f"><div class="ttname"><a href="namespacevotca_1_1moo.html#a8343785fc9555e11a6f26bd83936f1a4a522b856dcae786b6fd48bd5e2d802f5f">votca::moo::m</a></div><div class="ttdef"><b>Definition:</b> <a href="units_8h_source.html#l00034">units.h:34</a></div></div>
<div class="ttc" id="ImagePotential_8h_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="ImagePotential_8h.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="ImagePotential_8h_source.html#l00028">ImagePotential.h:28</a></div></div>
<div class="ttc" id="xtp_2include_2votca_2xtp_2eigen_8h_html"><div class="ttname"><a href="xtp_2include_2votca_2xtp_2eigen_8h.html">eigen.h</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
