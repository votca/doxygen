<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Votca: tools/src/libtools/akimaspline.cc Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Votca
   &#160;<span id="projectnumber">1.4-dev</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">tools/src/libtools/akimaspline.cc</div>  </div>
</div><!--header-->
<div class="contents">
<a href="akimaspline_8cc.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/* </span>
<a name="l00002"></a>00002 <span class="comment"> * Copyright 2009-2011 The VOTCA Development Team (http://www.votca.org)</span>
<a name="l00003"></a>00003 <span class="comment"> *</span>
<a name="l00004"></a>00004 <span class="comment"> * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
<a name="l00005"></a>00005 <span class="comment"> * you may not use this file except in compliance with the License.</span>
<a name="l00006"></a>00006 <span class="comment"> * You may obtain a copy of the License at</span>
<a name="l00007"></a>00007 <span class="comment"> *</span>
<a name="l00008"></a>00008 <span class="comment"> *     http://www.apache.org/licenses/LICENSE-2.0</span>
<a name="l00009"></a>00009 <span class="comment"> *</span>
<a name="l00010"></a>00010 <span class="comment"> * Unless required by applicable law or agreed to in writing, software</span>
<a name="l00011"></a>00011 <span class="comment"> * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<a name="l00012"></a>00012 <span class="comment"> * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<a name="l00013"></a>00013 <span class="comment"> * See the License for the specific language governing permissions and</span>
<a name="l00014"></a>00014 <span class="comment"> * limitations under the License.</span>
<a name="l00015"></a>00015 <span class="comment"> *</span>
<a name="l00016"></a>00016 <span class="comment"> */</span>
<a name="l00017"></a>00017 
<a name="l00018"></a>00018 <span class="preprocessor">#include &lt;<a class="code" href="akimaspline_8h.html">votca/tools/akimaspline.h</a>&gt;</span>
<a name="l00019"></a>00019 <span class="preprocessor">#include &lt;boost/numeric/ublas/matrix.hpp&gt;</span>
<a name="l00020"></a>00020 <span class="preprocessor">#include &lt;boost/numeric/ublas/vector.hpp&gt;</span>
<a name="l00021"></a>00021 <span class="preprocessor">#include &lt;boost/numeric/ublas/vector_proxy.hpp&gt;</span>
<a name="l00022"></a>00022 <span class="preprocessor">#include &lt;<a class="code" href="linalg_8h.html">votca/tools/linalg.h</a>&gt;</span>
<a name="l00023"></a>00023 <span class="preprocessor">#include &lt;iostream&gt;</span>
<a name="l00024"></a>00024 
<a name="l00025"></a>00025 <span class="keyword">namespace </span>votca { <span class="keyword">namespace </span>tools {
<a name="l00026"></a>00026 
<a name="l00027"></a>00027 <span class="keyword">using namespace </span>std;
<a name="l00028"></a>00028 
<a name="l00029"></a><a class="code" href="classvotca_1_1tools_1_1AkimaSpline.html#a013f1c242bded3107d992d5085b3dfd6">00029</a> <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1tools_1_1AkimaSpline.html#a013f1c242bded3107d992d5085b3dfd6" title="Calculate interpolating spline for given (x,y) values. Points on resulting spline can be obtained via...">AkimaSpline::Interpolate</a>(ub::vector&lt;double&gt; &amp;<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>, ub::vector&lt;double&gt; &amp;y)
<a name="l00030"></a>00030 {    
<a name="l00031"></a>00031     <span class="keywordflow">if</span>(x.size() != y.size())
<a name="l00032"></a>00032         <span class="keywordflow">throw</span> std::invalid_argument(<span class="stringliteral">&quot;error in AkimaSpline::Interpolate : sizes of vectors x and y do not match&quot;</span>);
<a name="l00033"></a>00033     
<a name="l00034"></a>00034     <span class="comment">// Akima splines require at least 4 points</span>
<a name="l00035"></a>00035     <span class="keywordflow">if</span>(x.size()&lt;4)
<a name="l00036"></a>00036         <span class="keywordflow">throw</span> std::invalid_argument(<span class="stringliteral">&quot;error in AkimaSpline::Interpolate : vectors x and y have to contain at least 4 points&quot;</span>);
<a name="l00037"></a>00037 
<a name="l00038"></a>00038     <span class="keyword">const</span> <span class="keywordtype">int</span> N = x.size();
<a name="l00039"></a>00039     
<a name="l00040"></a>00040     <span class="comment">// adjust the grid</span>
<a name="l00041"></a>00041     _r.resize(N);
<a name="l00042"></a>00042     
<a name="l00043"></a>00043     <span class="comment">// copy the grid points into f</span>
<a name="l00044"></a>00044     _r = <a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>;
<a name="l00045"></a>00045     
<a name="l00046"></a>00046     <span class="comment">// initialize vectors p1,p2,p3,p4 and t</span>
<a name="l00047"></a>00047     p0 = ub::zero_vector&lt;double&gt;(N);
<a name="l00048"></a>00048     p1 = ub::zero_vector&lt;double&gt;(N);
<a name="l00049"></a>00049     p2 = ub::zero_vector&lt;double&gt;(N);
<a name="l00050"></a>00050     p3 = ub::zero_vector&lt;double&gt;(N);
<a name="l00051"></a>00051     t = ub::zero_vector&lt;double&gt;(N);
<a name="l00052"></a>00052 
<a name="l00053"></a>00053     <span class="keywordtype">double</span> m1,m2,m3,m4;
<a name="l00054"></a>00054 
<a name="l00055"></a>00055     <span class="keywordtype">double</span> temp, g0, g1, g2, x1, x2, y1, y2, x4, x5, y4, y5, m5;
<a name="l00056"></a>00056     
<a name="l00057"></a>00057     <span class="comment">// boundary conditions</span>
<a name="l00058"></a>00058     <span class="comment">// &gt;&gt; determine t(0), t(1) and t(N-2), t(N-1)</span>
<a name="l00059"></a>00059     <span class="keywordflow">switch</span>(_boundaries) {
<a name="l00060"></a>00060         <span class="keywordflow">case</span> splineNormal:
<a name="l00061"></a>00061             <span class="comment">// Akima method: estimation of two more points on each side using a</span>
<a name="l00062"></a>00062             <span class="comment">// degree two polyomial</span>
<a name="l00063"></a>00063             <span class="comment">// resulting slopes t(0), t(1), t(N-2), t(N-1) are directly calculated</span>
<a name="l00064"></a>00064 
<a name="l00065"></a>00065             <span class="comment">// left side: t(0), t(1)</span>
<a name="l00066"></a>00066             temp = (<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(1)-<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(0))/(<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(2)-<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(0));
<a name="l00067"></a>00067             temp = temp*temp;
<a name="l00068"></a>00068             g0 = y(0);
<a name="l00069"></a>00069             g1 = ( (y(1)-y(0)) - temp*(y(2)-y(0)) ) / ( (<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(1)-<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(0)) - temp*(<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(2)-<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(0)) );
<a name="l00070"></a>00070             g2 = ( (y(2)-y(0)) - g1*(<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(2)-<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(0)) ) / ( (<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(2)-<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(0))*(<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(2)-<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(0)) );
<a name="l00071"></a>00071             x1 = <a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(0) - (<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(2)-<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(0));
<a name="l00072"></a>00072             x2 = <a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(1) - (<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(2)-<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(0));
<a name="l00073"></a>00073             y1 = g0 + g1*(x1-<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(0)) + g2*(x1-<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(0))*(x1-<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(0));
<a name="l00074"></a>00074             y2 = g0 + g1*(x2-<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(0)) + g2*(x2-<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(0))*(x2-<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(0));
<a name="l00075"></a>00075             m1 = (y2-y1)/(x2-x1);
<a name="l00076"></a>00076             m2 = (y(0)-y2)/(<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(0)-x2);
<a name="l00077"></a>00077             m3 = (y(1)-y(0))/(<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(1)-<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(0));
<a name="l00078"></a>00078             m4 = (y(2)-y(1))/(<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(2)-<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(1));
<a name="l00079"></a>00079             t(0) = getSlope(m1,m2,m3,m4);
<a name="l00080"></a>00080             m5 = (y(3)-y(2))/(<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(3)-<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(2));
<a name="l00081"></a>00081             t(1) = getSlope(m2,m3,m4,m5);
<a name="l00082"></a>00082 
<a name="l00083"></a>00083             <span class="comment">// right side: t(N-2), t(N-1)</span>
<a name="l00084"></a>00084             temp = (<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(N-2)-<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(N-1))/(<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(N-3)-<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(N-1));
<a name="l00085"></a>00085             temp = temp*temp;
<a name="l00086"></a>00086             g0 = y(N-1);
<a name="l00087"></a>00087             g1 = ( (y(N-2)-y(N-1)) - temp*(y(N-3)-y(N-1)) ) / ( (<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(N-2)-<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(N-1)) - temp*(<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(N-3)-<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(N-1)) );
<a name="l00088"></a>00088             g2 = ( (y(N-3)-y(N-1)) - g1*(<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(N-3)-<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(N-1)) ) / ( (<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(N-3)-<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(N-1))*(<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(N-3)-<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(N-1)) );
<a name="l00089"></a>00089             x4 = <a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(N-2) + (<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(N-1)-<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(N-3));
<a name="l00090"></a>00090             x5 = <a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(N-1) + (<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(N-1)-<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(N-3));
<a name="l00091"></a>00091             y4 = g0 + g1*(x4-<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(N-1)) + g2*(x4-<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(N-1))*(x4-<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(N-1));
<a name="l00092"></a>00092             y5 = g0 + g1*(x5-<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(N-1)) + g2*(x5-<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(N-1))*(x5-<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(N-1));
<a name="l00093"></a>00093             m1 = (y(N-3)-y(N-4))/(<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(N-3)-<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(N-4));
<a name="l00094"></a>00094             m2 = (y(N-2)-y(N-3))/(<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(N-2)-<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(N-3));
<a name="l00095"></a>00095             m3 = (y(N-1)-y(N-2))/(<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(N-1)-<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(N-2));
<a name="l00096"></a>00096             m4 = (y4-y(N-1))/(x4-<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(N-1));
<a name="l00097"></a>00097             m5 = (y5-y4)/(x5-x4);
<a name="l00098"></a>00098             t(N-2) = getSlope(m1,m2,m3,m4);
<a name="l00099"></a>00099             t(N-1) = getSlope(m2,m3,m4,m5);
<a name="l00100"></a>00100             <span class="keywordflow">break</span>;
<a name="l00101"></a>00101         <span class="keywordflow">case</span> splinePeriodic:
<a name="l00102"></a>00102             <span class="comment">// left: last two points determine the slopes t(0), t(1)</span>
<a name="l00103"></a>00103             m1 = (y(N-1)-y(N-2))/(<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(N-1)-<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(N-2));
<a name="l00104"></a>00104             m2 = (y(0)-y(N-1))/(<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(0)-<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(N-1));
<a name="l00105"></a>00105             m3 = (y(1)-y(0))/(<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(1)-<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(0));
<a name="l00106"></a>00106             m4 = (y(2)-y(1))/(<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(2)-<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(1));
<a name="l00107"></a>00107             m5 = (y(3)-y(2))/(<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(3)-<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(2));
<a name="l00108"></a>00108             t(0) = getSlope(m1,m2,m3,m4);
<a name="l00109"></a>00109             t(1) = getSlope(m2,m3,m4,m5);
<a name="l00110"></a>00110             <span class="comment">// right: first two points determine the slopes t(N-2), t(N-1)</span>
<a name="l00111"></a>00111             m1 = (y(N-3)-y(N-4))/(<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(N-3)-<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(N-4));
<a name="l00112"></a>00112             m2 = (y(N-2)-y(N-3))/(<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(N-2)-<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(N-3));
<a name="l00113"></a>00113             m3 = (y(N-1)-y(N-2))/(<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(N-1)-<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(N-2));
<a name="l00114"></a>00114             m4 = (y(0)-y(N-1))/(<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(0)-<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(N-1));
<a name="l00115"></a>00115             m5 = (y(1)-y(0))/(<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(1)-<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(0));
<a name="l00116"></a>00116             t(N-2) = getSlope(m1,m2,m3,m4);
<a name="l00117"></a>00117             t(N-1) = getSlope(m2,m3,m4,m5);
<a name="l00118"></a>00118             <span class="keywordflow">break</span>;
<a name="l00119"></a>00119         <span class="keywordflow">case</span> splineDerivativeZero:
<a name="l00120"></a>00120             <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;erro in AkimaSpline::Interpolate: case splineDerivativeZero not implemented yet&quot;</span>);
<a name="l00121"></a>00121             <span class="keywordflow">break</span>;
<a name="l00122"></a>00122     }
<a name="l00123"></a>00123     
<a name="l00124"></a>00124     <span class="comment">// calculate t&#39;s for all inner points [2,N-3]</span>
<a name="l00125"></a>00125     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=2; i&lt;N-2; i++) {
<a name="l00126"></a>00126         m1 = (y(i-1)-y(i-2))/(<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(i-1)-<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(i-2));
<a name="l00127"></a>00127         m2 = (y(i)-y(i-1))/(<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(i)-<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(i-1));
<a name="l00128"></a>00128         m3 = (y(i+1)-y(i))/(<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(i+1)-<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(i));
<a name="l00129"></a>00129         m4 = (y(i+2)-y(i+1))/(<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(i+2)-<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(i+1));
<a name="l00130"></a>00130         t(i) = getSlope(m1,m2,m3,m4);
<a name="l00131"></a>00131     }
<a name="l00132"></a>00132 
<a name="l00133"></a>00133     <span class="comment">// calculate p0,p1,p2,p3 for all intervals 0..(N-2), where interval</span>
<a name="l00134"></a>00134     <span class="comment">// [x(i),x(i+1)] shall have number i (this means that the last interval</span>
<a name="l00135"></a>00135     <span class="comment">// has number N-2)</span>
<a name="l00136"></a>00136     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;N-1; i++) {
<a name="l00137"></a>00137         p0(i) = y(i);
<a name="l00138"></a>00138         p1(i) = t(i);
<a name="l00139"></a>00139         p2(i) = ( 3.0*(y(i+1)-y(i))/(<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(i+1)-<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(i)) - 2.0*t(i) - t(i+1) ) / (<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(i+1)-<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(i));
<a name="l00140"></a>00140         p3(i) = ( t(i) + t(i+1) - 2.0*(y(i+1)-y(i))/(<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(i+1)-<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(i)) ) / ( (<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(i+1)-<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(i))*(<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(i+1)-<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>(i)) );
<a name="l00141"></a>00141     }
<a name="l00142"></a>00142 }
<a name="l00143"></a>00143 
<a name="l00144"></a><a class="code" href="classvotca_1_1tools_1_1AkimaSpline.html#a00b072944b7fc656518a7d06a0100e5a">00144</a> <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1tools_1_1AkimaSpline.html#a00b072944b7fc656518a7d06a0100e5a" title="Fit spline through noisy (x,y) values. Points on resulting fitted spline can be obtained via Calculat...">AkimaSpline::Fit</a>(ub::vector&lt;double&gt; &amp;<a class="code" href="linsolve_8m.html#aaeeb1ead24334ce09a1ffb542f262835">x</a>, ub::vector&lt;double&gt; &amp;y)
<a name="l00145"></a>00145 {
<a name="l00146"></a>00146     <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Akima fit not implemented.&quot;</span>);
<a name="l00147"></a>00147 }
<a name="l00148"></a>00148 
<a name="l00149"></a>00149 }}
</pre></div></div><!-- contents -->
