<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Votca: csg/include/votca/csg/topology.h Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Votca
   &#160;<span id="projectnumber">1.4-dev</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">csg/include/votca/csg/topology.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="topology_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/* </span>
<a name="l00002"></a>00002 <span class="comment"> * Copyright 2009-2011 The VOTCA Development Team (http://www.votca.org)</span>
<a name="l00003"></a>00003 <span class="comment"> *</span>
<a name="l00004"></a>00004 <span class="comment"> * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
<a name="l00005"></a>00005 <span class="comment"> * you may not use this file except in compliance with the License.</span>
<a name="l00006"></a>00006 <span class="comment"> * You may obtain a copy of the License at</span>
<a name="l00007"></a>00007 <span class="comment"> *</span>
<a name="l00008"></a>00008 <span class="comment"> *     http://www.apache.org/licenses/LICENSE-2.0</span>
<a name="l00009"></a>00009 <span class="comment"> *</span>
<a name="l00010"></a>00010 <span class="comment"> * Unless required by applicable law or agreed to in writing, software</span>
<a name="l00011"></a>00011 <span class="comment"> * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<a name="l00012"></a>00012 <span class="comment"> * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<a name="l00013"></a>00013 <span class="comment"> * See the License for the specific language governing permissions and</span>
<a name="l00014"></a>00014 <span class="comment"> * limitations under the License.</span>
<a name="l00015"></a>00015 <span class="comment"> *</span>
<a name="l00016"></a>00016 <span class="comment"> */</span>
<a name="l00017"></a>00017 
<a name="l00018"></a>00018 <span class="preprocessor">#ifndef _topology_H</span>
<a name="l00019"></a>00019 <span class="preprocessor"></span><span class="preprocessor">#define _topology_H</span>
<a name="l00020"></a>00020 <span class="preprocessor"></span>
<a name="l00021"></a>00021 <span class="preprocessor">#include &lt;vector&gt;</span>
<a name="l00022"></a>00022 <span class="preprocessor">#include &lt;map&gt;</span>
<a name="l00023"></a>00023 <span class="preprocessor">#include &lt;list&gt;</span>
<a name="l00024"></a>00024 
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;assert.h&gt;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &lt;<a class="code" href="types_8h.html">votca/tools/types.h</a>&gt;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &lt;<a class="code" href="vec_8h.html">votca/tools/vec.h</a>&gt;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &lt;<a class="code" href="matrix_8h.html">votca/tools/matrix.h</a>&gt;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include &quot;<a class="code" href="exclusionlist_8h.html">exclusionlist.h</a>&quot;</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &quot;<a class="code" href="bead_8h.html">bead.h</a>&quot;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &quot;<a class="code" href="molecule_8h.html">molecule.h</a>&quot;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &quot;<a class="code" href="residue_8h.html">residue.h</a>&quot;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &quot;<a class="code" href="beadtype_8h.html">beadtype.h</a>&quot;</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &quot;<a class="code" href="boundarycondition_8h.html">boundarycondition.h</a>&quot;</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &quot;<a class="code" href="triclinicbox_8h.html">triclinicbox.h</a>&quot;</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &quot;<a class="code" href="orthorhombicbox_8h.html">orthorhombicbox.h</a>&quot;</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include &quot;<a class="code" href="openbox_8h.html">openbox.h</a>&quot;</span>
<a name="l00038"></a>00038 
<a name="l00039"></a>00039 <span class="keyword">namespace </span>votca { <span class="keyword">namespace </span>csg {
<a name="l00040"></a>00040 <span class="keyword">using namespace </span>votca::tools;
<a name="l00041"></a>00041 
<a name="l00042"></a>00042 <span class="keyword">class </span>Interaction;
<a name="l00043"></a><a class="code" href="namespacevotca_1_1csg.html#aff15566d79a02a5290955211cfc342e1">00043</a> <span class="keyword">class </span><a class="code" href="classvotca_1_1csg_1_1ExclusionList.html">ExclusionList</a>;
<a name="l00044"></a>00044 
<a name="l00045"></a>00045 <span class="keyword">typedef</span> vector&lt;Molecule *&gt; <a class="code" href="namespacevotca_1_1csg.html#aff15566d79a02a5290955211cfc342e1">MoleculeContainer</a>;
<a name="l00046"></a><a class="code" href="namespacevotca_1_1csg.html#ace55a6baefdafc7e69e3be947f2ce118">00046</a> <span class="keyword">typedef</span> vector&lt;Bead *&gt; <a class="code" href="namespacevotca_1_1csg.html#ace55a6baefdafc7e69e3be947f2ce118">BeadContainer</a>;
<a name="l00047"></a><a class="code" href="namespacevotca_1_1csg.html#aad6ed2f59d9c9463501405e0f70f6ccf">00047</a> <span class="keyword">typedef</span> vector&lt;BeadType *&gt; <a class="code" href="namespacevotca_1_1csg.html#aad6ed2f59d9c9463501405e0f70f6ccf">BeadTypeContainer</a>;
<a name="l00048"></a><a class="code" href="namespacevotca_1_1csg.html#aed62108cefac0a4b5f0a7bc9e217c168">00048</a> <span class="keyword">typedef</span> vector&lt;Residue *&gt; <a class="code" href="namespacevotca_1_1csg.html#aed62108cefac0a4b5f0a7bc9e217c168">ResidueContainer</a>;
<a name="l00049"></a><a class="code" href="namespacevotca_1_1csg.html#ad563e9fab677c78dbbfe93a8957b102c">00049</a> <span class="keyword">typedef</span> vector&lt;Interaction *&gt; <a class="code" href="namespacevotca_1_1csg.html#ad563e9fab677c78dbbfe93a8957b102c">InteractionContainer</a>;
<a name="l00050"></a>00050 
<a name="l00051"></a>00051 
<a name="l00052"></a>00052 <span class="keyword">using namespace </span>std;
<a name="l00053"></a>00053 
<a name="l00061"></a><a class="code" href="classvotca_1_1csg_1_1Topology.html">00061</a> <span class="keyword">class </span><a class="code" href="classvotca_1_1csg_1_1Topology.html" title="topology of the whole system">Topology</a>
<a name="l00062"></a>00062 {
<a name="l00063"></a>00063 <span class="keyword">public</span>:
<a name="l00065"></a><a class="code" href="classvotca_1_1csg_1_1Topology.html#ad8cc252a80122ef50c6d1e84b5d5271e">00065</a>     <a class="code" href="classvotca_1_1csg_1_1Topology.html#ad8cc252a80122ef50c6d1e84b5d5271e" title="constructor">Topology</a>() {
<a name="l00066"></a>00066         _bc = <span class="keyword">new</span> <a class="code" href="classvotca_1_1csg_1_1OpenBox.html">OpenBox</a>();
<a name="l00067"></a>00067         _has_vel=<span class="keyword">false</span>;
<a name="l00068"></a>00068     }
<a name="l00069"></a>00069     <span class="keyword">virtual</span> ~<a class="code" href="classvotca_1_1csg_1_1Topology.html" title="topology of the whole system">Topology</a>();
<a name="l00070"></a>00070     
<a name="l00074"></a>00074     <span class="keyword">virtual</span> <span class="keywordtype">void</span> Cleanup();
<a name="l00075"></a>00075     
<a name="l00089"></a>00089     <span class="keyword">virtual</span> <a class="code" href="classvotca_1_1csg_1_1Bead.html" title="information about a bead">Bead</a> *CreateBead(<a class="code" href="namespacevotca_1_1tools.html#a745a4af0e5e75e3dfe29fa523cb6ff15">byte_t</a> symmetry, <span class="keywordtype">string</span> name, <a class="code" href="classvotca_1_1csg_1_1BeadType.html" title="Bead Type informaton.">BeadType</a> *type, <span class="keywordtype">int</span> resnr, <span class="keywordtype">double</span> m, <span class="keywordtype">double</span> q);
<a name="l00090"></a>00090 
<a name="l00098"></a>00098     <span class="keyword">virtual</span> <a class="code" href="classvotca_1_1csg_1_1BeadType.html" title="Bead Type informaton.">BeadType</a> *GetOrCreateBeadType(<span class="keywordtype">string</span> name);
<a name="l00099"></a>00099 
<a name="l00105"></a>00105     <span class="keyword">virtual</span> <a class="code" href="classvotca_1_1csg_1_1Molecule.html" title="information about molecules">Molecule</a> *CreateMolecule(<span class="keywordtype">string</span> name);
<a name="l00106"></a>00106 
<a name="l00110"></a>00110     <span class="keywordtype">void</span> CheckMoleculeNaming(<span class="keywordtype">void</span>);
<a name="l00111"></a>00111     
<a name="l00117"></a>00117     <span class="keyword">virtual</span> <a class="code" href="classvotca_1_1csg_1_1Residue.html" title="class for a residue">Residue</a> *CreateResidue(<span class="keywordtype">string</span> name);
<a name="l00118"></a>00118     
<a name="l00125"></a>00125     <span class="keywordtype">void</span> CreateMoleculesByResidue();
<a name="l00126"></a>00126     
<a name="l00133"></a>00133     <span class="keywordtype">void</span> CreateOneBigMolecule(<span class="keywordtype">string</span> name);
<a name="l00134"></a>00134     
<a name="l00142"></a>00142     <span class="keywordtype">void</span> CreateMoleculesByRange(<span class="keywordtype">string</span> name, <span class="keywordtype">int</span> first, <span class="keywordtype">int</span> nbeads, <span class="keywordtype">int</span> nmolecules);
<a name="l00143"></a>00143     
<a name="l00148"></a><a class="code" href="classvotca_1_1csg_1_1Topology.html#a06a4a9e0e5da75ecac3ab73dc514d45d">00148</a>     <span class="keywordtype">int</span> <a class="code" href="classvotca_1_1csg_1_1Topology.html#a06a4a9e0e5da75ecac3ab73dc514d45d" title="number of molecules in the system">MoleculeCount</a>() { <span class="keywordflow">return</span> _molecules.size(); }
<a name="l00149"></a>00149 
<a name="l00154"></a><a class="code" href="classvotca_1_1csg_1_1Topology.html#ad6ffd4e005205905f4456940e58c6af8">00154</a>     <span class="keywordtype">int</span> <a class="code" href="classvotca_1_1csg_1_1Topology.html#ad6ffd4e005205905f4456940e58c6af8">BeadCount</a>() { <span class="keywordflow">return</span> _beads.size(); }
<a name="l00155"></a>00155     
<a name="l00160"></a><a class="code" href="classvotca_1_1csg_1_1Topology.html#a74c28ddd1b95e242842bd59685bb8663">00160</a>     <span class="keywordtype">int</span> <a class="code" href="classvotca_1_1csg_1_1Topology.html#a74c28ddd1b95e242842bd59685bb8663">ResidueCount</a>() { <span class="keywordflow">return</span> _residues.size(); }
<a name="l00161"></a>00161        
<a name="l00167"></a>00167     <a class="code" href="classvotca_1_1csg_1_1Molecule.html" title="information about molecules">Molecule</a> *MoleculeByIndex(<span class="keywordtype">int</span> index);
<a name="l00168"></a>00168     
<a name="l00173"></a><a class="code" href="classvotca_1_1csg_1_1Topology.html#afa2f13a8800309329a994a181ee6ad28">00173</a>     <a class="code" href="namespacevotca_1_1csg.html#ace55a6baefdafc7e69e3be947f2ce118">BeadContainer</a> &amp;<a class="code" href="classvotca_1_1csg_1_1Topology.html#afa2f13a8800309329a994a181ee6ad28">Beads</a>() { <span class="keywordflow">return</span> _beads; }
<a name="l00174"></a>00174 
<a name="l00179"></a><a class="code" href="classvotca_1_1csg_1_1Topology.html#a0170fbccf8838eac2f00c5bf7becd922">00179</a>     <a class="code" href="namespacevotca_1_1csg.html#aed62108cefac0a4b5f0a7bc9e217c168">ResidueContainer</a> &amp;<a class="code" href="classvotca_1_1csg_1_1Topology.html#a0170fbccf8838eac2f00c5bf7becd922">Residues</a>() { <span class="keywordflow">return</span> _residues; }
<a name="l00180"></a>00180 
<a name="l00185"></a><a class="code" href="classvotca_1_1csg_1_1Topology.html#a09854528dfe5a72d914e75bb41f133c6">00185</a>     <a class="code" href="namespacevotca_1_1csg.html#aff15566d79a02a5290955211cfc342e1">MoleculeContainer</a> &amp;<a class="code" href="classvotca_1_1csg_1_1Topology.html#a09854528dfe5a72d914e75bb41f133c6">Molecules</a>() { <span class="keywordflow">return</span> _molecules; }
<a name="l00186"></a>00186 
<a name="l00191"></a><a class="code" href="classvotca_1_1csg_1_1Topology.html#a20e44ccc4dd51cd426530bea8c899d31">00191</a>     <a class="code" href="namespacevotca_1_1csg.html#ad563e9fab677c78dbbfe93a8957b102c">InteractionContainer</a> &amp;<a class="code" href="classvotca_1_1csg_1_1Topology.html#a20e44ccc4dd51cd426530bea8c899d31">BondedInteractions</a>() { <span class="keywordflow">return</span> _interactions; }
<a name="l00192"></a>00192     
<a name="l00193"></a>00193     <span class="keywordtype">void</span> AddBondedInteraction(<a class="code" href="classvotca_1_1csg_1_1Interaction.html" title="base calss for all interactions">Interaction</a> *ic);
<a name="l00194"></a>00194     std::list&lt;Interaction *&gt; InteractionsInGroup(<span class="keyword">const</span> <span class="keywordtype">string</span> &amp;group);
<a name="l00195"></a>00195     
<a name="l00196"></a><a class="code" href="classvotca_1_1csg_1_1Topology.html#aea33a0d0d0073c1f82569ea50a78c91d">00196</a>     <a class="code" href="classvotca_1_1csg_1_1BeadType.html" title="Bead Type informaton.">BeadType</a> *<a class="code" href="classvotca_1_1csg_1_1Topology.html#aea33a0d0d0073c1f82569ea50a78c91d">getBeadType</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> i)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> _beadtypes[i]; }
<a name="l00197"></a><a class="code" href="classvotca_1_1csg_1_1Topology.html#aeb5c7b45bcc49101c7aa8f79a697f277">00197</a>     <a class="code" href="classvotca_1_1csg_1_1Bead.html" title="information about a bead">Bead</a> *<a class="code" href="classvotca_1_1csg_1_1Topology.html#aeb5c7b45bcc49101c7aa8f79a697f277">getBead</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> i)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> _beads[i]; }
<a name="l00198"></a><a class="code" href="classvotca_1_1csg_1_1Topology.html#a9fec2f8d63ec726bf146ff0c587f5404">00198</a>     <a class="code" href="classvotca_1_1csg_1_1Residue.html" title="class for a residue">Residue</a> *<a class="code" href="classvotca_1_1csg_1_1Topology.html#a9fec2f8d63ec726bf146ff0c587f5404">getResidue</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> i)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> _residues[i]; }
<a name="l00199"></a><a class="code" href="classvotca_1_1csg_1_1Topology.html#a1488bff76dbcb6588a9466517333a190">00199</a>     <a class="code" href="classvotca_1_1csg_1_1Molecule.html" title="information about molecules">Molecule</a> *<a class="code" href="classvotca_1_1csg_1_1Topology.html#a1488bff76dbcb6588a9466517333a190">getMolecule</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> i)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> _molecules[i]; }
<a name="l00200"></a>00200        
<a name="l00204"></a><a class="code" href="classvotca_1_1csg_1_1Topology.html#ad4c582d06f723b31e73c05c63b001cc7">00204</a>     <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1csg_1_1Topology.html#ad4c582d06f723b31e73c05c63b001cc7">ClearMoleculeList</a>(){
<a name="l00205"></a>00205         _molecules.clear();
<a name="l00206"></a>00206     }
<a name="l00207"></a>00207     
<a name="l00212"></a>00212     <span class="keywordtype">void</span> Add(<a class="code" href="classvotca_1_1csg_1_1Topology.html" title="topology of the whole system">Topology</a> *top);
<a name="l00213"></a>00213 
<a name="l00218"></a>00218     <span class="keywordtype">void</span> CopyTopologyData(<a class="code" href="classvotca_1_1csg_1_1Topology.html" title="topology of the whole system">Topology</a> *top);
<a name="l00219"></a>00219 
<a name="l00226"></a>00226     <span class="keywordtype">void</span> RenameMolecules(<span class="keywordtype">string</span> range, <span class="keywordtype">string</span> name);
<a name="l00227"></a>00227 
<a name="l00233"></a>00233     <span class="keywordtype">void</span> RenameBeadType(<span class="keywordtype">string</span> name, <span class="keywordtype">string</span> newname);
<a name="l00234"></a>00234     
<a name="l00240"></a>00240     <span class="keywordtype">void</span> SetBeadTypeMass(<span class="keywordtype">string</span> name, <span class="keywordtype">double</span> value);
<a name="l00241"></a>00241 
<a name="l00246"></a><a class="code" href="classvotca_1_1csg_1_1Topology.html#af8a379ac2984eaedfd1b6a9d3f6f6a47">00246</a>     <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1csg_1_1Topology.html#af8a379ac2984eaedfd1b6a9d3f6f6a47">setBox</a>(<span class="keyword">const</span> <a class="code" href="classvotca_1_1tools_1_1matrix.html">matrix</a> &amp;box, <a class="code" href="classvotca_1_1csg_1_1BoundaryCondition.html#a51b6372db30b8292b9d6cf51716af11c">BoundaryCondition::eBoxtype</a> boxtype=<a class="code" href="classvotca_1_1csg_1_1BoundaryCondition.html#a51b6372db30b8292b9d6cf51716af11caef5c17e32f562f73749a1a78e414a4e1">BoundaryCondition::typeAuto</a>) {
<a name="l00247"></a>00247         <span class="comment">// determine box type automatically in case boxtype==typeAuto</span>
<a name="l00248"></a>00248         <span class="keywordflow">if</span>(boxtype==<a class="code" href="classvotca_1_1csg_1_1BoundaryCondition.html#a51b6372db30b8292b9d6cf51716af11caef5c17e32f562f73749a1a78e414a4e1">BoundaryCondition::typeAuto</a>) {
<a name="l00249"></a>00249             boxtype = autoDetectBoxType(box);
<a name="l00250"></a>00250         }
<a name="l00251"></a>00251 
<a name="l00252"></a>00252         <span class="keywordflow">if</span>(_bc) {
<a name="l00253"></a>00253             <span class="keyword">delete</span> (_bc);
<a name="l00254"></a>00254         }
<a name="l00255"></a>00255         
<a name="l00256"></a>00256         <span class="keywordflow">switch</span>(boxtype) {
<a name="l00257"></a>00257             <span class="keywordflow">case</span> <a class="code" href="classvotca_1_1csg_1_1BoundaryCondition.html#a51b6372db30b8292b9d6cf51716af11ca2514edc4c11253ee973af14ec3435538">BoundaryCondition::typeTriclinic</a>:
<a name="l00258"></a>00258                 _bc = <span class="keyword">new</span> <a class="code" href="classvotca_1_1csg_1_1TriclinicBox.html">TriclinicBox</a>();
<a name="l00259"></a>00259                 <span class="keywordflow">break</span>;
<a name="l00260"></a>00260             <span class="keywordflow">case</span> <a class="code" href="classvotca_1_1csg_1_1BoundaryCondition.html#a51b6372db30b8292b9d6cf51716af11caa39302d4d63ce53d46dbe4122c61e3a7">BoundaryCondition::typeOrthorhombic</a>:
<a name="l00261"></a>00261                 _bc = <span class="keyword">new</span> <a class="code" href="classvotca_1_1csg_1_1OrthorhombicBox.html">OrthorhombicBox</a>();
<a name="l00262"></a>00262                 <span class="keywordflow">break</span>;
<a name="l00263"></a>00263             <span class="keywordflow">default</span>:
<a name="l00264"></a>00264                 _bc = <span class="keyword">new</span> <a class="code" href="classvotca_1_1csg_1_1OpenBox.html">OpenBox</a>();
<a name="l00265"></a>00265                 <span class="keywordflow">break</span>;
<a name="l00266"></a>00266         }
<a name="l00267"></a>00267                
<a name="l00268"></a>00268         _bc-&gt;setBox(box);
<a name="l00269"></a>00269     };
<a name="l00270"></a>00270 
<a name="l00275"></a><a class="code" href="classvotca_1_1csg_1_1Topology.html#a17c77ff03972cf2744dbf308636f30cf">00275</a>     <span class="keyword">const</span> <a class="code" href="classvotca_1_1tools_1_1matrix.html">matrix</a> &amp;<a class="code" href="classvotca_1_1csg_1_1Topology.html#a17c77ff03972cf2744dbf308636f30cf">getBox</a>() {
<a name="l00276"></a>00276         <span class="keywordflow">return</span> _bc-&gt;getBox();
<a name="l00277"></a>00277     };
<a name="l00278"></a>00278     
<a name="l00283"></a><a class="code" href="classvotca_1_1csg_1_1Topology.html#a2e350da244c24540d9996b8a840994c0">00283</a>     <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1csg_1_1Topology.html#a2e350da244c24540d9996b8a840994c0">setTime</a>(<span class="keywordtype">double</span> t) { _time = t; };
<a name="l00284"></a>00284 
<a name="l00289"></a><a class="code" href="classvotca_1_1csg_1_1Topology.html#a1c9be221d3a494044d92e3283fe42da6">00289</a>     <span class="keywordtype">double</span> <a class="code" href="classvotca_1_1csg_1_1Topology.html#a1c9be221d3a494044d92e3283fe42da6">getTime</a>() { <span class="keywordflow">return</span> _time; };
<a name="l00290"></a>00290     
<a name="l00295"></a><a class="code" href="classvotca_1_1csg_1_1Topology.html#a8fd83aa5f198ecbc87be823046eec623">00295</a>     <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1csg_1_1Topology.html#a8fd83aa5f198ecbc87be823046eec623">setStep</a>(<span class="keywordtype">int</span> s) { _step = s; };
<a name="l00296"></a>00296 
<a name="l00301"></a><a class="code" href="classvotca_1_1csg_1_1Topology.html#a81334a5f36caa3e78ebb8759881b4288">00301</a>     <span class="keywordtype">int</span> <a class="code" href="classvotca_1_1csg_1_1Topology.html#a81334a5f36caa3e78ebb8759881b4288">getStep</a>() { <span class="keywordflow">return</span> _step; };
<a name="l00302"></a>00302 
<a name="l00307"></a><a class="code" href="classvotca_1_1csg_1_1Topology.html#a992ffd106def51ffd26ac5ee2ab0cd27">00307</a>     <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1csg_1_1Topology.html#a992ffd106def51ffd26ac5ee2ab0cd27">setParticleGroup</a>(<span class="keywordtype">string</span> particle_group) { _particle_group = particle_group; };
<a name="l00308"></a>00308 
<a name="l00313"></a><a class="code" href="classvotca_1_1csg_1_1Topology.html#ada54a2f21ee6ad2bdafaf5504e24232e">00313</a>     <span class="keywordtype">string</span> <a class="code" href="classvotca_1_1csg_1_1Topology.html#ada54a2f21ee6ad2bdafaf5504e24232e">getParticleGroup</a>() { 
<a name="l00314"></a>00314       <span class="keywordflow">return</span> _particle_group; 
<a name="l00315"></a>00315     };
<a name="l00316"></a>00316 
<a name="l00326"></a>00326     <a class="code" href="classvotca_1_1tools_1_1vec.html" title="Vector class for a 3 component vector.">vec</a> getDist(<span class="keywordtype">int</span> bead1, <span class="keywordtype">int</span> bead2) <span class="keyword">const</span>;
<a name="l00327"></a>00327     
<a name="l00337"></a>00337     <a class="code" href="classvotca_1_1tools_1_1vec.html" title="Vector class for a 3 component vector.">vec</a> BCShortestConnection(<span class="keyword">const</span> <a class="code" href="classvotca_1_1tools_1_1vec.html" title="Vector class for a 3 component vector.">vec</a> &amp;r1, <span class="keyword">const</span> <a class="code" href="classvotca_1_1tools_1_1vec.html" title="Vector class for a 3 component vector.">vec</a> &amp;r2) <span class="keyword">const</span>;
<a name="l00338"></a>00338 
<a name="l00345"></a>00345     <span class="keywordtype">double</span> ShortestBoxSize();
<a name="l00346"></a>00346 
<a name="l00351"></a>00351     <span class="keywordtype">double</span> BoxVolume();
<a name="l00352"></a>00352         
<a name="l00356"></a>00356     <span class="keywordtype">void</span> RebuildExclusions();
<a name="l00357"></a>00357 
<a name="l00362"></a><a class="code" href="classvotca_1_1csg_1_1Topology.html#a36fb20d98b9d7ebb7e198ba93224dfb5">00362</a>     <a class="code" href="classvotca_1_1csg_1_1ExclusionList.html">ExclusionList</a> &amp;<a class="code" href="classvotca_1_1csg_1_1Topology.html#a36fb20d98b9d7ebb7e198ba93224dfb5">getExclusions</a>() { <span class="keywordflow">return</span> _exclusions; }
<a name="l00363"></a>00363 
<a name="l00364"></a><a class="code" href="classvotca_1_1csg_1_1Topology.html#ad7bba98fc26b01adc538babbc867da00">00364</a>     <a class="code" href="classvotca_1_1csg_1_1BoundaryCondition.html#a51b6372db30b8292b9d6cf51716af11c">BoundaryCondition::eBoxtype</a> <a class="code" href="classvotca_1_1csg_1_1Topology.html#ad7bba98fc26b01adc538babbc867da00">getBoxType</a>() {
<a name="l00365"></a>00365         <span class="keywordflow">return</span> _bc-&gt;getBoxType();
<a name="l00366"></a>00366     }
<a name="l00367"></a>00367 
<a name="l00368"></a>00368     <span class="keyword">template</span>&lt;<span class="keyword">typename</span> iteratable&gt;
<a name="l00369"></a>00369     <span class="keywordtype">void</span> InsertExclusion(<a class="code" href="classvotca_1_1csg_1_1Bead.html" title="information about a bead">Bead</a> *bead1, iteratable &amp;l);
<a name="l00370"></a>00370 
<a name="l00371"></a><a class="code" href="classvotca_1_1csg_1_1Topology.html#a2663c5cd9c0fa90753c5099414188d9b">00371</a>     <span class="keywordtype">bool</span> <a class="code" href="classvotca_1_1csg_1_1Topology.html#a2663c5cd9c0fa90753c5099414188d9b">HasVel</a>(){<span class="keywordflow">return</span> _has_vel;}
<a name="l00372"></a><a class="code" href="classvotca_1_1csg_1_1Topology.html#a6b6f7ea6c44a25ce10a065834274bc66">00372</a>     <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1csg_1_1Topology.html#a6b6f7ea6c44a25ce10a065834274bc66">SetHasVel</a>(<span class="keyword">const</span> <span class="keywordtype">bool</span> v){ _has_vel=v;}
<a name="l00373"></a>00373 
<a name="l00374"></a><a class="code" href="classvotca_1_1csg_1_1Topology.html#acbb59a7d58342850089adc219c5b9c6e">00374</a>     <span class="keywordtype">bool</span> <a class="code" href="classvotca_1_1csg_1_1Topology.html#acbb59a7d58342850089adc219c5b9c6e">HasForce</a>(){<span class="keywordflow">return</span> _has_force;}
<a name="l00375"></a><a class="code" href="classvotca_1_1csg_1_1Topology.html#a7ca941ebfe0da2a41aee583f46df644b">00375</a>     <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1csg_1_1Topology.html#a7ca941ebfe0da2a41aee583f46df644b">SetHasForce</a>(<span class="keyword">const</span> <span class="keywordtype">bool</span> v){ _has_force=v;}
<a name="l00376"></a>00376 
<a name="l00377"></a>00377 <span class="keyword">protected</span>:
<a name="l00378"></a><a class="code" href="classvotca_1_1csg_1_1Topology.html#ab5640be584b903bef17fef7192a57791">00378</a>     <a class="code" href="classvotca_1_1csg_1_1BoundaryCondition.html">BoundaryCondition</a> *<a class="code" href="classvotca_1_1csg_1_1Topology.html#ab5640be584b903bef17fef7192a57791">_bc</a>;
<a name="l00379"></a>00379 
<a name="l00380"></a>00380     <a class="code" href="classvotca_1_1csg_1_1BoundaryCondition.html#a51b6372db30b8292b9d6cf51716af11c">BoundaryCondition::eBoxtype</a> autoDetectBoxType(<span class="keyword">const</span> <a class="code" href="classvotca_1_1tools_1_1matrix.html">matrix</a> &amp;box);
<a name="l00381"></a>00381 
<a name="l00383"></a><a class="code" href="classvotca_1_1csg_1_1Topology.html#a1643645d812fa78f1199b4186481aca6">00383</a>     <a class="code" href="namespacevotca_1_1csg.html#aad6ed2f59d9c9463501405e0f70f6ccf">BeadTypeContainer</a> <a class="code" href="classvotca_1_1csg_1_1Topology.html#a1643645d812fa78f1199b4186481aca6" title="bead types in the topology">_beadtypes</a>;
<a name="l00384"></a>00384     
<a name="l00386"></a><a class="code" href="classvotca_1_1csg_1_1Topology.html#a9aab78fb952d3b3ca81c383fc66a86b3">00386</a>     <a class="code" href="namespacevotca_1_1csg.html#ace55a6baefdafc7e69e3be947f2ce118">BeadContainer</a> <a class="code" href="classvotca_1_1csg_1_1Topology.html#a9aab78fb952d3b3ca81c383fc66a86b3" title="beads in the topology">_beads</a>;
<a name="l00387"></a>00387     
<a name="l00389"></a><a class="code" href="classvotca_1_1csg_1_1Topology.html#ab9299163907718c2465c082e6f31328f">00389</a>     <a class="code" href="namespacevotca_1_1csg.html#aff15566d79a02a5290955211cfc342e1">MoleculeContainer</a> <a class="code" href="classvotca_1_1csg_1_1Topology.html#ab9299163907718c2465c082e6f31328f" title="molecules in the topology">_molecules</a>;
<a name="l00390"></a>00390     
<a name="l00392"></a><a class="code" href="classvotca_1_1csg_1_1Topology.html#a3f07306074e5e74f1a0301bf8e1339f3">00392</a>     <a class="code" href="namespacevotca_1_1csg.html#aed62108cefac0a4b5f0a7bc9e217c168">ResidueContainer</a> <a class="code" href="classvotca_1_1csg_1_1Topology.html#a3f07306074e5e74f1a0301bf8e1339f3" title="residues in the topology">_residues</a>;
<a name="l00393"></a>00393     
<a name="l00395"></a><a class="code" href="classvotca_1_1csg_1_1Topology.html#a4bd2faca639e5041864d72e52597df7d">00395</a>     <a class="code" href="namespacevotca_1_1csg.html#ad563e9fab677c78dbbfe93a8957b102c">InteractionContainer</a> <a class="code" href="classvotca_1_1csg_1_1Topology.html#a4bd2faca639e5041864d72e52597df7d" title="bonded interactions in the topology">_interactions</a>;
<a name="l00396"></a>00396     
<a name="l00397"></a><a class="code" href="classvotca_1_1csg_1_1Topology.html#a032699f4dbfc24996b44ed79da65bf6c">00397</a>     <a class="code" href="classvotca_1_1csg_1_1ExclusionList.html">ExclusionList</a> <a class="code" href="classvotca_1_1csg_1_1Topology.html#a032699f4dbfc24996b44ed79da65bf6c">_exclusions</a>;
<a name="l00398"></a>00398     
<a name="l00399"></a><a class="code" href="classvotca_1_1csg_1_1Topology.html#a322d68eed6130ba3e288fb7c4e9aa665">00399</a>     map&lt;string, int&gt; <a class="code" href="classvotca_1_1csg_1_1Topology.html#a322d68eed6130ba3e288fb7c4e9aa665">_interaction_groups</a>;
<a name="l00400"></a><a class="code" href="classvotca_1_1csg_1_1Topology.html#af9f617a399f5d1722aea9a78d5295a04">00400</a>     map&lt;string, int&gt; <a class="code" href="classvotca_1_1csg_1_1Topology.html#af9f617a399f5d1722aea9a78d5295a04">_beadtype_map</a>;
<a name="l00401"></a>00401     
<a name="l00402"></a><a class="code" href="classvotca_1_1csg_1_1Topology.html#a8b1ec38fbd9990ea9d84f93d477813b7">00402</a>     map&lt;string, list&lt;Interaction *&gt; &gt; <a class="code" href="classvotca_1_1csg_1_1Topology.html#a8b1ec38fbd9990ea9d84f93d477813b7">_interactions_by_group</a>;
<a name="l00403"></a>00403     
<a name="l00404"></a><a class="code" href="classvotca_1_1csg_1_1Topology.html#a75c51d1634121d36e7d4b0837fc43f3b">00404</a>     <span class="keywordtype">double</span> <a class="code" href="classvotca_1_1csg_1_1Topology.html#a75c51d1634121d36e7d4b0837fc43f3b">_time</a>;
<a name="l00405"></a><a class="code" href="classvotca_1_1csg_1_1Topology.html#acfa14d15af5bdbc602e5eaebd86d9a94">00405</a>     <span class="keywordtype">int</span> <a class="code" href="classvotca_1_1csg_1_1Topology.html#acfa14d15af5bdbc602e5eaebd86d9a94">_step</a>;
<a name="l00406"></a><a class="code" href="classvotca_1_1csg_1_1Topology.html#a969165b81e7733f9d23fd7c2a5802ecb">00406</a>     <span class="keywordtype">bool</span> <a class="code" href="classvotca_1_1csg_1_1Topology.html#a969165b81e7733f9d23fd7c2a5802ecb">_has_vel</a>;
<a name="l00407"></a><a class="code" href="classvotca_1_1csg_1_1Topology.html#a3d0cdc877af354f9a9bcf8ef6ca3cacc">00407</a>     <span class="keywordtype">bool</span> <a class="code" href="classvotca_1_1csg_1_1Topology.html#a3d0cdc877af354f9a9bcf8ef6ca3cacc">_has_force</a>;
<a name="l00408"></a>00408 
<a name="l00410"></a><a class="code" href="classvotca_1_1csg_1_1Topology.html#a70cd4e6dd6fb5aa51206ed071ef15726">00410</a>     <span class="keywordtype">string</span> <a class="code" href="classvotca_1_1csg_1_1Topology.html#a70cd4e6dd6fb5aa51206ed071ef15726" title="The particle group (For H5MD file format)">_particle_group</a>;
<a name="l00411"></a>00411 };
<a name="l00412"></a>00412 
<a name="l00413"></a><a class="code" href="classvotca_1_1csg_1_1Topology.html#a179f41931a5a8dc9f40cee62ed4f3a4a">00413</a> <span class="keyword">inline</span> <a class="code" href="classvotca_1_1csg_1_1Bead.html" title="information about a bead">Bead</a> *<a class="code" href="classvotca_1_1csg_1_1Topology.html#a179f41931a5a8dc9f40cee62ed4f3a4a" title="creates a new Bead">Topology::CreateBead</a>(<a class="code" href="namespacevotca_1_1tools.html#a745a4af0e5e75e3dfe29fa523cb6ff15">byte_t</a> symmetry, <span class="keywordtype">string</span> name, <a class="code" href="classvotca_1_1csg_1_1BeadType.html" title="Bead Type informaton.">BeadType</a> *type, <span class="keywordtype">int</span> resnr, <span class="keywordtype">double</span> m, <span class="keywordtype">double</span> q)
<a name="l00414"></a>00414 {
<a name="l00415"></a>00415     
<a name="l00416"></a>00416     <a class="code" href="classvotca_1_1csg_1_1Bead.html" title="information about a bead">Bead</a> *<a class="code" href="linsolve_8m.html#a21ad0bd836b90d08f4cf640b4c298e7c">b</a> = <span class="keyword">new</span> <a class="code" href="classvotca_1_1csg_1_1Bead.html" title="information about a bead">Bead</a>(<span class="keyword">this</span>, _beads.size(), type, symmetry, name, resnr, m, q);    
<a name="l00417"></a>00417     _beads.push_back(b);
<a name="l00418"></a>00418     <span class="keywordflow">return</span> <a class="code" href="linsolve_8m.html#a21ad0bd836b90d08f4cf640b4c298e7c">b</a>;
<a name="l00419"></a>00419 }
<a name="l00420"></a>00420 
<a name="l00421"></a><a class="code" href="classvotca_1_1csg_1_1Topology.html#a87a10bc0957a1465dad5b3899cb6e932">00421</a> <span class="keyword">inline</span> <a class="code" href="classvotca_1_1csg_1_1Molecule.html" title="information about molecules">Molecule</a> *<a class="code" href="classvotca_1_1csg_1_1Topology.html#a87a10bc0957a1465dad5b3899cb6e932" title="creates a new molecule">Topology::CreateMolecule</a>(<span class="keywordtype">string</span> name)
<a name="l00422"></a>00422 {
<a name="l00423"></a>00423     <a class="code" href="classvotca_1_1csg_1_1Molecule.html" title="information about molecules">Molecule</a> *mol = <span class="keyword">new</span> <a class="code" href="classvotca_1_1csg_1_1Molecule.html" title="information about molecules">Molecule</a>(<span class="keyword">this</span>, _molecules.size(), name);
<a name="l00424"></a>00424     _molecules.push_back(mol);
<a name="l00425"></a>00425     <span class="keywordflow">return</span> mol;
<a name="l00426"></a>00426 }
<a name="l00427"></a>00427 
<a name="l00428"></a><a class="code" href="classvotca_1_1csg_1_1Topology.html#a6afd6c41235c5ab30132963c4b50ff78">00428</a> <span class="keyword">inline</span> <a class="code" href="classvotca_1_1csg_1_1Residue.html" title="class for a residue">Residue</a> *<a class="code" href="classvotca_1_1csg_1_1Topology.html#a6afd6c41235c5ab30132963c4b50ff78" title="create a new resiude">Topology::CreateResidue</a>(<span class="keywordtype">string</span> name)
<a name="l00429"></a>00429 {
<a name="l00430"></a>00430     <a class="code" href="classvotca_1_1csg_1_1Residue.html" title="class for a residue">Residue</a> *res = <span class="keyword">new</span> <a class="code" href="classvotca_1_1csg_1_1Residue.html" title="class for a residue">Residue</a>(<span class="keyword">this</span>, _molecules.size(), name);
<a name="l00431"></a>00431     _residues.push_back(res);
<a name="l00432"></a>00432     <span class="keywordflow">return</span> res;
<a name="l00433"></a>00433 }
<a name="l00434"></a>00434 
<a name="l00435"></a><a class="code" href="classvotca_1_1csg_1_1Topology.html#a0afd2679a2e24fc61044e85c3bd66f49">00435</a> <span class="keyword">inline</span> <a class="code" href="classvotca_1_1csg_1_1Molecule.html" title="information about molecules">Molecule</a> *<a class="code" href="classvotca_1_1csg_1_1Topology.html#a0afd2679a2e24fc61044e85c3bd66f49">Topology::MoleculeByIndex</a>(<span class="keywordtype">int</span> index)
<a name="l00436"></a>00436 {
<a name="l00437"></a>00437     <span class="keywordflow">return</span> _molecules[index];
<a name="l00438"></a>00438 }
<a name="l00439"></a>00439 
<a name="l00440"></a>00440 <span class="keyword">template</span>&lt;<span class="keyword">typename</span> iteratable&gt;
<a name="l00441"></a><a class="code" href="classvotca_1_1csg_1_1Topology.html#ad53d06ddf5eee720e7968e2dd37ac861">00441</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1csg_1_1Topology.html#ad53d06ddf5eee720e7968e2dd37ac861">Topology::InsertExclusion</a>(<a class="code" href="classvotca_1_1csg_1_1Bead.html" title="information about a bead">Bead</a> *bead1, iteratable &amp;l) {
<a name="l00442"></a>00442     _exclusions.InsertExclusion(bead1, l);
<a name="l00443"></a>00443 }
<a name="l00444"></a>00444 
<a name="l00445"></a>00445 }}
<a name="l00446"></a>00446 
<a name="l00447"></a>00447 <span class="preprocessor">#include &quot;<a class="code" href="interaction_8h.html">interaction.h</a>&quot;</span>
<a name="l00448"></a>00448 
<a name="l00449"></a>00449 <span class="preprocessor">#endif  </span><span class="comment">/* _topology_H */</span>
<a name="l00450"></a>00450 
</pre></div></div><!-- contents -->
