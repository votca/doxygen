<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>votca: /home/votca/votca/share/doc/DEVELOPERS_GUIDE.md Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">votca
   &#160;<span id="projectnumber">1.6-dev</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">/home/votca/votca/share/doc/DEVELOPERS_GUIDE.md</div>  </div>
</div><!--header-->
<div class="contents">
<a href="DEVELOPERS__GUIDE_8md.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;# Developer and Contributor Guide</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160; The page is designed to give new developers general guidelines for</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160; implementing code consistent with the VOTCA and cpp style and standard.</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160; </div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160; - [Reporting Bugs](#reporting-bugs)</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160; - [CPP Resoures](#cpp-resources)</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160; - [CPP Tips](#cpp-tips)</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160; - [Testing](#testing)</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160; - [Failed Travis Builds](#failed-travis-builds)</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160; - [CPP Codeing Style Guide](#cpp-codeing-style-guide)</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160; - [CPP Comment Guide](#cpp-comment-guide)</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160; - [Updating Git Submodules](#updating-git-submodules)</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160; - [Failed Release Builds](#failed-release-builds)</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160; </div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;## Reporting Bugs</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160; To report a bug please create an issue on the appropriate github repo. Please</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160; be sure to provide as much information as possible such as:</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160; - The error messages</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160; - The operating system </div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160; - What compiler was used</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160; - What dependencies were installed</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160; - The calculation that was being run</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160; Issues can be directed created on the appropriate github repo:</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160; - [tools](https://github.com/votca/tools/issues)</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160; - [csg](https://github.com/votca/csg/issues)</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160; - [csgapps](https://github.com/votca/csgapps/issues)</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160; - [csg-manual](https://github.com/votca/csg-manual/issues)</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; - [csg-tutorials](https://github.com/votca/csg-tutorials/issues)</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160; - [ctp](https://github.com/votca/ctp/issues)</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160; - [xtp](https://github.com/votca/xtp/issues)</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160; - [votca](https://github.com/votca/votca/issues)</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;## CPP Resources</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160; A good starting point is to take a look at the cpp standard. Though the code</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160; has not always consistently followed the cpp standard we now make an</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160; effort to really enforce it and follow best practices.</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160; - [Best Practices1](https://www.gitbook.com/book/lefticus/cpp-best-practices/details)</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; - [Best Practices2](https://google.github.io/styleguide/cppguide.html)</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;## CPP Tips</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; Here are a few general tips that should be followed:</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160; </div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;### Files ###</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  * each class goes into a separate file</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  * filename is name of class in lowercase</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;### Includes ###</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  * When including a header file from within the same repo that you are working use the relative includes. This consists of using quotation marks i.e. </div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;```</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;#include &quot;molecule.h&quot;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;```</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  * When including from another repository, for instance you are working in the csg repostory and want to include a file from the tools repo use the anglular brackets i.e.</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;```</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;#include &lt;votca/tools/table.h&gt;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;```</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;### Header Files ###</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  * One class, one header.</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  * When creating header gruards use the following form, where &quot;VOTCA-REPO-NAME&quot; is replaced by whichever repo the header is in tools/csg/ctp/xtp, and where &quot;CLASS-NAME&quot; is replaced by the name of the class described in the header file:</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;```</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;#ifndef VOTCA_VOTCA-REPO-NAME_CLASS-NAME_H</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;#define VOTCA_VOTCA-REPO-NAME_CLASS-NAME_H</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;:</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;Code</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;:</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;#endif // VOTCA_VOTCA-REPO-NAME_CLASS-NAME_H</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;```</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  * Never use the &quot;using namespace&quot; in a header file.</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  * Avoid using includes in header files. If possible forward declare a class instead.</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;### Braces ###</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  * in functions/classes, the { is in the next line</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  * for for loops, if, ..., the { is n the same line as if,for</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;### Auto ###</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  * avoid using auto unless the type is very long, the reason being auto obscures the underlying type and can make it difficult to discern what a variable is meant to be used for</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;### Classes ###</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  * normally begin in upper case</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  * exceptions: classes which define &quot;small&quot; types (e.g. `vec`, `matrix`)</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  * order in class definition:</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    * first `public` all functions</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    * then `private`/`protected` all member variables</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    * then `private`/`protected` member functions</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    * no rule where to define a `public typedef` in the class</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  * all member variables are `private`/`public` (again exception e.g. `vec`, `matrix`)</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  * maximum one-line-function implementation in class declaration, everything else moves to separate file or inline at end of header.</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;### Naming in Classes ###</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  * all member variables are in lower case and end with `_`</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  * all functions start with upper case, no `_` in names</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  * exception: `get`/`set` functions</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  * for consistency all Ids should start at 0 not 1 </div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;### get/set Functions ###</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  * get/set functions start with a lowercase set/get (these are only functions which directly set/get a private member variable)</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  * get must return a constant reference and keep the `class const`: `const int &amp;getId() const;`</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  * set only sets the member, e.g. `void setId(const int &amp;id) {_id=id;}`</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;### Functions ###</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  * Make functions short.</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  * Functions should not have more than one use. So use boolean arguments sparingly.</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160; </div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;### General ###</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  * Do not comment out code, if you do not use it delete it.</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  * Variables should have clear and explicit names.</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  * Do not duplicate code.</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  * Functions should have no more than 3 arguments. Otherwise create a class.</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  * XYZ positions should be described using tools::vec, 3x3 matrices tools::matrix, or classes and or functions in the eigen library.</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  * Readability is more important the elegant design.</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  * Leave the code better than you found it.</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  * Use pointers sparingly and especially try not to pass them around objects. Prefer references.</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  * Do not write code, which you may use in the future. Only write code you will use now. Write code, you need later, later. This avoids cluttering the codebase with unused &quot;at some point we will need this functions&quot;.</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  </div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;## Testing</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;### Unit Testing ###</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160; Each repository contains a src folder. Within the src folder exists a </div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; library folder: libtools, libcsg etc... and a tools folder. A tests folder</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; should also exist in the src folder. If it does not you should create one.</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; For every new object and algorithm created there should exist a test. We</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160; use the Boost libraries testing framework. Good documentation can be found </div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160; here:</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160; - [Boost link](https://www.ibm.com/developerworks/aix/library/au-ctools1_boost/)</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160; </div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; We will outline the general workflow here using the vec object in </div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160; votca::tools. This object only has a header file it is in:</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160; tools/include/votca/tools/vec.h</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160; </div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160; Determine if a tests folder has already been created or not in /src if it</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160; has not take a look at what was done in the votca-tools repo. </div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; 1. Create a test file in [tools/src/tests/](https://github.com/votca/tools/tree/master/src/tests)test_vec.cc </div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    must have the same name as what appears in the foreach in the </div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    CMakeLists.txt file. And place the following contents</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;```  </div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;#define BOOST_TEST_MAIN</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;#define BOOST_TEST_MODULE vec_test</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;#include &lt;boost/test/unit_test.hpp&gt;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;#include &lt;exception&gt;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;#include &lt;votca/tools/vec.h&gt;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;using namespace std;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;using namespace votca::tools;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;BOOST_AUTO_TEST_SUITE(vec_test)</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;BOOST_AUTO_TEST_CASE(test1){</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  vecv;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  BOOST_CHECK_EQUAL(...);</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  BOOST_CHECK_EQUAL(...);</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  :</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;}</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;BOOST_AUTO_TEST_CASE(test2){</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  vecv;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  BOOST_CHECK_EQUAL(...);</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  BOOST_CHECK_EQUAL(...);</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  :</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;}</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;:</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;BOOST_AUTO_TEST_SUITE_END()</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;```</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160; </div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;Replace the &#39;...&#39; and &#39;:&#39; with the appropriate syntax. </div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;For more info on which boost test macros to use refer to the boost documentation</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160; 2. To compile and test the code create a folder tools/build and run the following</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    commands: </div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;```</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;cmake -DENABLE_TESTING=ON ../</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;make </div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;make test</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;```</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;Ensure you have an up to date version of cmake or use cmake3 </div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;### Testing Across Repos ###</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;There may come a case where changes have to be committed across more than one repo at the same time. Attempting to merge one repo at a time will cause the continuous integration to fail as changes in the other repos will not be pulled in. To do this correctly the following steps should be taken.</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;Assuming you are in the votca/votca repository:</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    git checkout &lt;base_branch&gt;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    git submodule update</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    git checkout -b &lt;some_descriptive_branch_name&gt;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    git submodule foreach git remote update</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    git -C &lt;module1&gt; checkout &lt;sha_or_branch_of_module1_to_test&gt;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    git -C &lt;module2&gt; checkout &lt;sha_or_branch_of_module2_to_test&gt;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    git add &lt;module1&gt; &lt;module2&gt;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    git commit -m &quot;test &lt;module1&gt; with &lt;module2&gt;&quot;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    git push origin &lt;some_descriptive_branch_name&gt;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;1. Here `base_branch` will typically be the master or stable branch.</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    git checkout &lt;base_branch&gt;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160; </div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;2. The submodules are updated to be sure they have incorporated the latest changes in your local repository</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;   git submodule update</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160; </div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;3. Create a branch with a descriptive name</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;   git checkout -b &lt;some_descriptive_name&gt; </div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;4. Update each of the submodules, by pulling in any remote changes to the submodules. </div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;   git submodule foreach git remote update</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;5. &#39;-C&#39; changes directory to the submodule directory and then checks out the appropriate commit</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    git -C &lt;module1&gt; checkout &lt;sha_or_branch_of_module1_to_test&gt;                 </div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    git -C &lt;module2&gt; checkout &lt;sha_or_branch_of_module2_to_test&gt;  </div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;6. The changes are then added and commited</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    git add &lt;module1&gt; &lt;module2&gt;                                                  </div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    git commit -m &quot;test &lt;module1&gt; with &lt;module2&gt;&quot; </div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;7. Finally, they are pushed to the remote branch</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    git push origin &lt;some_descriptive_branch_name&gt;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;A pull request is then made for the votca/votca repo using the branch name. Once the branch passes all tests it can be merged. Pull requests for each of repos changed can then be made. They will now compile against the updated votca/votca repo. Once they pass their tests they can be merged. If a pull request was already made the travis tests may simply need to be restarted. </div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;## Failed Travis Builds</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;There may come a time where one of the docker builds fails. It may be the case</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;that the error message is clear and it can be reproduced on your host os.</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;However, in the case that the error is specific to the enviorment used in the</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;build the local enviornment can be simulated using a docker container. </div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;Before you can use this approach docker must be installed on your host OS. Begin</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;by running a docker image the default is:</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;```</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;docker run -it votca/buildenv:fedora /bin/bash</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;```</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;This will run an interative docker container which you can interact with in bash</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;. The next commands will need to be adjusted to whatever local environment you </div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;need to reproduce to test the error in the travis build.</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;## CPP Codeing Style Guide</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; VOTCA uses the clang formatter to automatically ensure consistent style.</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160; The style follows the google style fomatting rules. </div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160; Have a look at `.clang-format file` in the</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160; [main votca repository](https://github.com/votca/votca/blob/master/.clang-format) for details.</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;To run the clang-format function on file.cc  </div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;```</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;clang-format -i -style=file file.cc</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;```</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;&#39;-i&#39; ensures it will make change to file.cc, omitting the &#39;-i&#39; will display the</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;     changes without implementing them.</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;&#39;-style=file&#39; ensures the format is read from the .clang-format file otherwise </div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;     it will use a default style guide. </div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;By default tabs should not be used to indent, avoid inserting &#39;\t&#39;, it is</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;preferable that spaces be used instead.</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;Clang formatting can be automated at every commit using the script found in the [dev-tools](https://github.com/votca/dev-tools) repository. To use it copy the file `pre-commit` to your local .git subfolder to the hooks folder. E.g.</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    </div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    chmod 777 dev-tools/pre-commit  </div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    cp dev-tools/pre-commit tools/.git/hooks/</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;The above will make the script executable and then copy it to the local .git/hooks directory in the tools repository. The script not only updates the file format of every file staged during a commit it will also update the license date. </div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;## CPP Comment Guide</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160; </div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160; It is preferential that the following guidelines be followed when adding </div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160; comments to code:</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160; 1. The `/* */` comment blocks should be avoided and the `//` used in their </div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    place. This is so that the `/* */` comment blocks can be easily used for </div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    debugging.</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160; 2. It would be preferential that the following doxygen commenting stencil be </div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    used in the header files above each class and function description.</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;```</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;/**</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;* \brief function/class summary</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;*</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;* Detailed function/class description if needed</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;*</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;* @param[in] - description of parameter 1</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;* @param[out] - description of parameter 2</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;* @param[in,out] - description of parameter 3</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;* :</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;* @return - description of return type</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;*/</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;```</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;The doxygen commenting will help future developers maintain the code, in its </div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;fully compiled state it may be found at: http://doc.votca.org</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;NOTE: Compilation of the doxygen documentation is automated when code is merged</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;into the master votca branch!</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;## Updating Git Submodules</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160; Votca with all of its repos can be build by using the parent [votca repo](https://github.com/votca/votca). All</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160; the other necessary repos appear as submodules in the parent repo. It is worth</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160; noting that the submodules are not automatically updated whenever changes are</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160; made to their respective master branches. In essence a submodule refers to a</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160; specific commit of the repo it represents. If a new commit is merged into the</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160; master branch of a repository the submodule state in the parent repo has to be</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160; updated for the commit to propagate to the parent votca repository. </div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160; To update the state of a submodule the following commands can be used:</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;```</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;git submodule foreach git checkout master</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;git submodule foreach git pull</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;git add -u</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;git commit -m &quot;update all submodules&quot;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;```</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;## Failed Release Builds</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;To prepare votca for distribution on different linux flavors there are different</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;requirements from the package managers. Some of the architectures that the </div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;package managers support can be quite varied. In the case that a failure occurs</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;on an architecture that is not available to you there are different approaches</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;to debugging the problem. As an example fedora dnf has extended support to the</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;**pcc64le** architecture. Assuming you have access to fedora you can run the </div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;following commands to simulate the build process on the **pcc64le** architecture:</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;```</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;dnf update</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;dnf install qemu-user-static dnf-utils</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;usermod -a -G mock &lt;username&gt;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;mock -r epel-7-ppc64le --forcearch ppc64le --dnf --init</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;wget https://raw.githubusercontent.com/votca/fedora-copr/master/votca.spec</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;spectool -g votca.spec</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;rpmbuild -D&quot;_sourcedir ${PWD}&quot; -D&quot;_srcrpmdir ${PWD}&quot; -bs votca.spec</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;mock -r epel-7-ppc64le --forcearch ppc64le --dnf --no-clean votca-1.5-1.*.src.rpm</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;```</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;Here, votca-1.5-1 should be replaced with the correct version. The above </div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;commands would setup and run the dnf installation process on the **pcc64le** </div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;enviroment. If a bug was found and the build crashes one can interactively </div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;intervene by issuing the following command: </div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;```</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;mock -r epel-7-ppc64le --forcearch ppc64le --shell</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;```</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;You will also need to install a text editor if you want to change the source </div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;files before running the interactive instance. </div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;```</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;mock -r epel-7-ppc64le --forcearch ppc64le --install vim</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;```</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;Note: we have used this process with the **ppc64le** architecture as an example, but</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;the same procedure can be extended with different architectures and diferent </div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;operating systems. For example you could use the **aarch64** or **armv7hl** architecture</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;in place of **pcc64le**. You could also replace the **epel-7-ppc64le** os-architecure to</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;**fedora-28-ppc64le**, **fedora-27-aarch64** or some other combination. A final point,</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;if you simply want to build natively for instance if you are running fedora on</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;an **x86_64** machine the `frocearch pcc64le` in the above case could just be</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;dropped. </div></div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
