<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>votca: /home/votca/votca/xtp/src/libxtp/gwbse/bse.cc Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">votca
   &#160;<span id="projectnumber">1.5-dev</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_74c2a4b3b0df7b8317fa7dedf91a69e4.html">xtp</a></li><li class="navelem"><a class="el" href="dir_939a47b76fcf2b405f4898a413fd95f4.html">src</a></li><li class="navelem"><a class="el" href="dir_dc926f450391b6c725d23f976d3dbdae.html">libxtp</a></li><li class="navelem"><a class="el" href="dir_424ef99ed33494391ca261a22d2bab93.html">gwbse</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">bse.cc</div>  </div>
</div><!--header-->
<div class="contents">
<a href="bse_8cc.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> *            Copyright 2009-2018 The VOTCA Development Team</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *                       (http://www.votca.org)</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *      Licensed under the Apache License, Version 2.0 (the &quot;License&quot;)</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> * You may not use this file except in compliance with the License.</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> * You may obtain a copy of the License at</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> *              http://www.apache.org/licenses/LICENSE-2.0</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> * Unless required by applicable law or agreed to in writing, software</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> * See the License for the specific language governing permissions and</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> * limitations under the License.</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="bse_8h.html">votca/xtp/bse.h</a>&gt;</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="tools_2include_2votca_2tools_2linalg_8h.html">votca/tools/linalg.h</a>&gt;</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="qmstate_8h.html">votca/xtp/qmstate.h</a>&quot;</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="vc2index_8h.html">votca/xtp/vc2index.h</a>&quot;</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="keyword">using</span> boost::format;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="keyword">using</span> std::flush;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacevotca.html">votca</a> {</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  <span class="keyword">namespace </span>xtp {</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div><div class="line"><a name="l00032"></a><span class="lineno"><a class="line" href="classvotca_1_1xtp_1_1BSE.html#a96dc53469d0c9a408f68fac0e608c8d0">   32</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a96dc53469d0c9a408f68fac0e608c8d0">BSE::Solve_triplets</a>() {</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;      <a class="code" href="namespacevotca_1_1xtp.html#a1562003c814c961d9fe41b42be6e2e61">MatrixXfd</a> H = MatrixXfd::Zero(<a class="code" href="classvotca_1_1xtp_1_1BSE.html#af918a62226b3540d74d5cb3a26f698fd">_bse_size</a>,<a class="code" href="classvotca_1_1xtp_1_1BSE.html#af918a62226b3540d74d5cb3a26f698fd">_bse_size</a>);</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;      Add_Hd&lt;real_gwbse&gt;(H);</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;      Add_Hqp&lt;real_gwbse&gt;(H);</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;      <a class="code" href="logger_8h.html#ad144516788c83f08acfbbe29b2e25de5">CTP_LOG</a>(<a class="code" href="namespacevotca_1_1ctp.html#a6ca95ba08b5f1943b39d7c0d0fad0616a316f858e85e6a70732b82e35ac4e190f">ctp::logDEBUG</a>, *<a class="code" href="classvotca_1_1xtp_1_1BSE.html#ab01686e5fb6e4bf7af0d15b93b368e94">_log</a>)</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        &lt;&lt; <a class="code" href="classvotca_1_1ctp_1_1TimeStamp.html">ctp::TimeStamp</a>() &lt;&lt; <span class="stringliteral">&quot; Setup TDA triplet hamiltonian &quot;</span> &lt;&lt; flush;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;      <a class="code" href="logger_8h.html#ad144516788c83f08acfbbe29b2e25de5">CTP_LOG</a>(<a class="code" href="namespacevotca_1_1ctp.html#a6ca95ba08b5f1943b39d7c0d0fad0616a316f858e85e6a70732b82e35ac4e190f">ctp::logDEBUG</a>, *<a class="code" href="classvotca_1_1xtp_1_1BSE.html#ab01686e5fb6e4bf7af0d15b93b368e94">_log</a>)</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;        &lt;&lt; <a class="code" href="classvotca_1_1ctp_1_1TimeStamp.html">ctp::TimeStamp</a>() &lt;&lt; <span class="stringliteral">&quot; Solving for first &quot;</span>&lt;&lt;<a class="code" href="classvotca_1_1xtp_1_1BSE.html#a115226eefd5c5a8a824d8af20fe5b950">_bse_nmax</a>&lt;&lt;<span class="stringliteral">&quot; eigenvectors&quot;</span>&lt;&lt; flush;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;      <a class="code" href="namespacevotca_1_1tools.html#a6881886e89aaff8eed117ff8b4829143">tools::linalg_eigenvalues</a>(H , <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a83f5f71108ccc4c4803deabe09484e51">_bse_triplet_energies</a>, <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a5d6b75f37990fe0bd4cda744d3620fff">_bse_triplet_coefficients</a> ,<a class="code" href="classvotca_1_1xtp_1_1BSE.html#a115226eefd5c5a8a824d8af20fe5b950">_bse_nmax</a> );</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    }</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div><div class="line"><a name="l00044"></a><span class="lineno"><a class="line" href="classvotca_1_1xtp_1_1BSE.html#abc159fa7cf85ba50c3345c6f6c48d090">   44</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1xtp_1_1BSE.html#abc159fa7cf85ba50c3345c6f6c48d090">BSE::Solve_singlets</a>() {</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;      <a class="code" href="namespacevotca_1_1xtp.html#a1562003c814c961d9fe41b42be6e2e61">MatrixXfd</a> H = MatrixXfd::Zero(<a class="code" href="classvotca_1_1xtp_1_1BSE.html#af918a62226b3540d74d5cb3a26f698fd">_bse_size</a>,<a class="code" href="classvotca_1_1xtp_1_1BSE.html#af918a62226b3540d74d5cb3a26f698fd">_bse_size</a>);</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;      Add_Hd&lt;real_gwbse&gt;(H);</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;      Add_Hqp&lt;real_gwbse&gt;(H);</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;      Add_Hx&lt;real_gwbse&gt;(H,2.0);</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;      <a class="code" href="logger_8h.html#ad144516788c83f08acfbbe29b2e25de5">CTP_LOG</a>(<a class="code" href="namespacevotca_1_1ctp.html#a6ca95ba08b5f1943b39d7c0d0fad0616a316f858e85e6a70732b82e35ac4e190f">ctp::logDEBUG</a>, *<a class="code" href="classvotca_1_1xtp_1_1BSE.html#ab01686e5fb6e4bf7af0d15b93b368e94">_log</a>)</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        &lt;&lt; <a class="code" href="classvotca_1_1ctp_1_1TimeStamp.html">ctp::TimeStamp</a>() &lt;&lt; <span class="stringliteral">&quot; Setup TDA singlet hamiltonian &quot;</span> &lt;&lt; flush;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;      <a class="code" href="logger_8h.html#ad144516788c83f08acfbbe29b2e25de5">CTP_LOG</a>(<a class="code" href="namespacevotca_1_1ctp.html#a6ca95ba08b5f1943b39d7c0d0fad0616a316f858e85e6a70732b82e35ac4e190f">ctp::logDEBUG</a>, *<a class="code" href="classvotca_1_1xtp_1_1BSE.html#ab01686e5fb6e4bf7af0d15b93b368e94">_log</a>)</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        &lt;&lt; <a class="code" href="classvotca_1_1ctp_1_1TimeStamp.html">ctp::TimeStamp</a>() &lt;&lt; <span class="stringliteral">&quot; Solving for first &quot;</span>&lt;&lt;<a class="code" href="classvotca_1_1xtp_1_1BSE.html#a115226eefd5c5a8a824d8af20fe5b950">_bse_nmax</a>&lt;&lt;<span class="stringliteral">&quot; eigenvectors&quot;</span>&lt;&lt; flush;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      <a class="code" href="namespacevotca_1_1tools.html#a6881886e89aaff8eed117ff8b4829143">tools::linalg_eigenvalues</a>(H, <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a655b9df724d0fed8bb143dcc9f75eb9d">_bse_singlet_energies</a>, <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a833659b261da7a1aa2a55e23f6aa0d15">_bse_singlet_coefficients</a> , <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a115226eefd5c5a8a824d8af20fe5b950">_bse_nmax</a> );</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    }</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    </div><div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="classvotca_1_1xtp_1_1BSE.html#a3e8f2542dc74006f76a704c390f9ddd0">   57</a></span>&#160;     <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a3e8f2542dc74006f76a704c390f9ddd0">BSE::SetupHs</a>(){</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a4966da27d2c68bdf1acab7935d749911">_eh_s</a> = MatrixXfd::Zero(<a class="code" href="classvotca_1_1xtp_1_1BSE.html#af918a62226b3540d74d5cb3a26f698fd">_bse_size</a>,<a class="code" href="classvotca_1_1xtp_1_1BSE.html#af918a62226b3540d74d5cb3a26f698fd">_bse_size</a>);</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      Add_Hd&lt;real_gwbse&gt;(<a class="code" href="classvotca_1_1xtp_1_1BSE.html#a4966da27d2c68bdf1acab7935d749911">_eh_s</a>);</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;      Add_Hqp&lt;real_gwbse&gt;(<a class="code" href="classvotca_1_1xtp_1_1BSE.html#a4966da27d2c68bdf1acab7935d749911">_eh_s</a>);</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      Add_Hx&lt;real_gwbse&gt;(<a class="code" href="classvotca_1_1xtp_1_1BSE.html#a4966da27d2c68bdf1acab7935d749911">_eh_s</a>,2.0);</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;     }</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  </div><div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="classvotca_1_1xtp_1_1BSE.html#acba26a80c8cfe0bedb4bc1ddd205de3f">   64</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1xtp_1_1BSE.html#acba26a80c8cfe0bedb4bc1ddd205de3f">BSE::SetupHt</a>(){</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      <a class="code" href="classvotca_1_1xtp_1_1BSE.html#aac58b5167c0743f6f7e12ae79e71ed7c">_eh_t</a> = MatrixXfd::Zero(<a class="code" href="classvotca_1_1xtp_1_1BSE.html#af918a62226b3540d74d5cb3a26f698fd">_bse_size</a>,<a class="code" href="classvotca_1_1xtp_1_1BSE.html#af918a62226b3540d74d5cb3a26f698fd">_bse_size</a>);</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      Add_Hd&lt;real_gwbse&gt;(<a class="code" href="classvotca_1_1xtp_1_1BSE.html#aac58b5167c0743f6f7e12ae79e71ed7c">_eh_t</a>);</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;      Add_Hqp&lt;real_gwbse&gt;(<a class="code" href="classvotca_1_1xtp_1_1BSE.html#aac58b5167c0743f6f7e12ae79e71ed7c">_eh_t</a>);</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  }</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    </div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div><div class="line"><a name="l00071"></a><span class="lineno"><a class="line" href="classvotca_1_1xtp_1_1BSE.html#a05a0721af341420b3f89b2149f779e8f">   71</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a05a0721af341420b3f89b2149f779e8f">BSE::Solve_singlets_BTDA</a>() {</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      <span class="comment">// For details of the method, see EPL,78(2007)12001,</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      <span class="comment">// Nuclear Physics A146(1970)449, Nuclear Physics A163(1971)257.</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      <span class="comment">// setup resonant (A) and RARC blocks (B)</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;       <span class="comment">//corresponds to </span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      <span class="comment">// _ApB = (_eh_d +_eh_qp + _eh_d2 + 4.0 * _eh_x);</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      <span class="comment">// _AmB = (_eh_d +_eh_qp - _eh_d2);</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        Eigen::MatrixXd ApB=Eigen::MatrixXd::Zero(<a class="code" href="classvotca_1_1xtp_1_1BSE.html#af918a62226b3540d74d5cb3a26f698fd">_bse_size</a>,<a class="code" href="classvotca_1_1xtp_1_1BSE.html#af918a62226b3540d74d5cb3a26f698fd">_bse_size</a>);</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        Add_Hd&lt;double&gt;(ApB);</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        Add_Hqp&lt;double&gt;(ApB);</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        </div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        Eigen::MatrixXd AmB=ApB;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        Add_Hd2&lt;double&gt;(AmB,-1.0);</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160; </div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        </div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        Add_Hx&lt;double&gt;(ApB,4.0);</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        Add_Hd2&lt;double&gt;(ApB,1.0);</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        <a class="code" href="logger_8h.html#ad144516788c83f08acfbbe29b2e25de5">CTP_LOG</a>(<a class="code" href="namespacevotca_1_1ctp.html#a6ca95ba08b5f1943b39d7c0d0fad0616a316f858e85e6a70732b82e35ac4e190f">ctp::logDEBUG</a>, *<a class="code" href="classvotca_1_1xtp_1_1BSE.html#ab01686e5fb6e4bf7af0d15b93b368e94">_log</a>)</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        &lt;&lt; <a class="code" href="classvotca_1_1ctp_1_1TimeStamp.html">ctp::TimeStamp</a>() &lt;&lt; <span class="stringliteral">&quot; Setup singlet hamiltonian &quot;</span> &lt;&lt; flush;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;     </div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      <span class="comment">// calculate Cholesky decomposition of A-B = LL^T. It throws an error if not positive definite</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      <span class="comment">//(A-B) is not needed any longer and can be overwritten</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;      <a class="code" href="logger_8h.html#ad144516788c83f08acfbbe29b2e25de5">CTP_LOG</a>(<a class="code" href="namespacevotca_1_1ctp.html#a6ca95ba08b5f1943b39d7c0d0fad0616a316f858e85e6a70732b82e35ac4e190f">ctp::logDEBUG</a>, *<a class="code" href="classvotca_1_1xtp_1_1BSE.html#ab01686e5fb6e4bf7af0d15b93b368e94">_log</a>) &lt;&lt; <a class="code" href="classvotca_1_1ctp_1_1TimeStamp.html">ctp::TimeStamp</a>() &lt;&lt; <span class="stringliteral">&quot; Trying Cholesky decomposition of KAA-KAB&quot;</span> &lt;&lt; flush;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      Eigen::LLT&lt; Eigen::Ref&lt;Eigen::MatrixXd&gt; &gt; L(AmB);</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      </div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="ImagePotential_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>=0;<a class="code" href="ImagePotential_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;AmB.rows();++<a class="code" href="ImagePotential_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>){</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=<a class="code" href="ImagePotential_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>+1;j&lt;AmB.cols();++j){</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;          AmB(<a class="code" href="ImagePotential_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>,j)=0;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;          }</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        }</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;      <span class="keywordflow">if</span>(L.info()!=0){</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <a class="code" href="logger_8h.html#ad144516788c83f08acfbbe29b2e25de5">CTP_LOG</a>(<a class="code" href="namespacevotca_1_1ctp.html#a6ca95ba08b5f1943b39d7c0d0fad0616a316f858e85e6a70732b82e35ac4e190f">ctp::logDEBUG</a>, *<a class="code" href="classvotca_1_1xtp_1_1BSE.html#ab01686e5fb6e4bf7af0d15b93b368e94">_log</a>) &lt;&lt; <a class="code" href="classvotca_1_1ctp_1_1TimeStamp.html">ctp::TimeStamp</a>() &lt;&lt;<span class="stringliteral">&quot; Cholesky decomposition of KAA-KAB was unsucessful. Try a smaller basisset. This can indicate a triplet instability.&quot;</span>&lt;&lt;flush;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Cholesky decompostion failed&quot;</span>);</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;      }<span class="keywordflow">else</span>{</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <a class="code" href="logger_8h.html#ad144516788c83f08acfbbe29b2e25de5">CTP_LOG</a>(<a class="code" href="namespacevotca_1_1ctp.html#a6ca95ba08b5f1943b39d7c0d0fad0616a316f858e85e6a70732b82e35ac4e190f">ctp::logDEBUG</a>, *<a class="code" href="classvotca_1_1xtp_1_1BSE.html#ab01686e5fb6e4bf7af0d15b93b368e94">_log</a>) &lt;&lt; <a class="code" href="classvotca_1_1ctp_1_1TimeStamp.html">ctp::TimeStamp</a>() &lt;&lt;<span class="stringliteral">&quot; Cholesky decomposition of KAA-KAB was successful&quot;</span>&lt;&lt;flush;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      }</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      </div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      Eigen::MatrixXd temp= ApB*AmB;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      ApB.noalias() =AmB.transpose()*temp;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      temp.resize(0,0);</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      <a class="code" href="logger_8h.html#ad144516788c83f08acfbbe29b2e25de5">CTP_LOG</a>(<a class="code" href="namespacevotca_1_1ctp.html#a6ca95ba08b5f1943b39d7c0d0fad0616a316f858e85e6a70732b82e35ac4e190f">ctp::logDEBUG</a>, *<a class="code" href="classvotca_1_1xtp_1_1BSE.html#ab01686e5fb6e4bf7af0d15b93b368e94">_log</a>) &lt;&lt; <a class="code" href="classvotca_1_1ctp_1_1TimeStamp.html">ctp::TimeStamp</a>() &lt;&lt; <span class="stringliteral">&quot; Calculated H = L^T(A+B)L &quot;</span> &lt;&lt; flush;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      Eigen::VectorXd eigenvalues;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      Eigen::MatrixXd eigenvectors;     </div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      <a class="code" href="logger_8h.html#ad144516788c83f08acfbbe29b2e25de5">CTP_LOG</a>(<a class="code" href="namespacevotca_1_1ctp.html#a6ca95ba08b5f1943b39d7c0d0fad0616a316f858e85e6a70732b82e35ac4e190f">ctp::logDEBUG</a>, *<a class="code" href="classvotca_1_1xtp_1_1BSE.html#ab01686e5fb6e4bf7af0d15b93b368e94">_log</a>)</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        &lt;&lt; <a class="code" href="classvotca_1_1ctp_1_1TimeStamp.html">ctp::TimeStamp</a>() &lt;&lt; <span class="stringliteral">&quot; Solving for first &quot;</span>&lt;&lt;<a class="code" href="classvotca_1_1xtp_1_1BSE.html#a115226eefd5c5a8a824d8af20fe5b950">_bse_nmax</a>&lt;&lt;<span class="stringliteral">&quot; eigenvectors&quot;</span>&lt;&lt; flush;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      <span class="keywordtype">bool</span> success_diag=<a class="code" href="namespacevotca_1_1tools.html#a6881886e89aaff8eed117ff8b4829143">tools::linalg_eigenvalues</a>(ApB, eigenvalues, eigenvectors ,<a class="code" href="classvotca_1_1xtp_1_1BSE.html#a115226eefd5c5a8a824d8af20fe5b950">_bse_nmax</a>);</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      <span class="keywordflow">if</span>(!success_diag){</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        <a class="code" href="logger_8h.html#ad144516788c83f08acfbbe29b2e25de5">CTP_LOG</a>(<a class="code" href="namespacevotca_1_1ctp.html#a6ca95ba08b5f1943b39d7c0d0fad0616a316f858e85e6a70732b82e35ac4e190f">ctp::logDEBUG</a>, *<a class="code" href="classvotca_1_1xtp_1_1BSE.html#ab01686e5fb6e4bf7af0d15b93b368e94">_log</a>) &lt;&lt; <a class="code" href="classvotca_1_1ctp_1_1TimeStamp.html">ctp::TimeStamp</a>() &lt;&lt; <span class="stringliteral">&quot; Could not solve problem&quot;</span> &lt;&lt; flush;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      }<span class="keywordflow">else</span>{</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        <a class="code" href="logger_8h.html#ad144516788c83f08acfbbe29b2e25de5">CTP_LOG</a>(<a class="code" href="namespacevotca_1_1ctp.html#a6ca95ba08b5f1943b39d7c0d0fad0616a316f858e85e6a70732b82e35ac4e190f">ctp::logDEBUG</a>, *<a class="code" href="classvotca_1_1xtp_1_1BSE.html#ab01686e5fb6e4bf7af0d15b93b368e94">_log</a>) &lt;&lt; <a class="code" href="classvotca_1_1ctp_1_1TimeStamp.html">ctp::TimeStamp</a>() &lt;&lt; <span class="stringliteral">&quot; Solved HR_l = eps_l^2 R_l &quot;</span> &lt;&lt; flush;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      }</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      ApB.resize(0,0);</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      eigenvalues=eigenvalues.cwiseSqrt();</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;     </div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="preprocessor">#if (GWBSE_DOUBLE)</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a655b9df724d0fed8bb143dcc9f75eb9d">_bse_singlet_energies</a> =eigenvalues;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a655b9df724d0fed8bb143dcc9f75eb9d">_bse_singlet_energies</a> = eigenvalues.cast&lt;<span class="keywordtype">float</span>&gt;(); </div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;      <span class="comment">// reconstruct real eigenvectors X_l = 1/2 [sqrt(eps_l) (L^T)^-1 + 1/sqrt(eps_l)L ] R_l</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      <span class="comment">//                               Y_l = 1/2 [sqrt(eps_l) (L^T)^-1 - 1/sqrt(eps_l)L ] R_l</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;      <span class="comment">// determine inverse of L^T</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;     Eigen::MatrixXd LmT = AmB.inverse().transpose();</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      <span class="keywordtype">int</span> dim = LmT.rows();</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;      <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a655b9df724d0fed8bb143dcc9f75eb9d">_bse_singlet_energies</a>.resize(<a class="code" href="classvotca_1_1xtp_1_1BSE.html#a115226eefd5c5a8a824d8af20fe5b950">_bse_nmax</a>);</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a833659b261da7a1aa2a55e23f6aa0d15">_bse_singlet_coefficients</a>.resize(dim, <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a115226eefd5c5a8a824d8af20fe5b950">_bse_nmax</a>); <span class="comment">// resonant part (_X_evec)</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      <a class="code" href="classvotca_1_1xtp_1_1BSE.html#af224e01bdc671521570c8e4ff1a596d0">_bse_singlet_coefficients_AR</a>.resize(dim, <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a115226eefd5c5a8a824d8af20fe5b950">_bse_nmax</a>); <span class="comment">// anti-resonant part (_Y_evec)</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> level = 0; level &lt; <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a115226eefd5c5a8a824d8af20fe5b950">_bse_nmax</a>; level++) {</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        <span class="comment">//real_gwbse sqrt_eval = sqrt(_eigenvalues(_i));</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <span class="keywordtype">double</span> sqrt_eval = sqrt(<a class="code" href="classvotca_1_1xtp_1_1BSE.html#a655b9df724d0fed8bb143dcc9f75eb9d">_bse_singlet_energies</a>(level));</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <span class="comment">// get l-th reduced EV</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="preprocessor">#if (GWBSE_DOUBLE)</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a833659b261da7a1aa2a55e23f6aa0d15">_bse_singlet_coefficients</a>.col(level) = (0.5 / sqrt_eval * (<a class="code" href="classvotca_1_1xtp_1_1BSE.html#a655b9df724d0fed8bb143dcc9f75eb9d">_bse_singlet_energies</a>(level) * LmT + AmB) * eigenvectors.col(level));</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        <a class="code" href="classvotca_1_1xtp_1_1BSE.html#af224e01bdc671521570c8e4ff1a596d0">_bse_singlet_coefficients_AR</a>.col(level) = (0.5 / sqrt_eval * (<a class="code" href="classvotca_1_1xtp_1_1BSE.html#a655b9df724d0fed8bb143dcc9f75eb9d">_bse_singlet_energies</a>(level) * LmT - AmB) * eigenvectors.col(level));</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a833659b261da7a1aa2a55e23f6aa0d15">_bse_singlet_coefficients</a>.col(level) = (0.5 / sqrt_eval * (<a class="code" href="classvotca_1_1xtp_1_1BSE.html#a655b9df724d0fed8bb143dcc9f75eb9d">_bse_singlet_energies</a>(level) * LmT + AmB) * eigenvectors.col(level)).cast&lt;float&gt;();</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <a class="code" href="classvotca_1_1xtp_1_1BSE.html#af224e01bdc671521570c8e4ff1a596d0">_bse_singlet_coefficients_AR</a>.col(level) = (0.5 / sqrt_eval * (<a class="code" href="classvotca_1_1xtp_1_1BSE.html#a655b9df724d0fed8bb143dcc9f75eb9d">_bse_singlet_energies</a>(level) * LmT - AmB) * eigenvectors.col(level)).cast&lt;float&gt;();</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      }</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    }</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;   </div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div><div class="line"><a name="l00159"></a><span class="lineno"><a class="line" href="classvotca_1_1xtp_1_1BSE.html#a403e94722fe6e1530fbd8b90a69983fb">  159</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a403e94722fe6e1530fbd8b90a69983fb">BSE::Add_Hqp</a>(Eigen::Matrix&lt;T, Eigen::Dynamic, Eigen::Dynamic&gt;&amp; H) {</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    </div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <a class="code" href="classvotca_1_1xtp_1_1vc2index.html">vc2index</a> vc=<a class="code" href="classvotca_1_1xtp_1_1vc2index.html">vc2index</a>(0,0,<a class="code" href="classvotca_1_1xtp_1_1BSE.html#a18aad705363f0204ab7c050b0cc55be0">_bse_ctotal</a>);</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    </div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="keyword">const</span> Eigen::MatrixXd&amp; Hqp=*<a class="code" href="classvotca_1_1xtp_1_1BSE.html#a478b8e8ac7e99050dc0ef356880be30b">_Hqp</a>;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="preprocessor">#pragma omp parallel for</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> v1 = 0; v1 &lt; <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a1dfe9b85c4ed31090f202786a9c23770">_bse_vtotal</a>; v1++) {</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c1 = 0; c1 &lt; <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a18aad705363f0204ab7c050b0cc55be0">_bse_ctotal</a>; c1++) {</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;          <span class="keywordtype">int</span> index_vc =vc.<a class="code" href="classvotca_1_1xtp_1_1vc2index.html#aa218bb6f36419754a625ff44416c0665">I</a>(v1,c1);</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;          <span class="comment">// diagonal</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;          H(index_vc, index_vc) += Hqp(c1 + <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a1dfe9b85c4ed31090f202786a9c23770">_bse_vtotal</a>, c1 + <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a1dfe9b85c4ed31090f202786a9c23770">_bse_vtotal</a>) -Hqp(v1, v1);</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;          <span class="comment">// v-&gt;c</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c2 = 0; c2 &lt; <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a18aad705363f0204ab7c050b0cc55be0">_bse_ctotal</a>; c2++) {</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            <span class="keywordtype">int</span> index_vc2 = vc.<a class="code" href="classvotca_1_1xtp_1_1vc2index.html#aa218bb6f36419754a625ff44416c0665">I</a>(v1,c2);</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            <span class="keywordflow">if</span> (c1 != c2) {</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;              H(index_vc, index_vc2) += Hqp(c1 + <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a1dfe9b85c4ed31090f202786a9c23770">_bse_vtotal</a>, c2 + <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a1dfe9b85c4ed31090f202786a9c23770">_bse_vtotal</a>);</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            }</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;          }</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;          <span class="comment">// c-&gt; v</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> v2 = 0; v2 &lt; <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a1dfe9b85c4ed31090f202786a9c23770">_bse_vtotal</a>; v2++) {</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;            <span class="keywordtype">int</span> index_vc2 = vc.<a class="code" href="classvotca_1_1xtp_1_1vc2index.html#aa218bb6f36419754a625ff44416c0665">I</a>(v2,c1);</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;            <span class="keywordflow">if</span> (v1 != v2) {</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;              H(index_vc, index_vc2) -= Hqp(v1, v2);</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            }</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;          }</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        }</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      }</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    }</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div><div class="line"><a name="l00190"></a><span class="lineno"><a class="line" href="classvotca_1_1xtp_1_1BSE.html#a368aa01495c74adb91bdf1e98a3ee0e4">  190</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a368aa01495c74adb91bdf1e98a3ee0e4">BSE::Add_Hd</a>(Eigen::Matrix&lt;T, Eigen::Dynamic, Eigen::Dynamic&gt;&amp; H) {</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      <span class="comment">// gwbasis size</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      <span class="keywordtype">int</span> auxsize = <a class="code" href="classvotca_1_1xtp_1_1BSE.html#ac667d6e731c876736788c68478d59916">_Mmn</a>-&gt;<a class="code" href="classvotca_1_1xtp_1_1TCMatrix__gwbse.html#aaf634bf25df723306188eacecec96a3f">getAuxDimension</a>();</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      <span class="keywordtype">int</span> vxv_size=<a class="code" href="classvotca_1_1xtp_1_1BSE.html#a1dfe9b85c4ed31090f202786a9c23770">_bse_vtotal</a> * <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a1dfe9b85c4ed31090f202786a9c23770">_bse_vtotal</a>;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      <span class="keywordtype">int</span> cxc_size=<a class="code" href="classvotca_1_1xtp_1_1BSE.html#a18aad705363f0204ab7c050b0cc55be0">_bse_ctotal</a> * <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a18aad705363f0204ab7c050b0cc55be0">_bse_ctotal</a>;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      </div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      <span class="comment">// messy procedure, first get two matrices for occ and empty subbparts</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;      <span class="comment">// store occs directly transposed</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      <a class="code" href="namespacevotca_1_1xtp.html#a1562003c814c961d9fe41b42be6e2e61">MatrixXfd</a> storage_v = MatrixXfd::Zero(auxsize, vxv_size);</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="preprocessor">#pragma omp parallel for</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> v1 = 0; v1 &lt; <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a1dfe9b85c4ed31090f202786a9c23770">_bse_vtotal</a>; v1++) {</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacevotca_1_1xtp.html#a1562003c814c961d9fe41b42be6e2e61">MatrixXfd</a>&amp; Mmn = (*_Mmn)[v1 + <a class="code" href="classvotca_1_1xtp_1_1BSE.html#ac6ce0dfbb12862428bd2ff11da339b71">_bse_vmin</a> ];</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i_gw = 0; i_gw &lt; auxsize; i_gw++) {</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> v2 = 0; v2 &lt; <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a1dfe9b85c4ed31090f202786a9c23770">_bse_vtotal</a>; v2++) {</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;            <span class="keywordtype">int</span> index_vv = <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a1dfe9b85c4ed31090f202786a9c23770">_bse_vtotal</a> * v1 + v2;         </div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;              storage_v(i_gw,index_vv) = Mmn( v2 + <a class="code" href="classvotca_1_1xtp_1_1BSE.html#ac6ce0dfbb12862428bd2ff11da339b71">_bse_vmin</a>,i_gw);</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;            }</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        }</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      }</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;      <a class="code" href="namespacevotca_1_1xtp.html#a1562003c814c961d9fe41b42be6e2e61">MatrixXfd</a> storage_c = MatrixXfd::Zero(auxsize,cxc_size);</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="preprocessor">#pragma omp parallel for</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c1 = 0; c1 &lt; <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a18aad705363f0204ab7c050b0cc55be0">_bse_ctotal</a>; c1++) {</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacevotca_1_1xtp.html#a1562003c814c961d9fe41b42be6e2e61">MatrixXfd</a>&amp; Mmn = (*_Mmn)[c1 + <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a59ac7afc9048fa69d3eae4cb10c02c90">_bse_cmin</a>];</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i_gw = 0; i_gw &lt; auxsize; i_gw++) {</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c2 = 0; c2 &lt; <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a18aad705363f0204ab7c050b0cc55be0">_bse_ctotal</a>; c2++) {</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            <span class="keywordtype">int</span> index_cc = <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a18aad705363f0204ab7c050b0cc55be0">_bse_ctotal</a> * c1 + c2;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;            storage_c(i_gw, index_cc) = Mmn( c2 + <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a59ac7afc9048fa69d3eae4cb10c02c90">_bse_cmin</a>,i_gw);</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;          }</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        }</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;      }</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;      <span class="comment">// store elements in a vtotal^2 x ctotal^2 matrix</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;      <a class="code" href="namespacevotca_1_1xtp.html#a1562003c814c961d9fe41b42be6e2e61">MatrixXfd</a> storage_prod = storage_v.transpose() *storage_c;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      <span class="comment">// now patch up _storage for screened interaction</span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="preprocessor">#pragma omp parallel for</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i_gw = 0; i_gw &lt; auxsize; i_gw++) {</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classvotca_1_1xtp_1_1BSE.html#a149156603d6acc75400fb29201c8f23c">_ppm</a>-&gt;<a class="code" href="classvotca_1_1xtp_1_1PPM.html#a061e12be0f75c108913a9bf6310ccd90">getPpm_weight</a>()(i_gw) &lt; 1.e-9) {</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> v = 0; v &lt; vxv_size; v++) {</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;            storage_v(i_gw,v ) = 0;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;          }</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c = 0; c &lt; cxc_size; c++) {</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;            storage_c(i_gw, c) = 0;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;          }</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;          <span class="keywordtype">double</span> ppm_factor = sqrt(<a class="code" href="classvotca_1_1xtp_1_1BSE.html#a149156603d6acc75400fb29201c8f23c">_ppm</a>-&gt;<a class="code" href="classvotca_1_1xtp_1_1PPM.html#a061e12be0f75c108913a9bf6310ccd90">getPpm_weight</a>()(i_gw));</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> v = 0; v &lt; vxv_size; v++) {</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;            storage_v(i_gw,v ) *= ppm_factor;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;          }</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c = 0; c &lt; cxc_size; c++) {</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;            storage_c(i_gw, c) *= ppm_factor;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;          }</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        }</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      }</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;      <span class="comment">// multiply and subtract from _storage_prod</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      storage_prod -= storage_v.transpose()*storage_c;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      <span class="comment">// free storage_v and storage_c</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;      storage_c.resize(0, 0);</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;      storage_v.resize(0, 0);</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;      <span class="comment">// finally resort into _eh_d</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      </div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="preprocessor">#pragma omp parallel for</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> v1 = 0; v1 &lt; <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a1dfe9b85c4ed31090f202786a9c23770">_bse_vtotal</a>; v1++) {</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> v2 = 0; v2 &lt; <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a1dfe9b85c4ed31090f202786a9c23770">_bse_vtotal</a>; v2++) {</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;          <span class="keywordtype">int</span> index_vv = <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a1dfe9b85c4ed31090f202786a9c23770">_bse_vtotal</a> * v1 + v2;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c1 = 0; c1 &lt; <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a18aad705363f0204ab7c050b0cc55be0">_bse_ctotal</a>; c1++) {</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;            <span class="keywordtype">int</span> index_vc1 = <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a18aad705363f0204ab7c050b0cc55be0">_bse_ctotal</a> * v1 + c1;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c2 = 0; c2 &lt; <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a18aad705363f0204ab7c050b0cc55be0">_bse_ctotal</a>; c2++) {</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;              <span class="keywordtype">int</span> index_vc2 = <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a18aad705363f0204ab7c050b0cc55be0">_bse_ctotal</a> * v2 + c2;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;              <span class="keywordtype">int</span> index_cc = <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a18aad705363f0204ab7c050b0cc55be0">_bse_ctotal</a> * c1 + c2;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;              H(index_vc1, index_vc2) -= storage_prod(index_vv, index_cc);</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;            }</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;          }</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        }</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;      }</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    }</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div><div class="line"><a name="l00271"></a><span class="lineno"><a class="line" href="classvotca_1_1xtp_1_1BSE.html#a1f5034aaa396a91caa5326f7f81e6776">  271</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a1f5034aaa396a91caa5326f7f81e6776">BSE::Add_Hd2</a>(Eigen::Matrix&lt;T, Eigen::Dynamic, Eigen::Dynamic&gt;&amp; H, <span class="keywordtype">double</span> factor) {</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      <span class="comment">// gwbasis size</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      <span class="keywordtype">int</span> auxsize = <a class="code" href="classvotca_1_1xtp_1_1BSE.html#ac667d6e731c876736788c68478d59916">_Mmn</a>-&gt;<a class="code" href="classvotca_1_1xtp_1_1TCMatrix__gwbse.html#aaf634bf25df723306188eacecec96a3f">getAuxDimension</a>();</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      <span class="keywordtype">int</span> bse_vxc_total=<a class="code" href="classvotca_1_1xtp_1_1BSE.html#a1dfe9b85c4ed31090f202786a9c23770">_bse_vtotal</a> * <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a18aad705363f0204ab7c050b0cc55be0">_bse_ctotal</a>;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      <span class="comment">// messy procedure, first get two matrices for occ and empty subbparts</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;      <span class="comment">// store occs directly transposed</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      <a class="code" href="namespacevotca_1_1xtp.html#a1562003c814c961d9fe41b42be6e2e61">MatrixXfd</a> storage_cv = MatrixXfd::Zero(auxsize,bse_vxc_total);</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="preprocessor">#pragma omp parallel for</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c1 = 0; c1 &lt; <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a18aad705363f0204ab7c050b0cc55be0">_bse_ctotal</a>; c1++) {</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacevotca_1_1xtp.html#a1562003c814c961d9fe41b42be6e2e61">MatrixXfd</a>&amp; Mmn = (*_Mmn)[c1 + <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a59ac7afc9048fa69d3eae4cb10c02c90">_bse_cmin</a> ];</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i_gw = 0; i_gw &lt; auxsize; i_gw++) {</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> v2 = 0; v2 &lt; <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a1dfe9b85c4ed31090f202786a9c23770">_bse_vtotal</a>; v2++) {</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            <span class="keywordtype">int</span> index_cv = <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a1dfe9b85c4ed31090f202786a9c23770">_bse_vtotal</a> * c1 + v2;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;            storage_cv(i_gw,index_cv ) = Mmn( v2 + <a class="code" href="classvotca_1_1xtp_1_1BSE.html#ac6ce0dfbb12862428bd2ff11da339b71">_bse_vmin</a>,i_gw);</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;          }</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        }</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;      }</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      <a class="code" href="namespacevotca_1_1xtp.html#a1562003c814c961d9fe41b42be6e2e61">MatrixXfd</a> storage_vc = MatrixXfd::Zero(auxsize, bse_vxc_total);</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="preprocessor">#pragma omp parallel for</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> v1 = 0; v1 &lt; <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a1dfe9b85c4ed31090f202786a9c23770">_bse_vtotal</a>; v1++) {</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacevotca_1_1xtp.html#a1562003c814c961d9fe41b42be6e2e61">MatrixXfd</a>&amp; Mmn = (*_Mmn)[v1 + <a class="code" href="classvotca_1_1xtp_1_1BSE.html#ac6ce0dfbb12862428bd2ff11da339b71">_bse_vmin</a>];</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i_gw = 0; i_gw &lt; auxsize; i_gw++) {</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c2 = 0; c2 &lt; <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a18aad705363f0204ab7c050b0cc55be0">_bse_ctotal</a>; c2++) {</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;            <span class="keywordtype">int</span> index_vc = <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a18aad705363f0204ab7c050b0cc55be0">_bse_ctotal</a> * v1 + c2;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;            storage_vc(i_gw, index_vc) = Mmn(c2 + <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a59ac7afc9048fa69d3eae4cb10c02c90">_bse_cmin</a>,i_gw);</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;          }</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        }</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;      }</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;      <span class="comment">// store elements in a vtotal^2 x ctotal^2 matrix</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      <a class="code" href="namespacevotca_1_1xtp.html#a1562003c814c961d9fe41b42be6e2e61">MatrixXfd</a> storage_prod = storage_cv.transpose()* storage_vc;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      <span class="comment">// now patch up _storage for screened interaction</span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="preprocessor">#pragma omp parallel for</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i_gw = 0; i_gw &lt; auxsize; i_gw++) {</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classvotca_1_1xtp_1_1BSE.html#a149156603d6acc75400fb29201c8f23c">_ppm</a>-&gt;<a class="code" href="classvotca_1_1xtp_1_1PPM.html#a061e12be0f75c108913a9bf6310ccd90">getPpm_weight</a>()(i_gw) &lt; 1.e-9) {</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> v = 0; v &lt; bse_vxc_total; v++) {</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;            storage_vc(i_gw, v) = 0;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;          }</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c = 0; c &lt; bse_vxc_total; c++) {</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;            storage_cv(i_gw,c ) = 0;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;          }</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;          <span class="keywordtype">double</span> ppm_factor = sqrt(<a class="code" href="classvotca_1_1xtp_1_1BSE.html#a149156603d6acc75400fb29201c8f23c">_ppm</a>-&gt;<a class="code" href="classvotca_1_1xtp_1_1PPM.html#a061e12be0f75c108913a9bf6310ccd90">getPpm_weight</a>()(i_gw));</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> v = 0; v &lt; bse_vxc_total; v++) {</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;            storage_vc(i_gw, v) *= ppm_factor;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;          }</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c = 0; c &lt; bse_vxc_total; c++) {</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;            storage_cv(i_gw,c ) *= ppm_factor;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;          }</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        }</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;      }</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;      <span class="comment">// multiply and subtract from _storage_prod</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;      storage_prod -= storage_cv.transpose() * storage_vc;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;      <span class="comment">// free storage_v and storage_c</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;      storage_cv.resize(0, 0);</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;      storage_vc.resize(0, 0);</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  </div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="preprocessor">#pragma omp parallel for</span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> v1 = 0; v1 &lt; <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a1dfe9b85c4ed31090f202786a9c23770">_bse_vtotal</a>; v1++) {</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> v2 = 0; v2 &lt; <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a1dfe9b85c4ed31090f202786a9c23770">_bse_vtotal</a>; v2++) {</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c1 = 0; c1 &lt; <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a18aad705363f0204ab7c050b0cc55be0">_bse_ctotal</a>; c1++) {</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;            <span class="keywordtype">int</span> index_v1c1 = <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a18aad705363f0204ab7c050b0cc55be0">_bse_ctotal</a> * v1 + c1;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;            <span class="keywordtype">int</span> index_c1v2 = <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a1dfe9b85c4ed31090f202786a9c23770">_bse_vtotal</a> * c1 + v2;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c2 = 0; c2 &lt; <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a18aad705363f0204ab7c050b0cc55be0">_bse_ctotal</a>; c2++) {</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;              <span class="keywordtype">int</span> index_v2c2 = <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a18aad705363f0204ab7c050b0cc55be0">_bse_ctotal</a> * v2 + c2;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;              <span class="keywordtype">int</span> index_v1c2 = <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a18aad705363f0204ab7c050b0cc55be0">_bse_ctotal</a> * v1 + c2;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;              H(index_v1c1, index_v2c2) -= factor*storage_prod(index_c1v2, index_v1c2);</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;            }</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;          }</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        }</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;      }</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    }</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div><div class="line"><a name="l00349"></a><span class="lineno"><a class="line" href="classvotca_1_1xtp_1_1BSE.html#ab04b356fea0c8290b1ad40c95eb74264">  349</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1xtp_1_1BSE.html#ab04b356fea0c8290b1ad40c95eb74264">BSE::Add_Hx</a>(Eigen::Matrix&lt;T, Eigen::Dynamic, Eigen::Dynamic&gt;&amp; H, <span class="keywordtype">double</span> factor) { </div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;      <span class="comment">// gwbasis size</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;      <span class="keywordtype">int</span> auxsize = <a class="code" href="classvotca_1_1xtp_1_1BSE.html#ac667d6e731c876736788c68478d59916">_Mmn</a>-&gt;<a class="code" href="classvotca_1_1xtp_1_1TCMatrix__gwbse.html#aaf634bf25df723306188eacecec96a3f">getAuxDimension</a>();</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;       <a class="code" href="classvotca_1_1xtp_1_1vc2index.html">vc2index</a> vc=<a class="code" href="classvotca_1_1xtp_1_1vc2index.html">vc2index</a>(0,0,<a class="code" href="classvotca_1_1xtp_1_1BSE.html#a18aad705363f0204ab7c050b0cc55be0">_bse_ctotal</a>);</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;      <span class="comment">// get a different storage for 3-center integrals we need</span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;      Eigen::Matrix&lt;T, Eigen::Dynamic, Eigen::Dynamic&gt; storage = Eigen::Matrix&lt;T, Eigen::Dynamic, Eigen::Dynamic&gt;::Zero(auxsize, <a class="code" href="classvotca_1_1xtp_1_1BSE.html#af918a62226b3540d74d5cb3a26f698fd">_bse_size</a>);</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;      <span class="comment">// occupied levels</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="preprocessor">#pragma omp parallel for</span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> v = 0; v &lt; <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a1dfe9b85c4ed31090f202786a9c23770">_bse_vtotal</a>; v++) {</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacevotca_1_1xtp.html#a1562003c814c961d9fe41b42be6e2e61">MatrixXfd</a>&amp; Mmn = (*_Mmn)[v + <a class="code" href="classvotca_1_1xtp_1_1BSE.html#ac6ce0dfbb12862428bd2ff11da339b71">_bse_vmin</a>];</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        <span class="comment">// empty levels</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i_gw = 0; i_gw &lt; auxsize; i_gw++) {</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c = 0; c &lt; <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a18aad705363f0204ab7c050b0cc55be0">_bse_ctotal</a>; c++) {</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;            <span class="keywordtype">int</span> index_vc =vc.<a class="code" href="classvotca_1_1xtp_1_1vc2index.html#aa218bb6f36419754a625ff44416c0665">I</a>(v,c);</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;            storage(i_gw, index_vc) = Mmn(c + <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a59ac7afc9048fa69d3eae4cb10c02c90">_bse_cmin</a>,i_gw);</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;          }</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        }</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      }</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;      <span class="comment">// with this storage, _eh_x is obtained by matrix multiplication</span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;      H += factor*storage.transpose() * storage;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    }</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;</div><div class="line"><a name="l00372"></a><span class="lineno"><a class="line" href="classvotca_1_1xtp_1_1BSE.html#a6e7e24a74f4de93aa3825f12a6916645">  372</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a6e7e24a74f4de93aa3825f12a6916645">BSE::printFragInfo</a>(<span class="keyword">const</span> <a class="code" href="structvotca_1_1xtp_1_1BSE_1_1Population.html">Population</a>&amp; pop, <span class="keywordtype">int</span> <a class="code" href="ImagePotential_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>){</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;      <a class="code" href="logger_8h.html#ad144516788c83f08acfbbe29b2e25de5">CTP_LOG</a>(<a class="code" href="namespacevotca_1_1ctp.html#a6ca95ba08b5f1943b39d7c0d0fad0616a8c6c5f605ebba63a742e19471883f0bb">ctp::logINFO</a>, *<a class="code" href="classvotca_1_1xtp_1_1BSE.html#ab01686e5fb6e4bf7af0d15b93b368e94">_log</a>) &lt;&lt; format(<span class="stringliteral">&quot;           Fragment A -- hole: %1$5.1f%%  electron: %2$5.1f%%  dQ: %3$+5.2f  Qeff: %4$+5.2f&quot;</span>)</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;              % (100.0 * pop.<a class="code" href="structvotca_1_1xtp_1_1BSE_1_1Population.html#ac712c9faccf2e9a760097d788fef833d">popH</a>[<a class="code" href="ImagePotential_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>](0)) % (100.0 * pop.<a class="code" href="structvotca_1_1xtp_1_1BSE_1_1Population.html#a4fed64eb99f97b29b059111fbdd99289">popE</a>[<a class="code" href="ImagePotential_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>](0)) % (pop.<a class="code" href="structvotca_1_1xtp_1_1BSE_1_1Population.html#a9888511f7f243683874c2dfd05f4ad8c">Crgs</a>[<a class="code" href="ImagePotential_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>](0)) % (pop.<a class="code" href="structvotca_1_1xtp_1_1BSE_1_1Population.html#a9888511f7f243683874c2dfd05f4ad8c">Crgs</a>[<a class="code" href="ImagePotential_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>](0) + pop.<a class="code" href="structvotca_1_1xtp_1_1BSE_1_1Population.html#a35e731e3753f0c95a934942845ea411d">popGs</a>(0)) &lt;&lt; flush;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;      <a class="code" href="logger_8h.html#ad144516788c83f08acfbbe29b2e25de5">CTP_LOG</a>(<a class="code" href="namespacevotca_1_1ctp.html#a6ca95ba08b5f1943b39d7c0d0fad0616a8c6c5f605ebba63a742e19471883f0bb">ctp::logINFO</a>, *<a class="code" href="classvotca_1_1xtp_1_1BSE.html#ab01686e5fb6e4bf7af0d15b93b368e94">_log</a>) &lt;&lt; format(<span class="stringliteral">&quot;           Fragment B -- hole: %1$5.1f%%  electron: %2$5.1f%%  dQ: %3$+5.2f  Qeff: %4$+5.2f&quot;</span>)</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;              % (100.0 * pop.<a class="code" href="structvotca_1_1xtp_1_1BSE_1_1Population.html#ac712c9faccf2e9a760097d788fef833d">popH</a>[<a class="code" href="ImagePotential_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>](1)) % (100.0 * pop.<a class="code" href="structvotca_1_1xtp_1_1BSE_1_1Population.html#a4fed64eb99f97b29b059111fbdd99289">popE</a>[<a class="code" href="ImagePotential_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>](1)) % (pop.<a class="code" href="structvotca_1_1xtp_1_1BSE_1_1Population.html#a9888511f7f243683874c2dfd05f4ad8c">Crgs</a>[<a class="code" href="ImagePotential_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>](1)) % (pop.<a class="code" href="structvotca_1_1xtp_1_1BSE_1_1Population.html#a9888511f7f243683874c2dfd05f4ad8c">Crgs</a>[<a class="code" href="ImagePotential_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>](1) + pop.<a class="code" href="structvotca_1_1xtp_1_1BSE_1_1Population.html#a35e731e3753f0c95a934942845ea411d">popGs</a>(1)) &lt;&lt; flush;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    }</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;</div><div class="line"><a name="l00380"></a><span class="lineno"><a class="line" href="classvotca_1_1xtp_1_1BSE.html#a677cf0e7dbfafa4d74cb7c10ff64edb8">  380</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a677cf0e7dbfafa4d74cb7c10ff64edb8">BSE::printWeights</a>(<span class="keywordtype">int</span> i_bse, <span class="keywordtype">double</span> weight){</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        </div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;      <a class="code" href="classvotca_1_1xtp_1_1vc2index.html">vc2index</a> vc=<a class="code" href="classvotca_1_1xtp_1_1vc2index.html">vc2index</a>(<a class="code" href="classvotca_1_1xtp_1_1BSE.html#ac6ce0dfbb12862428bd2ff11da339b71">_bse_vmin</a>,<a class="code" href="classvotca_1_1xtp_1_1BSE.html#a59ac7afc9048fa69d3eae4cb10c02c90">_bse_cmin</a>,<a class="code" href="classvotca_1_1xtp_1_1BSE.html#a18aad705363f0204ab7c050b0cc55be0">_bse_ctotal</a>);</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;      <span class="keywordflow">if</span> (weight &gt; <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a59fedd6887d8e7e30ace483402c884ac">_min_print_weight</a>) {</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        <a class="code" href="logger_8h.html#ad144516788c83f08acfbbe29b2e25de5">CTP_LOG</a>(<a class="code" href="namespacevotca_1_1ctp.html#a6ca95ba08b5f1943b39d7c0d0fad0616a8c6c5f605ebba63a742e19471883f0bb">ctp::logINFO</a>, *<a class="code" href="classvotca_1_1xtp_1_1BSE.html#ab01686e5fb6e4bf7af0d15b93b368e94">_log</a>) &lt;&lt; format(<span class="stringliteral">&quot;           HOMO-%1$-3d -&gt; LUMO+%2$-3d  : %3$3.1f%%&quot;</span>)</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                % (<a class="code" href="classvotca_1_1xtp_1_1BSE.html#afd151553fb022439c024f716dc3823fc">_homo</a> - vc.<a class="code" href="classvotca_1_1xtp_1_1vc2index.html#a3162459b437320572997778a4b83af68">v</a>(i_bse)) % (vc.<a class="code" href="classvotca_1_1xtp_1_1vc2index.html#a78b92c55637c8921adbe7a0f0bc9ee6f">c</a>(i_bse) - <a class="code" href="classvotca_1_1xtp_1_1BSE.html#afd151553fb022439c024f716dc3823fc">_homo</a> - 1) % (100.0 * weight) &lt;&lt; flush;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;      }</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    }</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;</div><div class="line"><a name="l00390"></a><span class="lineno"><a class="line" href="classvotca_1_1xtp_1_1BSE.html#a5e4a45e8e5a1bb3ee6619e04d5cc28a9">  390</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a5e4a45e8e5a1bb3ee6619e04d5cc28a9">BSE::Analyze_singlets</a>(<span class="keyword">const</span> <a class="code" href="classvotca_1_1xtp_1_1AOBasis.html">AOBasis</a>&amp; dftbasis) {</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;      <a class="code" href="structvotca_1_1xtp_1_1BSE_1_1Interaction.html">Interaction</a> act;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;      <a class="code" href="structvotca_1_1xtp_1_1BSE_1_1Population.html">Population</a> pop;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;      <a class="code" href="classvotca_1_1xtp_1_1QMStateType.html">QMStateType</a> singlet=<a class="code" href="classvotca_1_1xtp_1_1QMStateType.html">QMStateType</a>(<a class="code" href="classvotca_1_1xtp_1_1QMStateType.html#ac99cbd6d6ed98f669041f0840b09dfe7ac2ca29ef89597f341a74e08f205c4552">QMStateType::Singlet</a>);</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;      std::vector&lt; tools::vec &gt; transition_dipoles=<a class="code" href="classvotca_1_1xtp_1_1BSE.html#a6eb93e8a6ecb24a0e84e01859305ffe4">CalcCoupledTransition_Dipoles</a>(dftbasis);</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;      <a class="code" href="classvotca_1_1xtp_1_1BSE.html#aa85a34aa3b65e6ceea97e07947b22f9c">_orbitals</a>.<a class="code" href="classvotca_1_1xtp_1_1Orbitals.html#ac8f9814756af473cdbbcf1da5fa29219">TransitionDipoles</a>()=transition_dipoles;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;      std::vector&lt;double&gt; oscs = <a class="code" href="classvotca_1_1xtp_1_1BSE.html#aa85a34aa3b65e6ceea97e07947b22f9c">_orbitals</a>.<a class="code" href="classvotca_1_1xtp_1_1Orbitals.html#a876bd9251b0aaee2a13336380dba55f8">Oscillatorstrengths</a>();</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;      </div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="structvotca_1_1tools_1_1globals.html#a68680885a1bd6265f3aacdcca5ab61c4">tools::globals::verbose</a>){</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        act = <a class="code" href="classvotca_1_1xtp_1_1BSE.html#ae55323af2d531f3b6ac113817bd05340">Analyze_eh_interaction</a>(singlet);</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;      }</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;      <span class="keywordflow">if</span>(dftbasis.<a class="code" href="classvotca_1_1xtp_1_1AOBasis.html#ac6e0f8dae02d6ce22bdd0c914f9d6cc2">getAOBasisFragA</a>() &gt; 0 &amp;&amp; dftbasis.<a class="code" href="classvotca_1_1xtp_1_1AOBasis.html#a6866b3bbd906591ba2af1d897dd6c23f">getAOBasisFragB</a>()&gt;0){</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        pop=<a class="code" href="classvotca_1_1xtp_1_1BSE.html#a189c91297358634740c781b60ecbb417">FragmentPopulations</a>(singlet,dftbasis);</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        <a class="code" href="classvotca_1_1xtp_1_1BSE.html#aa85a34aa3b65e6ceea97e07947b22f9c">_orbitals</a>.<a class="code" href="classvotca_1_1xtp_1_1Orbitals.html#a1b7f65c292294f053dba005e75318305">setFragmentChargesSingEXC</a>(pop.<a class="code" href="structvotca_1_1xtp_1_1BSE_1_1Population.html#a9888511f7f243683874c2dfd05f4ad8c">Crgs</a>);</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        <a class="code" href="classvotca_1_1xtp_1_1BSE.html#aa85a34aa3b65e6ceea97e07947b22f9c">_orbitals</a>.<a class="code" href="classvotca_1_1xtp_1_1Orbitals.html#a39877ff63c3a310331a94e52f6ec6248">setFragment_E_localisation_singlet</a>(pop.<a class="code" href="structvotca_1_1xtp_1_1BSE_1_1Population.html#a4fed64eb99f97b29b059111fbdd99289">popE</a>);</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        <a class="code" href="classvotca_1_1xtp_1_1BSE.html#aa85a34aa3b65e6ceea97e07947b22f9c">_orbitals</a>.<a class="code" href="classvotca_1_1xtp_1_1Orbitals.html#a359fb265681d8ac6126fa015dcdc4b41">setFragment_H_localisation_singlet</a>(pop.<a class="code" href="structvotca_1_1xtp_1_1BSE_1_1Population.html#ac712c9faccf2e9a760097d788fef833d">popH</a>);</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        <a class="code" href="classvotca_1_1xtp_1_1BSE.html#aa85a34aa3b65e6ceea97e07947b22f9c">_orbitals</a>.<a class="code" href="classvotca_1_1xtp_1_1Orbitals.html#aa2184e03957e8d772404922799574be6">setFragmentChargesGS</a>(pop.<a class="code" href="structvotca_1_1xtp_1_1BSE_1_1Population.html#a35e731e3753f0c95a934942845ea411d">popGs</a>);</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;      }</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;      </div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;      <span class="keywordtype">double</span> <a class="code" href="namespacevotca_1_1tools_1_1conv.html#a6f231ae1bc59867ca0e1c76a9fd1f179">hrt2ev</a> = <a class="code" href="namespacevotca_1_1tools_1_1conv.html#a6f231ae1bc59867ca0e1c76a9fd1f179">tools::conv::hrt2ev</a>;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;      <a class="code" href="logger_8h.html#ad144516788c83f08acfbbe29b2e25de5">CTP_LOG</a>(<a class="code" href="namespacevotca_1_1ctp.html#a6ca95ba08b5f1943b39d7c0d0fad0616a8c6c5f605ebba63a742e19471883f0bb">ctp::logINFO</a>, *<a class="code" href="classvotca_1_1xtp_1_1BSE.html#ab01686e5fb6e4bf7af0d15b93b368e94">_log</a>) &lt;&lt; <span class="stringliteral">&quot;  ====== singlet energies (eV) ====== &quot;</span>&lt;&lt; flush;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;      <span class="keywordtype">int</span> maxoutput=(<a class="code" href="classvotca_1_1xtp_1_1BSE.html#a115226eefd5c5a8a824d8af20fe5b950">_bse_nmax</a>&gt;200) ? 200:<a class="code" href="classvotca_1_1xtp_1_1BSE.html#a115226eefd5c5a8a824d8af20fe5b950">_bse_nmax</a>;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="ImagePotential_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="ImagePotential_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; maxoutput; ++<a class="code" href="ImagePotential_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>) {     </div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        <span class="keyword">const</span> <a class="code" href="classvotca_1_1tools_1_1vec.html">tools::vec</a>&amp; trdip = transition_dipoles[<a class="code" href="ImagePotential_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        <span class="keywordtype">double</span> osc = oscs[<a class="code" href="ImagePotential_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structvotca_1_1tools_1_1globals.html#a68680885a1bd6265f3aacdcca5ab61c4">tools::globals::verbose</a>) {</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;          <a class="code" href="logger_8h.html#ad144516788c83f08acfbbe29b2e25de5">CTP_LOG</a>(<a class="code" href="namespacevotca_1_1ctp.html#a6ca95ba08b5f1943b39d7c0d0fad0616a8c6c5f605ebba63a742e19471883f0bb">ctp::logINFO</a>, *<a class="code" href="classvotca_1_1xtp_1_1BSE.html#ab01686e5fb6e4bf7af0d15b93b368e94">_log</a>) &lt;&lt; format(<span class="stringliteral">&quot;  S = %1$4d Omega = %2$+1.12f eV  lamdba = %3$+3.2f nm &lt;FT&gt; = %4$+1.4f &lt;K_x&gt; = %5$+1.4f &lt;K_d&gt; = %6$+1.4f&quot;</span>)</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                  % (<a class="code" href="ImagePotential_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> + 1) % (<a class="code" href="namespacevotca_1_1tools_1_1conv.html#a6f231ae1bc59867ca0e1c76a9fd1f179">hrt2ev</a> * <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a655b9df724d0fed8bb143dcc9f75eb9d">_bse_singlet_energies</a>(<a class="code" href="ImagePotential_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>)) % (1240.0 / (<a class="code" href="namespacevotca_1_1tools_1_1conv.html#a6f231ae1bc59867ca0e1c76a9fd1f179">hrt2ev</a> * <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a655b9df724d0fed8bb143dcc9f75eb9d">_bse_singlet_energies</a>(<a class="code" href="ImagePotential_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>)))</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                  % (<a class="code" href="namespacevotca_1_1tools_1_1conv.html#a6f231ae1bc59867ca0e1c76a9fd1f179">hrt2ev</a> * act.<a class="code" href="structvotca_1_1xtp_1_1BSE_1_1Interaction.html#a556ad40aa3c44aff4bc3ed1300fa66b1">qp_contrib</a>(<a class="code" href="ImagePotential_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>)) % (<a class="code" href="namespacevotca_1_1tools_1_1conv.html#a6f231ae1bc59867ca0e1c76a9fd1f179">hrt2ev</a> * act.<a class="code" href="structvotca_1_1xtp_1_1BSE_1_1Interaction.html#a7e1bc5e100bede77f99274fc7d97eb83">exchange_contrib</a>(<a class="code" href="ImagePotential_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>)) % (<a class="code" href="namespacevotca_1_1tools_1_1conv.html#a6f231ae1bc59867ca0e1c76a9fd1f179">hrt2ev</a> * act.<a class="code" href="structvotca_1_1xtp_1_1BSE_1_1Interaction.html#af45fcff72a934c43da15d2f10b144920">direct_contrib</a>(<a class="code" href="ImagePotential_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>)) &lt;&lt; flush;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;          <a class="code" href="logger_8h.html#ad144516788c83f08acfbbe29b2e25de5">CTP_LOG</a>(<a class="code" href="namespacevotca_1_1ctp.html#a6ca95ba08b5f1943b39d7c0d0fad0616a8c6c5f605ebba63a742e19471883f0bb">ctp::logINFO</a>, *<a class="code" href="classvotca_1_1xtp_1_1BSE.html#ab01686e5fb6e4bf7af0d15b93b368e94">_log</a>) &lt;&lt; format(<span class="stringliteral">&quot;  S = %1$4d Omega = %2$+1.12f eV  lamdba = %3$+3.2f nm&quot;</span>)</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                  % (<a class="code" href="ImagePotential_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> + 1) % (<a class="code" href="namespacevotca_1_1tools_1_1conv.html#a6f231ae1bc59867ca0e1c76a9fd1f179">hrt2ev</a> * <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a655b9df724d0fed8bb143dcc9f75eb9d">_bse_singlet_energies</a>(<a class="code" href="ImagePotential_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>)) % (1240.0 / (<a class="code" href="namespacevotca_1_1tools_1_1conv.html#a6f231ae1bc59867ca0e1c76a9fd1f179">hrt2ev</a> * <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a655b9df724d0fed8bb143dcc9f75eb9d">_bse_singlet_energies</a>(<a class="code" href="ImagePotential_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>))) &lt;&lt; flush;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        }</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        <a class="code" href="logger_8h.html#ad144516788c83f08acfbbe29b2e25de5">CTP_LOG</a>(<a class="code" href="namespacevotca_1_1ctp.html#a6ca95ba08b5f1943b39d7c0d0fad0616a8c6c5f605ebba63a742e19471883f0bb">ctp::logINFO</a>, *<a class="code" href="classvotca_1_1xtp_1_1BSE.html#ab01686e5fb6e4bf7af0d15b93b368e94">_log</a>) &lt;&lt; format(<span class="stringliteral">&quot;           TrDipole length gauge[e*bohr]  dx = %1$+1.4f dy = %2$+1.4f dz = %3$+1.4f |d|^2 = %4$+1.4f f = %5$+1.4f&quot;</span>)</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                % trdip.<a class="code" href="classvotca_1_1tools_1_1vec.html#aa62c261e0b0578d32c47685c42cafdaa">getX</a>() % trdip.<a class="code" href="classvotca_1_1tools_1_1vec.html#a3f5853a9c588a3a31b362a7e690d28b9">getY</a>() % trdip.<a class="code" href="classvotca_1_1tools_1_1vec.html#ae438fb43de95f0b5aac045c9a9f544c5">getZ</a>() % (trdip * trdip) % osc &lt;&lt; flush;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i_bse = 0; i_bse &lt; <a class="code" href="classvotca_1_1xtp_1_1BSE.html#af918a62226b3540d74d5cb3a26f698fd">_bse_size</a>; ++i_bse) {</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;          <span class="comment">// if contribution is larger than 0.2, print</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;          <span class="keywordtype">double</span> weight = std::pow(<a class="code" href="classvotca_1_1xtp_1_1BSE.html#a833659b261da7a1aa2a55e23f6aa0d15">_bse_singlet_coefficients</a>(i_bse, <a class="code" href="ImagePotential_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>), 2);</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="classvotca_1_1xtp_1_1BSE.html#af224e01bdc671521570c8e4ff1a596d0">_bse_singlet_coefficients_AR</a>.rows()&gt;0){</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;               weight-= std::pow(<a class="code" href="classvotca_1_1xtp_1_1BSE.html#af224e01bdc671521570c8e4ff1a596d0">_bse_singlet_coefficients_AR</a>(i_bse, <a class="code" href="ImagePotential_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>), 2);</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;          }</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;          <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a677cf0e7dbfafa4d74cb7c10ff64edb8">printWeights</a>(i_bse, weight);</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        }</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        <span class="comment">// results of fragment population analysis </span></div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        <span class="keywordflow">if</span> (dftbasis.<a class="code" href="classvotca_1_1xtp_1_1AOBasis.html#ac6e0f8dae02d6ce22bdd0c914f9d6cc2">getAOBasisFragA</a>() &gt; 0 &amp;&amp; dftbasis.<a class="code" href="classvotca_1_1xtp_1_1AOBasis.html#a6866b3bbd906591ba2af1d897dd6c23f">getAOBasisFragB</a>()&gt;0) {</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;          <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a6e7e24a74f4de93aa3825f12a6916645">printFragInfo</a>(pop, <a class="code" href="ImagePotential_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        }</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        <a class="code" href="logger_8h.html#ad144516788c83f08acfbbe29b2e25de5">CTP_LOG</a>(<a class="code" href="namespacevotca_1_1ctp.html#a6ca95ba08b5f1943b39d7c0d0fad0616a8c6c5f605ebba63a742e19471883f0bb">ctp::logINFO</a>, *<a class="code" href="classvotca_1_1xtp_1_1BSE.html#ab01686e5fb6e4bf7af0d15b93b368e94">_log</a>) &lt;&lt; flush;</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;      }</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    }</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    </div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    </div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    </div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    </div><div class="line"><a name="l00447"></a><span class="lineno"><a class="line" href="classvotca_1_1xtp_1_1BSE.html#a481374c9dbe613c24eb1271c51c9030d">  447</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a481374c9dbe613c24eb1271c51c9030d">BSE::Analyze_triplets</a>(<span class="keyword">const</span> <a class="code" href="classvotca_1_1xtp_1_1AOBasis.html">AOBasis</a>&amp; dftbasis) {</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;      <a class="code" href="structvotca_1_1xtp_1_1BSE_1_1Interaction.html">Interaction</a> act;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;      <a class="code" href="structvotca_1_1xtp_1_1BSE_1_1Population.html">Population</a> pop;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;      <a class="code" href="classvotca_1_1xtp_1_1QMStateType.html">QMStateType</a> triplet=<a class="code" href="classvotca_1_1xtp_1_1QMStateType.html">QMStateType</a>(<a class="code" href="classvotca_1_1xtp_1_1QMStateType.html#ac99cbd6d6ed98f669041f0840b09dfe7a9d38a794b81a5e5fa8b32d8fc153b015">QMStateType::Triplet</a>);</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="structvotca_1_1tools_1_1globals.html#a68680885a1bd6265f3aacdcca5ab61c4">tools::globals::verbose</a>){</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        act = <a class="code" href="classvotca_1_1xtp_1_1BSE.html#ae55323af2d531f3b6ac113817bd05340">Analyze_eh_interaction</a>(triplet);</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;      }</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;      <span class="keywordflow">if</span>(dftbasis.<a class="code" href="classvotca_1_1xtp_1_1AOBasis.html#ac6e0f8dae02d6ce22bdd0c914f9d6cc2">getAOBasisFragA</a>()&gt;0){</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        pop=<a class="code" href="classvotca_1_1xtp_1_1BSE.html#a189c91297358634740c781b60ecbb417">FragmentPopulations</a>(triplet,dftbasis);</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        <a class="code" href="classvotca_1_1xtp_1_1BSE.html#aa85a34aa3b65e6ceea97e07947b22f9c">_orbitals</a>.<a class="code" href="classvotca_1_1xtp_1_1Orbitals.html#aed468b9bd77e86a52271902e8fee184d">setFragmentChargesTripEXC</a>(pop.<a class="code" href="structvotca_1_1xtp_1_1BSE_1_1Population.html#a9888511f7f243683874c2dfd05f4ad8c">Crgs</a>);</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        <a class="code" href="classvotca_1_1xtp_1_1BSE.html#aa85a34aa3b65e6ceea97e07947b22f9c">_orbitals</a>.<a class="code" href="classvotca_1_1xtp_1_1Orbitals.html#aff5287e0436f56d3758830416cba6410">setFragment_E_localisation_triplet</a>(pop.<a class="code" href="structvotca_1_1xtp_1_1BSE_1_1Population.html#a4fed64eb99f97b29b059111fbdd99289">popE</a>);</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        <a class="code" href="classvotca_1_1xtp_1_1BSE.html#aa85a34aa3b65e6ceea97e07947b22f9c">_orbitals</a>.<a class="code" href="classvotca_1_1xtp_1_1Orbitals.html#a40af72495b8ff4b8dc9b80f9ff6ad16c">setFragment_H_localisation_triplet</a>(pop.<a class="code" href="structvotca_1_1xtp_1_1BSE_1_1Population.html#ac712c9faccf2e9a760097d788fef833d">popH</a>);</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        <a class="code" href="classvotca_1_1xtp_1_1BSE.html#aa85a34aa3b65e6ceea97e07947b22f9c">_orbitals</a>.<a class="code" href="classvotca_1_1xtp_1_1Orbitals.html#aa2184e03957e8d772404922799574be6">setFragmentChargesGS</a>(pop.<a class="code" href="structvotca_1_1xtp_1_1BSE_1_1Population.html#a35e731e3753f0c95a934942845ea411d">popGs</a>);</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;      }</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;      <a class="code" href="logger_8h.html#ad144516788c83f08acfbbe29b2e25de5">CTP_LOG</a>(<a class="code" href="namespacevotca_1_1ctp.html#a6ca95ba08b5f1943b39d7c0d0fad0616a8c6c5f605ebba63a742e19471883f0bb">ctp::logINFO</a>, *<a class="code" href="classvotca_1_1xtp_1_1BSE.html#ab01686e5fb6e4bf7af0d15b93b368e94">_log</a>) &lt;&lt; <span class="stringliteral">&quot;  ====== triplet energies (eV) ====== &quot;</span> &lt;&lt; flush;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;      <span class="keywordtype">int</span> maxoutput=(<a class="code" href="classvotca_1_1xtp_1_1BSE.html#a115226eefd5c5a8a824d8af20fe5b950">_bse_nmax</a>&gt;200) ? 200:<a class="code" href="classvotca_1_1xtp_1_1BSE.html#a115226eefd5c5a8a824d8af20fe5b950">_bse_nmax</a>;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="ImagePotential_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="ImagePotential_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; maxoutput; ++<a class="code" href="ImagePotential_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>) {    </div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structvotca_1_1tools_1_1globals.html#a68680885a1bd6265f3aacdcca5ab61c4">tools::globals::verbose</a>) {</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;          <a class="code" href="logger_8h.html#ad144516788c83f08acfbbe29b2e25de5">CTP_LOG</a>(<a class="code" href="namespacevotca_1_1ctp.html#a6ca95ba08b5f1943b39d7c0d0fad0616a8c6c5f605ebba63a742e19471883f0bb">ctp::logINFO</a>, *<a class="code" href="classvotca_1_1xtp_1_1BSE.html#ab01686e5fb6e4bf7af0d15b93b368e94">_log</a>) &lt;&lt; format(<span class="stringliteral">&quot;  T = %1$4d Omega = %2$+1.12f eV  lamdba = %3$+3.2f nm &lt;FT&gt; = %4$+1.4f &lt;K_d&gt; = %5$+1.4f&quot;</span>)</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                  % (<a class="code" href="ImagePotential_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> + 1) % (<a class="code" href="namespacevotca_1_1tools_1_1conv.html#a6f231ae1bc59867ca0e1c76a9fd1f179">tools::conv::hrt2ev</a> * <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a83f5f71108ccc4c4803deabe09484e51">_bse_triplet_energies</a>(<a class="code" href="ImagePotential_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>)) % (1240.0 / (<a class="code" href="namespacevotca_1_1tools_1_1conv.html#a6f231ae1bc59867ca0e1c76a9fd1f179">tools::conv::hrt2ev</a> * <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a83f5f71108ccc4c4803deabe09484e51">_bse_triplet_energies</a>(<a class="code" href="ImagePotential_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>)))</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                  % (<a class="code" href="namespacevotca_1_1tools_1_1conv.html#a6f231ae1bc59867ca0e1c76a9fd1f179">tools::conv::hrt2ev</a> * act.<a class="code" href="structvotca_1_1xtp_1_1BSE_1_1Interaction.html#a556ad40aa3c44aff4bc3ed1300fa66b1">qp_contrib</a>(<a class="code" href="ImagePotential_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>)) % (<a class="code" href="namespacevotca_1_1tools_1_1conv.html#a6f231ae1bc59867ca0e1c76a9fd1f179">tools::conv::hrt2ev</a> *act.<a class="code" href="structvotca_1_1xtp_1_1BSE_1_1Interaction.html#af45fcff72a934c43da15d2f10b144920">direct_contrib</a>(<a class="code" href="ImagePotential_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>)) &lt;&lt; flush;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;          <a class="code" href="logger_8h.html#ad144516788c83f08acfbbe29b2e25de5">CTP_LOG</a>(<a class="code" href="namespacevotca_1_1ctp.html#a6ca95ba08b5f1943b39d7c0d0fad0616a8c6c5f605ebba63a742e19471883f0bb">ctp::logINFO</a>, *<a class="code" href="classvotca_1_1xtp_1_1BSE.html#ab01686e5fb6e4bf7af0d15b93b368e94">_log</a>) &lt;&lt; format(<span class="stringliteral">&quot;  T = %1$4d Omega = %2$+1.12f eV  lamdba = %3$+3.2f nm&quot;</span>)</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                  % (<a class="code" href="ImagePotential_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> + 1) % (<a class="code" href="namespacevotca_1_1tools_1_1conv.html#a6f231ae1bc59867ca0e1c76a9fd1f179">tools::conv::hrt2ev</a> * <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a83f5f71108ccc4c4803deabe09484e51">_bse_triplet_energies</a>(<a class="code" href="ImagePotential_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>)) % (1240.0 / (<a class="code" href="namespacevotca_1_1tools_1_1conv.html#a6f231ae1bc59867ca0e1c76a9fd1f179">tools::conv::hrt2ev</a> * <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a83f5f71108ccc4c4803deabe09484e51">_bse_triplet_energies</a>(<a class="code" href="ImagePotential_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>))) &lt;&lt; flush;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        }</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i_bse = 0; i_bse &lt; <a class="code" href="classvotca_1_1xtp_1_1BSE.html#af918a62226b3540d74d5cb3a26f698fd">_bse_size</a>; ++i_bse) {</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;          <span class="comment">// if contribution is larger than 0.2, print</span></div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;          <span class="keywordtype">double</span> weight = pow(<a class="code" href="classvotca_1_1xtp_1_1BSE.html#a5d6b75f37990fe0bd4cda744d3620fff">_bse_triplet_coefficients</a>(i_bse, <a class="code" href="ImagePotential_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>), 2);</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;          <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a677cf0e7dbfafa4d74cb7c10ff64edb8">printWeights</a>(i_bse, weight);</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        }</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        <span class="comment">// results of fragment population analysis </span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        <span class="keywordflow">if</span> (dftbasis.<a class="code" href="classvotca_1_1xtp_1_1AOBasis.html#ac6e0f8dae02d6ce22bdd0c914f9d6cc2">getAOBasisFragA</a>() &gt; 0) {</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;          <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a6e7e24a74f4de93aa3825f12a6916645">printFragInfo</a>(pop, <a class="code" href="ImagePotential_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        }</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        <a class="code" href="logger_8h.html#ad144516788c83f08acfbbe29b2e25de5">CTP_LOG</a>(<a class="code" href="namespacevotca_1_1ctp.html#a6ca95ba08b5f1943b39d7c0d0fad0616a8c6c5f605ebba63a742e19471883f0bb">ctp::logINFO</a>, *<a class="code" href="classvotca_1_1xtp_1_1BSE.html#ab01686e5fb6e4bf7af0d15b93b368e94">_log</a>) &lt;&lt; format(<span class="stringliteral">&quot;   &quot;</span>) &lt;&lt; flush;</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;      }</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;      <span class="comment">// storage to orbitals object</span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    }</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;</div><div class="line"><a name="l00489"></a><span class="lineno"><a class="line" href="classvotca_1_1xtp_1_1BSE.html#adf8f7a2feee5d71f8047ce603955a66d">  489</a></span>&#160;    Eigen::VectorXd <a class="code" href="classvotca_1_1xtp_1_1BSE.html#adf8f7a2feee5d71f8047ce603955a66d">BSE::Analyze_IndividualContribution</a>(<span class="keyword">const</span> <a class="code" href="classvotca_1_1xtp_1_1QMStateType.html">QMStateType</a>&amp; type,<span class="keyword">const</span> <a class="code" href="namespacevotca_1_1xtp.html#a1562003c814c961d9fe41b42be6e2e61">MatrixXfd</a>&amp; H){</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        Eigen::VectorXd contrib=Eigen::VectorXd::Zero(<a class="code" href="classvotca_1_1xtp_1_1BSE.html#a115226eefd5c5a8a824d8af20fe5b950">_bse_nmax</a>);</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        <span class="keywordflow">if</span> (type == <a class="code" href="classvotca_1_1xtp_1_1QMStateType.html#ac99cbd6d6ed98f669041f0840b09dfe7ac2ca29ef89597f341a74e08f205c4552">QMStateType::Singlet</a>) {</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i_exc = 0; i_exc &lt; <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a115226eefd5c5a8a824d8af20fe5b950">_bse_nmax</a>; i_exc++) {</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                <a class="code" href="namespacevotca_1_1xtp.html#a1562003c814c961d9fe41b42be6e2e61">MatrixXfd</a> _slice_R = <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a833659b261da7a1aa2a55e23f6aa0d15">_bse_singlet_coefficients</a>.block(0, i_exc, <a class="code" href="classvotca_1_1xtp_1_1BSE.html#af918a62226b3540d74d5cb3a26f698fd">_bse_size</a>, 1);</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                contrib(i_exc) =  (_slice_R.transpose()*H * _slice_R).value();</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classvotca_1_1xtp_1_1BSE.html#af224e01bdc671521570c8e4ff1a596d0">_bse_singlet_coefficients_AR</a>.cols() &gt; 0) {</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                    <a class="code" href="namespacevotca_1_1xtp.html#a1562003c814c961d9fe41b42be6e2e61">MatrixXfd</a> _slice_AR = <a class="code" href="classvotca_1_1xtp_1_1BSE.html#af224e01bdc671521570c8e4ff1a596d0">_bse_singlet_coefficients_AR</a>.block(0, i_exc, <a class="code" href="classvotca_1_1xtp_1_1BSE.html#af918a62226b3540d74d5cb3a26f698fd">_bse_size</a>, 1);</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                    <span class="comment">// get anti-resonant contribution from direct Keh </span></div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;                    contrib(i_exc)-= (_slice_AR.transpose()*H * _slice_AR).value();           </div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                }</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;            }</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type == <a class="code" href="classvotca_1_1xtp_1_1QMStateType.html#ac99cbd6d6ed98f669041f0840b09dfe7a9d38a794b81a5e5fa8b32d8fc153b015">QMStateType::Triplet</a>) {</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i_exc = 0; i_exc &lt; <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a115226eefd5c5a8a824d8af20fe5b950">_bse_nmax</a>; i_exc++) {</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                <a class="code" href="namespacevotca_1_1xtp.html#a1562003c814c961d9fe41b42be6e2e61">MatrixXfd</a> _slice_R = <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a5d6b75f37990fe0bd4cda744d3620fff">_bse_triplet_coefficients</a>.block(0, i_exc, <a class="code" href="classvotca_1_1xtp_1_1BSE.html#af918a62226b3540d74d5cb3a26f698fd">_bse_size</a>, 1);</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                contrib(i_exc) =  (_slice_R.transpose()*H * _slice_R).value();</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;            }</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;            <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;BSE::Analyze_eh_interaction:Spin not known!&quot;</span>);</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        }</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        <span class="keywordflow">return</span> contrib;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    }</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;</div><div class="line"><a name="l00512"></a><span class="lineno"><a class="line" href="classvotca_1_1xtp_1_1BSE.html#ae55323af2d531f3b6ac113817bd05340">  512</a></span>&#160;    <a class="code" href="structvotca_1_1xtp_1_1BSE_1_1Interaction.html">BSE::Interaction</a> <a class="code" href="classvotca_1_1xtp_1_1BSE.html#ae55323af2d531f3b6ac113817bd05340">BSE::Analyze_eh_interaction</a>(<span class="keyword">const</span> <a class="code" href="classvotca_1_1xtp_1_1QMStateType.html">QMStateType</a>&amp; type) {</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;      <a class="code" href="structvotca_1_1xtp_1_1BSE_1_1Interaction.html">Interaction</a> analysis;</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;      <a class="code" href="namespacevotca_1_1xtp.html#a1562003c814c961d9fe41b42be6e2e61">MatrixXfd</a> H = MatrixXfd::Zero(<a class="code" href="classvotca_1_1xtp_1_1BSE.html#af918a62226b3540d74d5cb3a26f698fd">_bse_size</a>, <a class="code" href="classvotca_1_1xtp_1_1BSE.html#af918a62226b3540d74d5cb3a26f698fd">_bse_size</a>);</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;      <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a403e94722fe6e1530fbd8b90a69983fb">Add_Hqp</a>(H); </div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;      analysis.<a class="code" href="structvotca_1_1xtp_1_1BSE_1_1Interaction.html#a556ad40aa3c44aff4bc3ed1300fa66b1">qp_contrib</a>=<a class="code" href="classvotca_1_1xtp_1_1BSE.html#adf8f7a2feee5d71f8047ce603955a66d">Analyze_IndividualContribution</a>(type,H);</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;      </div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;      H = MatrixXfd::Zero(<a class="code" href="classvotca_1_1xtp_1_1BSE.html#af918a62226b3540d74d5cb3a26f698fd">_bse_size</a>, <a class="code" href="classvotca_1_1xtp_1_1BSE.html#af918a62226b3540d74d5cb3a26f698fd">_bse_size</a>);</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;      <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a368aa01495c74adb91bdf1e98a3ee0e4">Add_Hd</a>(H);</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;      analysis.<a class="code" href="structvotca_1_1xtp_1_1BSE_1_1Interaction.html#af45fcff72a934c43da15d2f10b144920">direct_contrib</a>=<a class="code" href="classvotca_1_1xtp_1_1BSE.html#adf8f7a2feee5d71f8047ce603955a66d">Analyze_IndividualContribution</a>(type,H);</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;      <span class="keywordflow">if</span> (type == <a class="code" href="classvotca_1_1xtp_1_1QMStateType.html#ac99cbd6d6ed98f669041f0840b09dfe7ac2ca29ef89597f341a74e08f205c4552">QMStateType::Singlet</a>) {</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;          H = MatrixXfd::Zero(<a class="code" href="classvotca_1_1xtp_1_1BSE.html#af918a62226b3540d74d5cb3a26f698fd">_bse_size</a>, <a class="code" href="classvotca_1_1xtp_1_1BSE.html#af918a62226b3540d74d5cb3a26f698fd">_bse_size</a>);</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;          <a class="code" href="classvotca_1_1xtp_1_1BSE.html#ab04b356fea0c8290b1ad40c95eb74264">Add_Hx</a>(H,2.0);</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;          analysis.<a class="code" href="structvotca_1_1xtp_1_1BSE_1_1Interaction.html#a7e1bc5e100bede77f99274fc7d97eb83">exchange_contrib</a>=<a class="code" href="classvotca_1_1xtp_1_1BSE.html#adf8f7a2feee5d71f8047ce603955a66d">Analyze_IndividualContribution</a>(type,H);</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;      }<span class="keywordflow">else</span>{</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;            analysis.<a class="code" href="structvotca_1_1xtp_1_1BSE_1_1Interaction.html#a7e1bc5e100bede77f99274fc7d97eb83">exchange_contrib</a>=Eigen::VectorXd::Zero(0);</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;      }</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;      </div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;      <span class="keywordflow">return</span> analysis;</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    }</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;</div><div class="line"><a name="l00533"></a><span class="lineno"><a class="line" href="classvotca_1_1xtp_1_1BSE.html#a189c91297358634740c781b60ecbb417">  533</a></span>&#160;    <a class="code" href="structvotca_1_1xtp_1_1BSE_1_1Population.html">BSE::Population</a> <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a189c91297358634740c781b60ecbb417">BSE::FragmentPopulations</a>(<span class="keyword">const</span> <a class="code" href="classvotca_1_1xtp_1_1QMStateType.html">QMStateType</a>&amp; type, <span class="keyword">const</span> <a class="code" href="classvotca_1_1xtp_1_1AOBasis.html">AOBasis</a>&amp; dftbasis) {</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;      <a class="code" href="structvotca_1_1xtp_1_1BSE_1_1Population.html">Population</a> pop;</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;      <span class="comment">// Mulliken fragment population analysis</span></div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        <a class="code" href="classvotca_1_1xtp_1_1AOOverlap.html">AOOverlap</a> dftoverlap;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        dftoverlap.<a class="code" href="classvotca_1_1xtp_1_1AOMatrix.html#a07bb35205ec490af2430937af9db8c25">Fill</a>(dftbasis);</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        <a class="code" href="logger_8h.html#ad144516788c83f08acfbbe29b2e25de5">CTP_LOG</a>(<a class="code" href="namespacevotca_1_1ctp.html#a6ca95ba08b5f1943b39d7c0d0fad0616a316f858e85e6a70732b82e35ac4e190f">ctp::logDEBUG</a>, *<a class="code" href="classvotca_1_1xtp_1_1BSE.html#ab01686e5fb6e4bf7af0d15b93b368e94">_log</a>) &lt;&lt; <a class="code" href="classvotca_1_1ctp_1_1TimeStamp.html">ctp::TimeStamp</a>() &lt;&lt; <span class="stringliteral">&quot; Filled DFT Overlap matrix of dimension: &quot;</span> &lt;&lt; dftoverlap.<a class="code" href="classvotca_1_1xtp_1_1AOMatrix.html#a8e8bf7b7d5eeb87b8c1f001b4533ee17">Matrix</a>().rows() &lt;&lt; flush;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        <span class="comment">// ground state populations</span></div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        Eigen::MatrixXd DMAT = <a class="code" href="classvotca_1_1xtp_1_1BSE.html#aa85a34aa3b65e6ceea97e07947b22f9c">_orbitals</a>.<a class="code" href="classvotca_1_1xtp_1_1Orbitals.html#ac54132162019b4fbb2d431007297ff59">DensityMatrixGroundState</a>();</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        Eigen::VectorXd nuccharges = <a class="code" href="classvotca_1_1xtp_1_1BSE.html#aa85a34aa3b65e6ceea97e07947b22f9c">_orbitals</a>.<a class="code" href="classvotca_1_1xtp_1_1Orbitals.html#ae27ee5c3d7178eed49b698fb84d3ff37">FragmentNuclearCharges</a>(dftbasis.<a class="code" href="classvotca_1_1xtp_1_1AOBasis.html#ac6e0f8dae02d6ce22bdd0c914f9d6cc2">getAOBasisFragA</a>());</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        Eigen::VectorXd pops = <a class="code" href="classvotca_1_1xtp_1_1BSE.html#aa85a34aa3b65e6ceea97e07947b22f9c">_orbitals</a>.<a class="code" href="classvotca_1_1xtp_1_1Orbitals.html#a518ef773cfee05c34dc2a084c0256a58">LoewdinPopulation</a>(DMAT, dftoverlap.<a class="code" href="classvotca_1_1xtp_1_1AOMatrix.html#a8e8bf7b7d5eeb87b8c1f001b4533ee17">Matrix</a>(), dftbasis.<a class="code" href="classvotca_1_1xtp_1_1AOBasis.html#ac6e0f8dae02d6ce22bdd0c914f9d6cc2">getAOBasisFragA</a>());</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;        pop.<a class="code" href="structvotca_1_1xtp_1_1BSE_1_1Population.html#a35e731e3753f0c95a934942845ea411d">popGs</a>=nuccharges - pops;</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;        <span class="comment">// population to electron charges and add nuclear charges         </span></div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i_state = 0; i_state &lt; <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a115226eefd5c5a8a824d8af20fe5b950">_bse_nmax</a>; i_state++) {</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;          <a class="code" href="classvotca_1_1xtp_1_1QMState.html">QMState</a> state=<a class="code" href="classvotca_1_1xtp_1_1QMState.html">QMState</a>(type,i_state,<span class="keyword">false</span>);</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;          <span class="comment">// checking Density Matrices</span></div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;          std::vector&lt; Eigen::MatrixXd &gt; DMAT = <a class="code" href="classvotca_1_1xtp_1_1BSE.html#aa85a34aa3b65e6ceea97e07947b22f9c">_orbitals</a>.<a class="code" href="classvotca_1_1xtp_1_1Orbitals.html#ad5b0df3a865c2927104af6d3e3c8772f">DensityMatrixExcitedState</a>(state);</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;          <span class="comment">// hole part</span></div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;          Eigen::VectorXd popsH = <a class="code" href="classvotca_1_1xtp_1_1BSE.html#aa85a34aa3b65e6ceea97e07947b22f9c">_orbitals</a>.<a class="code" href="classvotca_1_1xtp_1_1Orbitals.html#a518ef773cfee05c34dc2a084c0256a58">LoewdinPopulation</a>(DMAT[0], dftoverlap.<a class="code" href="classvotca_1_1xtp_1_1AOMatrix.html#a8e8bf7b7d5eeb87b8c1f001b4533ee17">Matrix</a>(), dftbasis.<a class="code" href="classvotca_1_1xtp_1_1AOBasis.html#ac6e0f8dae02d6ce22bdd0c914f9d6cc2">getAOBasisFragA</a>());</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;          pop.<a class="code" href="structvotca_1_1xtp_1_1BSE_1_1Population.html#ac712c9faccf2e9a760097d788fef833d">popH</a>.push_back(popsH);</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;          <span class="comment">// electron part</span></div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;          Eigen::VectorXd popsE = <a class="code" href="classvotca_1_1xtp_1_1BSE.html#aa85a34aa3b65e6ceea97e07947b22f9c">_orbitals</a>.<a class="code" href="classvotca_1_1xtp_1_1Orbitals.html#a518ef773cfee05c34dc2a084c0256a58">LoewdinPopulation</a>(DMAT[1], dftoverlap.<a class="code" href="classvotca_1_1xtp_1_1AOMatrix.html#a8e8bf7b7d5eeb87b8c1f001b4533ee17">Matrix</a>(), dftbasis.<a class="code" href="classvotca_1_1xtp_1_1AOBasis.html#ac6e0f8dae02d6ce22bdd0c914f9d6cc2">getAOBasisFragA</a>());</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;          pop.<a class="code" href="structvotca_1_1xtp_1_1BSE_1_1Population.html#a4fed64eb99f97b29b059111fbdd99289">popE</a>.push_back(popsE);</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;          <span class="comment">// update effective charges</span></div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;          Eigen::VectorXd diff = popsH - popsE;</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;          pop.<a class="code" href="structvotca_1_1xtp_1_1BSE_1_1Population.html#a9888511f7f243683874c2dfd05f4ad8c">Crgs</a>.push_back(diff);</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;        }</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        <a class="code" href="logger_8h.html#ad144516788c83f08acfbbe29b2e25de5">CTP_LOG</a>(<a class="code" href="namespacevotca_1_1ctp.html#a6ca95ba08b5f1943b39d7c0d0fad0616a316f858e85e6a70732b82e35ac4e190f">ctp::logDEBUG</a>, *<a class="code" href="classvotca_1_1xtp_1_1BSE.html#ab01686e5fb6e4bf7af0d15b93b368e94">_log</a>) &lt;&lt; <a class="code" href="classvotca_1_1ctp_1_1TimeStamp.html">ctp::TimeStamp</a>() &lt;&lt; <span class="stringliteral">&quot; Ran Excitation fragment population analysis &quot;</span> &lt;&lt; flush;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;     </div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;      <span class="keywordflow">return</span> pop;</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    }</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;</div><div class="line"><a name="l00564"></a><span class="lineno"><a class="line" href="classvotca_1_1xtp_1_1BSE.html#abde6da4d9c13d3e7a39438598c4a6913">  564</a></span>&#160;    std::vector&lt;Eigen::MatrixXd &gt; <a class="code" href="classvotca_1_1xtp_1_1BSE.html#abde6da4d9c13d3e7a39438598c4a6913">BSE::CalcFreeTransition_Dipoles</a>(<span class="keyword">const</span> <a class="code" href="classvotca_1_1xtp_1_1AOBasis.html">AOBasis</a>&amp; dftbasis) {</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;      <span class="keyword">const</span> Eigen::MatrixXd&amp; dft_orbitals = <a class="code" href="classvotca_1_1xtp_1_1BSE.html#aa85a34aa3b65e6ceea97e07947b22f9c">_orbitals</a>.<a class="code" href="classvotca_1_1xtp_1_1Orbitals.html#aeaf2cbb5cbd9e300c2431d29ff870800">MOCoefficients</a>();</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;      <span class="comment">// Testing electric dipole AOMatrix</span></div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;      <a class="code" href="classvotca_1_1xtp_1_1AODipole.html">AODipole</a> dft_dipole;</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;      dft_dipole.<a class="code" href="classvotca_1_1xtp_1_1AOMatrix3D.html#a8637716b6fa4c46adc9b85f0f1a9d58c">Fill</a>(dftbasis);</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;      <span class="comment">// now transition dipole elements for free interlevel transitions</span></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;      std::vector&lt;Eigen::MatrixXd &gt; interlevel_dipoles;</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;      Eigen::MatrixXd empty = dft_orbitals.block(0,<a class="code" href="classvotca_1_1xtp_1_1BSE.html#a59ac7afc9048fa69d3eae4cb10c02c90">_bse_cmin</a>,dftbasis.<a class="code" href="classvotca_1_1xtp_1_1AOBasis.html#a9c03d8d0f7b8e1283b2bd6a073700ab6">AOBasisSize</a>() , <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a18aad705363f0204ab7c050b0cc55be0">_bse_ctotal</a>);</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;      Eigen::MatrixXd occ = dft_orbitals.block(0,<a class="code" href="classvotca_1_1xtp_1_1BSE.html#ac6ce0dfbb12862428bd2ff11da339b71">_bse_vmin</a>, dftbasis.<a class="code" href="classvotca_1_1xtp_1_1AOBasis.html#a9c03d8d0f7b8e1283b2bd6a073700ab6">AOBasisSize</a>(), <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a1dfe9b85c4ed31090f202786a9c23770">_bse_vtotal</a>);</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i_comp = 0; i_comp &lt; 3; i_comp++) {</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        interlevel_dipoles.push_back(occ.transpose() * dft_dipole.<a class="code" href="classvotca_1_1xtp_1_1AOMatrix3D.html#a2ef27fff70207d01ae56625715691828">Matrix</a>()[i_comp] * empty);</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;      }</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;      <a class="code" href="logger_8h.html#ad144516788c83f08acfbbe29b2e25de5">CTP_LOG</a>(<a class="code" href="namespacevotca_1_1ctp.html#a6ca95ba08b5f1943b39d7c0d0fad0616a316f858e85e6a70732b82e35ac4e190f">ctp::logDEBUG</a>, *<a class="code" href="classvotca_1_1xtp_1_1BSE.html#ab01686e5fb6e4bf7af0d15b93b368e94">_log</a>) &lt;&lt; <a class="code" href="classvotca_1_1ctp_1_1TimeStamp.html">ctp::TimeStamp</a>() &lt;&lt; <span class="stringliteral">&quot; Calculated free interlevel transition dipole moments &quot;</span> &lt;&lt; flush;</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="structvotca_1_1tools_1_1globals.html#a68680885a1bd6265f3aacdcca5ab61c4">tools::globals::verbose</a>){</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;          <a class="code" href="logger_8h.html#ad144516788c83f08acfbbe29b2e25de5">CTP_LOG</a>(<a class="code" href="namespacevotca_1_1ctp.html#a6ca95ba08b5f1943b39d7c0d0fad0616a316f858e85e6a70732b82e35ac4e190f">ctp::logDEBUG</a>, *<a class="code" href="classvotca_1_1xtp_1_1BSE.html#ab01686e5fb6e4bf7af0d15b93b368e94">_log</a>)&lt;&lt; <a class="code" href="classvotca_1_1ctp_1_1TimeStamp.html">ctp::TimeStamp</a>() &lt;&lt; <span class="stringliteral">&quot;Free interlevel dipoles v c strength[bohr*e] &quot;</span> &lt;&lt; std::flush;</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;          Eigen::MatrixXd result=(interlevel_dipoles[0].cwiseAbs2()+interlevel_dipoles[1].cwiseAbs2()+interlevel_dipoles[2].cwiseAbs2()).cwiseSqrt();</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> v = 0; v &lt; <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a1dfe9b85c4ed31090f202786a9c23770">_bse_vtotal</a>; v++) {</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c = 0; c &lt; <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a18aad705363f0204ab7c050b0cc55be0">_bse_ctotal</a>; c++) {</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;             <a class="code" href="logger_8h.html#ad144516788c83f08acfbbe29b2e25de5">CTP_LOG</a>(<a class="code" href="namespacevotca_1_1ctp.html#a6ca95ba08b5f1943b39d7c0d0fad0616a316f858e85e6a70732b82e35ac4e190f">ctp::logDEBUG</a>, *<a class="code" href="classvotca_1_1xtp_1_1BSE.html#ab01686e5fb6e4bf7af0d15b93b368e94">_log</a>)&lt;&lt; <span class="stringliteral">&quot;\t\t&quot;</span> &lt;&lt; v &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; c &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;                     &lt;&lt;result(v, c)&lt;&lt; std::flush;</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;          }}      </div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    }</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;      </div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;      </div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;      <span class="keywordflow">return</span> interlevel_dipoles;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    }</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;</div><div class="line"><a name="l00593"></a><span class="lineno"><a class="line" href="classvotca_1_1xtp_1_1BSE.html#a6eb93e8a6ecb24a0e84e01859305ffe4">  593</a></span>&#160;    std::vector&lt;tools::vec &gt; <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a6eb93e8a6ecb24a0e84e01859305ffe4">BSE::CalcCoupledTransition_Dipoles</a>(<span class="keyword">const</span> <a class="code" href="classvotca_1_1xtp_1_1AOBasis.html">AOBasis</a>&amp; dftbasis) {</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    std::vector&lt;Eigen::MatrixXd &gt; interlevel_dipoles= <a class="code" href="classvotca_1_1xtp_1_1BSE.html#abde6da4d9c13d3e7a39438598c4a6913">CalcFreeTransition_Dipoles</a>(dftbasis);</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    <a class="code" href="classvotca_1_1xtp_1_1vc2index.html">vc2index</a> vc=<a class="code" href="classvotca_1_1xtp_1_1vc2index.html">vc2index</a>(0,0,<a class="code" href="classvotca_1_1xtp_1_1BSE.html#a18aad705363f0204ab7c050b0cc55be0">_bse_ctotal</a>);</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    std::vector&lt;tools::vec &gt; dipols;</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> sqrt2 = sqrt(2.0);</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i_exc = 0; i_exc &lt; <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a115226eefd5c5a8a824d8af20fe5b950">_bse_nmax</a>; i_exc++) {</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        <a class="code" href="classvotca_1_1tools_1_1vec.html">tools::vec</a> tdipole = <a class="code" href="classvotca_1_1tools_1_1vec.html">tools::vec</a>(0, 0, 0);</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c = 0; c &lt; <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a18aad705363f0204ab7c050b0cc55be0">_bse_ctotal</a>; c++) {</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> v = 0; v &lt; <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a1dfe9b85c4ed31090f202786a9c23770">_bse_vtotal</a>; v++) {</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;            <span class="keywordtype">int</span> index_vc = vc.<a class="code" href="classvotca_1_1xtp_1_1vc2index.html#aa218bb6f36419754a625ff44416c0665">I</a>(v,c);</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;            <span class="keywordtype">double</span> factor = <a class="code" href="classvotca_1_1xtp_1_1BSE.html#a833659b261da7a1aa2a55e23f6aa0d15">_bse_singlet_coefficients</a>(index_vc, i_exc);</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classvotca_1_1xtp_1_1BSE.html#af224e01bdc671521570c8e4ff1a596d0">_bse_singlet_coefficients_AR</a>.rows()&gt;0) {</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;              factor += <a class="code" href="classvotca_1_1xtp_1_1BSE.html#af224e01bdc671521570c8e4ff1a596d0">_bse_singlet_coefficients_AR</a>(index_vc, i_exc);</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;            }</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;            <span class="comment">// The Transition dipole is sqrt2 bigger because of the spin, the excited state is a linear combination of 2 slater determinants, where either alpha or beta spin electron is excited</span></div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;            tdipole.<a class="code" href="classvotca_1_1tools_1_1vec.html#a780dacdb9ba34a5d77ce6142b74295ab">x</a>() += factor * interlevel_dipoles[0](v, c);</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;            tdipole.<a class="code" href="classvotca_1_1tools_1_1vec.html#a637523087dd64b3d4633e1bc8b6f13b6">y</a>() += factor * interlevel_dipoles[1](v, c);</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;            tdipole.<a class="code" href="classvotca_1_1tools_1_1vec.html#ab6d9c99257adce04881b365c538896a0">z</a>() += factor * interlevel_dipoles[2](v, c);</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;          }</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        }</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        </div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;        dipols.push_back(-sqrt2 *tdipole);     <span class="comment">//- because electrons are negative</span></div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;      }</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;      <span class="keywordflow">return</span> dipols;</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    }</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    </div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;  }</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;};</div><div class="ttc" id="classvotca_1_1xtp_1_1AOMatrix_html_a07bb35205ec490af2430937af9db8c25"><div class="ttname"><a href="classvotca_1_1xtp_1_1AOMatrix.html#a07bb35205ec490af2430937af9db8c25">votca::xtp::AOMatrix::Fill</a></div><div class="ttdeci">void Fill(const AOBasis &amp;aobasis)</div><div class="ttdef"><b>Definition:</b> <a href="aomatrix_8cc_source.html#l00043">aomatrix.cc:43</a></div></div>
<div class="ttc" id="structvotca_1_1xtp_1_1BSE_1_1Interaction_html_a7e1bc5e100bede77f99274fc7d97eb83"><div class="ttname"><a href="structvotca_1_1xtp_1_1BSE_1_1Interaction.html#a7e1bc5e100bede77f99274fc7d97eb83">votca::xtp::BSE::Interaction::exchange_contrib</a></div><div class="ttdeci">Eigen::VectorXd exchange_contrib</div><div class="ttdef"><b>Definition:</b> <a href="bse_8h_source.html#l00035">bse.h:35</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1AOMatrix_html_a8e8bf7b7d5eeb87b8c1f001b4533ee17"><div class="ttname"><a href="classvotca_1_1xtp_1_1AOMatrix.html#a8e8bf7b7d5eeb87b8c1f001b4533ee17">votca::xtp::AOMatrix::Matrix</a></div><div class="ttdeci">const Eigen::Matrix&lt; T, Eigen::Dynamic, Eigen::Dynamic &gt; &amp; Matrix() const</div><div class="ttdef"><b>Definition:</b> <a href="aomatrix_8h_source.html#l00074">aomatrix.h:74</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1BSE_html_abde6da4d9c13d3e7a39438598c4a6913"><div class="ttname"><a href="classvotca_1_1xtp_1_1BSE.html#abde6da4d9c13d3e7a39438598c4a6913">votca::xtp::BSE::CalcFreeTransition_Dipoles</a></div><div class="ttdeci">std::vector&lt; Eigen::MatrixXd &gt; CalcFreeTransition_Dipoles(const AOBasis &amp;dftbasis)</div><div class="ttdef"><b>Definition:</b> <a href="bse_8cc_source.html#l00564">bse.cc:564</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1vc2index_html_aa218bb6f36419754a625ff44416c0665"><div class="ttname"><a href="classvotca_1_1xtp_1_1vc2index.html#aa218bb6f36419754a625ff44416c0665">votca::xtp::vc2index::I</a></div><div class="ttdeci">int I(int v, int c) const</div><div class="ttdef"><b>Definition:</b> <a href="vc2index_8h_source.html#l00038">vc2index.h:38</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1BSE_html_a59fedd6887d8e7e30ace483402c884ac"><div class="ttname"><a href="classvotca_1_1xtp_1_1BSE.html#a59fedd6887d8e7e30ace483402c884ac">votca::xtp::BSE::_min_print_weight</a></div><div class="ttdeci">double _min_print_weight</div><div class="ttdef"><b>Definition:</b> <a href="bse_8h_source.html#l00139">bse.h:139</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1BSE_html_a3e8f2542dc74006f76a704c390f9ddd0"><div class="ttname"><a href="classvotca_1_1xtp_1_1BSE.html#a3e8f2542dc74006f76a704c390f9ddd0">votca::xtp::BSE::SetupHs</a></div><div class="ttdeci">void SetupHs()</div><div class="ttdef"><b>Definition:</b> <a href="bse_8cc_source.html#l00057">bse.cc:57</a></div></div>
<div class="ttc" id="namespacevotca_1_1tools_html_a6881886e89aaff8eed117ff8b4829143"><div class="ttname"><a href="namespacevotca_1_1tools.html#a6881886e89aaff8eed117ff8b4829143">votca::tools::linalg_eigenvalues</a></div><div class="ttdeci">bool linalg_eigenvalues(Eigen::MatrixXd &amp;A, Eigen::VectorXd &amp;E, Eigen::MatrixXd &amp;V, int nmax)</div><div class="ttdoc">solves A*V=E*V for the first n eigenvalues </div><div class="ttdef"><b>Definition:</b> <a href="tools_2src_2libtools_2linalg_8cc_source.html#l00062">linalg.cc:62</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1AOMatrix3D_html_a2ef27fff70207d01ae56625715691828"><div class="ttname"><a href="classvotca_1_1xtp_1_1AOMatrix3D.html#a2ef27fff70207d01ae56625715691828">votca::xtp::AOMatrix3D::Matrix</a></div><div class="ttdeci">const std::vector&lt; Eigen::MatrixXd &gt; &amp; Matrix() const</div><div class="ttdef"><b>Definition:</b> <a href="aomatrix_8h_source.html#l00094">aomatrix.h:94</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1BSE_html_aa85a34aa3b65e6ceea97e07947b22f9c"><div class="ttname"><a href="classvotca_1_1xtp_1_1BSE.html#aa85a34aa3b65e6ceea97e07947b22f9c">votca::xtp::BSE::_orbitals</a></div><div class="ttdeci">Orbitals &amp; _orbitals</div><div class="ttdef"><b>Definition:</b> <a href="bse_8h_source.html#l00119">bse.h:119</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1BSE_html_a4966da27d2c68bdf1acab7935d749911"><div class="ttname"><a href="classvotca_1_1xtp_1_1BSE.html#a4966da27d2c68bdf1acab7935d749911">votca::xtp::BSE::_eh_s</a></div><div class="ttdeci">MatrixXfd &amp; _eh_s</div><div class="ttdef"><b>Definition:</b> <a href="bse_8h_source.html#l00127">bse.h:127</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1Orbitals_html_aff5287e0436f56d3758830416cba6410"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#aff5287e0436f56d3758830416cba6410">votca::xtp::Orbitals::setFragment_E_localisation_triplet</a></div><div class="ttdeci">void setFragment_E_localisation_triplet(const std::vector&lt; Eigen::VectorXd &gt; &amp;popE)</div><div class="ttdef"><b>Definition:</b> <a href="xtp_2include_2votca_2xtp_2orbitals_8h_source.html#l00559">orbitals.h:559</a></div></div>
<div class="ttc" id="namespacevotca_html"><div class="ttname"><a href="namespacevotca.html">votca</a></div><div class="ttdoc">Provides a means for comparing floating point numbers. </div><div class="ttdef"><b>Definition:</b> <a href="akimaspline_8h_source.html#l00025">akimaspline.h:25</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1vc2index_html"><div class="ttname"><a href="classvotca_1_1xtp_1_1vc2index.html">votca::xtp::vc2index</a></div><div class="ttdoc">This class transforms a pair of indices v,c into a compound index I, via I=ctotal*v+c the fast dimens...</div><div class="ttdef"><b>Definition:</b> <a href="vc2index_8h_source.html#l00032">vc2index.h:32</a></div></div>
<div class="ttc" id="bse_8h_html"><div class="ttname"><a href="bse_8h.html">bse.h</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1BSE_html_af918a62226b3540d74d5cb3a26f698fd"><div class="ttname"><a href="classvotca_1_1xtp_1_1BSE.html#af918a62226b3540d74d5cb3a26f698fd">votca::xtp::BSE::_bse_size</a></div><div class="ttdeci">int _bse_size</div><div class="ttdef"><b>Definition:</b> <a href="bse_8h_source.html#l00114">bse.h:114</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1BSE_html_a368aa01495c74adb91bdf1e98a3ee0e4"><div class="ttname"><a href="classvotca_1_1xtp_1_1BSE.html#a368aa01495c74adb91bdf1e98a3ee0e4">votca::xtp::BSE::Add_Hd</a></div><div class="ttdeci">void Add_Hd(Eigen::Matrix&lt; T, Eigen::Dynamic, Eigen::Dynamic &gt; &amp;H)</div><div class="ttdef"><b>Definition:</b> <a href="bse_8cc_source.html#l00190">bse.cc:190</a></div></div>
<div class="ttc" id="classvotca_1_1tools_1_1vec_html_a780dacdb9ba34a5d77ce6142b74295ab"><div class="ttname"><a href="classvotca_1_1tools_1_1vec.html#a780dacdb9ba34a5d77ce6142b74295ab">votca::tools::vec::x</a></div><div class="ttdeci">double &amp; x()</div><div class="ttdoc">get full access to x element </div><div class="ttdef"><b>Definition:</b> <a href="vec_8h_source.html#l00069">vec.h:69</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1AOBasis_html_a6866b3bbd906591ba2af1d897dd6c23f"><div class="ttname"><a href="classvotca_1_1xtp_1_1AOBasis.html#a6866b3bbd906591ba2af1d897dd6c23f">votca::xtp::AOBasis::getAOBasisFragB</a></div><div class="ttdeci">int getAOBasisFragB() const</div><div class="ttdef"><b>Definition:</b> <a href="aobasis_8h_source.html#l00072">aobasis.h:72</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1AOBasis_html_a9c03d8d0f7b8e1283b2bd6a073700ab6"><div class="ttname"><a href="classvotca_1_1xtp_1_1AOBasis.html#a9c03d8d0f7b8e1283b2bd6a073700ab6">votca::xtp::AOBasis::AOBasisSize</a></div><div class="ttdeci">int AOBasisSize() const</div><div class="ttdef"><b>Definition:</b> <a href="aobasis_8h_source.html#l00054">aobasis.h:54</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1Orbitals_html_ac54132162019b4fbb2d431007297ff59"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#ac54132162019b4fbb2d431007297ff59">votca::xtp::Orbitals::DensityMatrixGroundState</a></div><div class="ttdeci">Eigen::MatrixXd DensityMatrixGroundState() const</div><div class="ttdef"><b>Definition:</b> <a href="xtp_2src_2libxtp_2orbitals_8cc_source.html#l00239">orbitals.cc:239</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1BSE_html_abc159fa7cf85ba50c3345c6f6c48d090"><div class="ttname"><a href="classvotca_1_1xtp_1_1BSE.html#abc159fa7cf85ba50c3345c6f6c48d090">votca::xtp::BSE::Solve_singlets</a></div><div class="ttdeci">void Solve_singlets()</div><div class="ttdef"><b>Definition:</b> <a href="bse_8cc_source.html#l00044">bse.cc:44</a></div></div>
<div class="ttc" id="vc2index_8h_html"><div class="ttname"><a href="vc2index_8h.html">vc2index.h</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1BSE_html_ab01686e5fb6e4bf7af0d15b93b368e94"><div class="ttname"><a href="classvotca_1_1xtp_1_1BSE.html#ab01686e5fb6e4bf7af0d15b93b368e94">votca::xtp::BSE::_log</a></div><div class="ttdeci">ctp::Logger * _log</div><div class="ttdef"><b>Definition:</b> <a href="bse_8h_source.html#l00108">bse.h:108</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1TCMatrix__gwbse_html_aaf634bf25df723306188eacecec96a3f"><div class="ttname"><a href="classvotca_1_1xtp_1_1TCMatrix__gwbse.html#aaf634bf25df723306188eacecec96a3f">votca::xtp::TCMatrix_gwbse::getAuxDimension</a></div><div class="ttdeci">int getAuxDimension() const</div><div class="ttdef"><b>Definition:</b> <a href="threecenter_8h_source.html#l00098">threecenter.h:98</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1AOMatrix3D_html_a8637716b6fa4c46adc9b85f0f1a9d58c"><div class="ttname"><a href="classvotca_1_1xtp_1_1AOMatrix3D.html#a8637716b6fa4c46adc9b85f0f1a9d58c">votca::xtp::AOMatrix3D::Fill</a></div><div class="ttdeci">void Fill(const AOBasis &amp;aobasis)</div><div class="ttdef"><b>Definition:</b> <a href="aomatrix_8cc_source.html#l00073">aomatrix.cc:73</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1vc2index_html_a3162459b437320572997778a4b83af68"><div class="ttname"><a href="classvotca_1_1xtp_1_1vc2index.html#a3162459b437320572997778a4b83af68">votca::xtp::vc2index::v</a></div><div class="ttdeci">int v(int index) const</div><div class="ttdef"><b>Definition:</b> <a href="vc2index_8h_source.html#l00040">vc2index.h:40</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1AOBasis_html_ac6e0f8dae02d6ce22bdd0c914f9d6cc2"><div class="ttname"><a href="classvotca_1_1xtp_1_1AOBasis.html#ac6e0f8dae02d6ce22bdd0c914f9d6cc2">votca::xtp::AOBasis::getAOBasisFragA</a></div><div class="ttdeci">int getAOBasisFragA() const</div><div class="ttdef"><b>Definition:</b> <a href="aobasis_8h_source.html#l00070">aobasis.h:70</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1BSE_html_a6eb93e8a6ecb24a0e84e01859305ffe4"><div class="ttname"><a href="classvotca_1_1xtp_1_1BSE.html#a6eb93e8a6ecb24a0e84e01859305ffe4">votca::xtp::BSE::CalcCoupledTransition_Dipoles</a></div><div class="ttdeci">std::vector&lt; tools::vec &gt; CalcCoupledTransition_Dipoles(const AOBasis &amp;dftbasis)</div><div class="ttdef"><b>Definition:</b> <a href="bse_8cc_source.html#l00593">bse.cc:593</a></div></div>
<div class="ttc" id="classvotca_1_1tools_1_1vec_html_ab6d9c99257adce04881b365c538896a0"><div class="ttname"><a href="classvotca_1_1tools_1_1vec.html#ab6d9c99257adce04881b365c538896a0">votca::tools::vec::z</a></div><div class="ttdeci">double &amp; z()</div><div class="ttdoc">get full access to z element </div><div class="ttdef"><b>Definition:</b> <a href="vec_8h_source.html#l00079">vec.h:79</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1BSE_html_a96dc53469d0c9a408f68fac0e608c8d0"><div class="ttname"><a href="classvotca_1_1xtp_1_1BSE.html#a96dc53469d0c9a408f68fac0e608c8d0">votca::xtp::BSE::Solve_triplets</a></div><div class="ttdeci">void Solve_triplets()</div><div class="ttdef"><b>Definition:</b> <a href="bse_8cc_source.html#l00032">bse.cc:32</a></div></div>
<div class="ttc" id="structvotca_1_1xtp_1_1BSE_1_1Population_html_a9888511f7f243683874c2dfd05f4ad8c"><div class="ttname"><a href="structvotca_1_1xtp_1_1BSE_1_1Population.html#a9888511f7f243683874c2dfd05f4ad8c">votca::xtp::BSE::Population::Crgs</a></div><div class="ttdeci">std::vector&lt; Eigen::VectorXd &gt; Crgs</div><div class="ttdef"><b>Definition:</b> <a href="bse_8h_source.html#l00043">bse.h:43</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1Orbitals_html_a1b7f65c292294f053dba005e75318305"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#a1b7f65c292294f053dba005e75318305">votca::xtp::Orbitals::setFragmentChargesSingEXC</a></div><div class="ttdeci">void setFragmentChargesSingEXC(const std::vector&lt; Eigen::VectorXd &gt; &amp;DqS_frag)</div><div class="ttdef"><b>Definition:</b> <a href="xtp_2include_2votca_2xtp_2orbitals_8h_source.html#l00522">orbitals.h:522</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1Orbitals_html_aeaf2cbb5cbd9e300c2431d29ff870800"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#aeaf2cbb5cbd9e300c2431d29ff870800">votca::xtp::Orbitals::MOCoefficients</a></div><div class="ttdeci">const Eigen::MatrixXd &amp; MOCoefficients() const</div><div class="ttdef"><b>Definition:</b> <a href="xtp_2include_2votca_2xtp_2orbitals_8h_source.html#l00174">orbitals.h:174</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1QMStateType_html_ac99cbd6d6ed98f669041f0840b09dfe7a9d38a794b81a5e5fa8b32d8fc153b015"><div class="ttname"><a href="classvotca_1_1xtp_1_1QMStateType.html#ac99cbd6d6ed98f669041f0840b09dfe7a9d38a794b81a5e5fa8b32d8fc153b015">votca::xtp::QMStateType::Triplet</a></div><div class="ttdef"><b>Definition:</b> <a href="qmstate_8h_source.html#l00032">qmstate.h:32</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1BSE_html_a115226eefd5c5a8a824d8af20fe5b950"><div class="ttname"><a href="classvotca_1_1xtp_1_1BSE.html#a115226eefd5c5a8a824d8af20fe5b950">votca::xtp::BSE::_bse_nmax</a></div><div class="ttdeci">int _bse_nmax</div><div class="ttdef"><b>Definition:</b> <a href="bse_8h_source.html#l00117">bse.h:117</a></div></div>
<div class="ttc" id="structvotca_1_1xtp_1_1BSE_1_1Population_html_ac712c9faccf2e9a760097d788fef833d"><div class="ttname"><a href="structvotca_1_1xtp_1_1BSE_1_1Population.html#ac712c9faccf2e9a760097d788fef833d">votca::xtp::BSE::Population::popH</a></div><div class="ttdeci">std::vector&lt; Eigen::VectorXd &gt; popH</div><div class="ttdef"><b>Definition:</b> <a href="bse_8h_source.html#l00041">bse.h:41</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1Orbitals_html_aa2184e03957e8d772404922799574be6"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#aa2184e03957e8d772404922799574be6">votca::xtp::Orbitals::setFragmentChargesGS</a></div><div class="ttdeci">void setFragmentChargesGS(const Eigen::VectorXd &amp;GSq_frag)</div><div class="ttdef"><b>Definition:</b> <a href="xtp_2include_2votca_2xtp_2orbitals_8h_source.html#l00547">orbitals.h:547</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1BSE_html_acba26a80c8cfe0bedb4bc1ddd205de3f"><div class="ttname"><a href="classvotca_1_1xtp_1_1BSE.html#acba26a80c8cfe0bedb4bc1ddd205de3f">votca::xtp::BSE::SetupHt</a></div><div class="ttdeci">void SetupHt()</div><div class="ttdef"><b>Definition:</b> <a href="bse_8cc_source.html#l00064">bse.cc:64</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1Orbitals_html_a39877ff63c3a310331a94e52f6ec6248"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#a39877ff63c3a310331a94e52f6ec6248">votca::xtp::Orbitals::setFragment_E_localisation_singlet</a></div><div class="ttdeci">void setFragment_E_localisation_singlet(const std::vector&lt; Eigen::VectorXd &gt; &amp;popE)</div><div class="ttdef"><b>Definition:</b> <a href="xtp_2include_2votca_2xtp_2orbitals_8h_source.html#l00551">orbitals.h:551</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1PPM_html_a061e12be0f75c108913a9bf6310ccd90"><div class="ttname"><a href="classvotca_1_1xtp_1_1PPM.html#a061e12be0f75c108913a9bf6310ccd90">votca::xtp::PPM::getPpm_weight</a></div><div class="ttdeci">const Eigen::VectorXd &amp; getPpm_weight() const</div><div class="ttdef"><b>Definition:</b> <a href="ppm_8h_source.html#l00045">ppm.h:45</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1AOBasis_html"><div class="ttname"><a href="classvotca_1_1xtp_1_1AOBasis.html">votca::xtp::AOBasis</a></div><div class="ttdoc">Container to hold Basisfunctions for all atoms. </div><div class="ttdef"><b>Definition:</b> <a href="aobasis_8h_source.html#l00042">aobasis.h:42</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1BSE_html_ab04b356fea0c8290b1ad40c95eb74264"><div class="ttname"><a href="classvotca_1_1xtp_1_1BSE.html#ab04b356fea0c8290b1ad40c95eb74264">votca::xtp::BSE::Add_Hx</a></div><div class="ttdeci">void Add_Hx(Eigen::Matrix&lt; T, Eigen::Dynamic, Eigen::Dynamic &gt; &amp;H, double factor)</div><div class="ttdef"><b>Definition:</b> <a href="bse_8cc_source.html#l00349">bse.cc:349</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1Orbitals_html_a40af72495b8ff4b8dc9b80f9ff6ad16c"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#a40af72495b8ff4b8dc9b80f9ff6ad16c">votca::xtp::Orbitals::setFragment_H_localisation_triplet</a></div><div class="ttdeci">void setFragment_H_localisation_triplet(const std::vector&lt; Eigen::VectorXd &gt; &amp;popH)</div><div class="ttdef"><b>Definition:</b> <a href="xtp_2include_2votca_2xtp_2orbitals_8h_source.html#l00563">orbitals.h:563</a></div></div>
<div class="ttc" id="structvotca_1_1xtp_1_1BSE_1_1Population_html_a4fed64eb99f97b29b059111fbdd99289"><div class="ttname"><a href="structvotca_1_1xtp_1_1BSE_1_1Population.html#a4fed64eb99f97b29b059111fbdd99289">votca::xtp::BSE::Population::popE</a></div><div class="ttdeci">std::vector&lt; Eigen::VectorXd &gt; popE</div><div class="ttdef"><b>Definition:</b> <a href="bse_8h_source.html#l00042">bse.h:42</a></div></div>
<div class="ttc" id="classvotca_1_1tools_1_1vec_html_ae438fb43de95f0b5aac045c9a9f544c5"><div class="ttname"><a href="classvotca_1_1tools_1_1vec.html#ae438fb43de95f0b5aac045c9a9f544c5">votca::tools::vec::getZ</a></div><div class="ttdeci">const double &amp; getZ() const</div><div class="ttdoc">read only access to z element </div><div class="ttdef"><b>Definition:</b> <a href="vec_8h_source.html#l00108">vec.h:108</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1Orbitals_html_a876bd9251b0aaee2a13336380dba55f8"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#a876bd9251b0aaee2a13336380dba55f8">votca::xtp::Orbitals::Oscillatorstrengths</a></div><div class="ttdeci">std::vector&lt; double &gt; Oscillatorstrengths() const</div><div class="ttdef"><b>Definition:</b> <a href="xtp_2src_2libxtp_2orbitals_8cc_source.html#l00502">orbitals.cc:502</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1BSE_html_a18aad705363f0204ab7c050b0cc55be0"><div class="ttname"><a href="classvotca_1_1xtp_1_1BSE.html#a18aad705363f0204ab7c050b0cc55be0">votca::xtp::BSE::_bse_ctotal</a></div><div class="ttdeci">int _bse_ctotal</div><div class="ttdef"><b>Definition:</b> <a href="bse_8h_source.html#l00116">bse.h:116</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1Orbitals_html_ae27ee5c3d7178eed49b698fb84d3ff37"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#ae27ee5c3d7178eed49b698fb84d3ff37">votca::xtp::Orbitals::FragmentNuclearCharges</a></div><div class="ttdeci">Eigen::VectorXd FragmentNuclearCharges(int frag) const</div><div class="ttdef"><b>Definition:</b> <a href="xtp_2src_2libxtp_2orbitals_8cc_source.html#l00563">orbitals.cc:563</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1BSE_html_a149156603d6acc75400fb29201c8f23c"><div class="ttname"><a href="classvotca_1_1xtp_1_1BSE.html#a149156603d6acc75400fb29201c8f23c">votca::xtp::BSE::_ppm</a></div><div class="ttdeci">const PPM * _ppm</div><div class="ttdef"><b>Definition:</b> <a href="bse_8h_source.html#l00122">bse.h:122</a></div></div>
<div class="ttc" id="structvotca_1_1xtp_1_1BSE_1_1Interaction_html_af45fcff72a934c43da15d2f10b144920"><div class="ttname"><a href="structvotca_1_1xtp_1_1BSE_1_1Interaction.html#af45fcff72a934c43da15d2f10b144920">votca::xtp::BSE::Interaction::direct_contrib</a></div><div class="ttdeci">Eigen::VectorXd direct_contrib</div><div class="ttdef"><b>Definition:</b> <a href="bse_8h_source.html#l00036">bse.h:36</a></div></div>
<div class="ttc" id="namespacevotca_1_1tools_1_1conv_html_a6f231ae1bc59867ca0e1c76a9fd1f179"><div class="ttname"><a href="namespacevotca_1_1tools_1_1conv.html#a6f231ae1bc59867ca0e1c76a9fd1f179">votca::tools::conv::hrt2ev</a></div><div class="ttdeci">const double hrt2ev</div><div class="ttdef"><b>Definition:</b> <a href="constants_8h_source.html#l00049">constants.h:49</a></div></div>
<div class="ttc" id="logger_8h_html_ad144516788c83f08acfbbe29b2e25de5"><div class="ttname"><a href="logger_8h.html#ad144516788c83f08acfbbe29b2e25de5">CTP_LOG</a></div><div class="ttdeci">#define CTP_LOG(level, log)</div><div class="ttdef"><b>Definition:</b> <a href="logger_8h_source.html#l00034">logger.h:34</a></div></div>
<div class="ttc" id="structvotca_1_1xtp_1_1BSE_1_1Population_html_a35e731e3753f0c95a934942845ea411d"><div class="ttname"><a href="structvotca_1_1xtp_1_1BSE_1_1Population.html#a35e731e3753f0c95a934942845ea411d">votca::xtp::BSE::Population::popGs</a></div><div class="ttdeci">Eigen::VectorXd popGs</div><div class="ttdef"><b>Definition:</b> <a href="bse_8h_source.html#l00044">bse.h:44</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1Orbitals_html_aed468b9bd77e86a52271902e8fee184d"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#aed468b9bd77e86a52271902e8fee184d">votca::xtp::Orbitals::setFragmentChargesTripEXC</a></div><div class="ttdeci">void setFragmentChargesTripEXC(const std::vector&lt; Eigen::VectorXd &gt; &amp;DqT_frag)</div><div class="ttdef"><b>Definition:</b> <a href="xtp_2include_2votca_2xtp_2orbitals_8h_source.html#l00537">orbitals.h:537</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1AODipole_html"><div class="ttname"><a href="classvotca_1_1xtp_1_1AODipole.html">votca::xtp::AODipole</a></div><div class="ttdef"><b>Definition:</b> <a href="aomatrix_8h_source.html#l00117">aomatrix.h:117</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1BSE_html_a83f5f71108ccc4c4803deabe09484e51"><div class="ttname"><a href="classvotca_1_1xtp_1_1BSE.html#a83f5f71108ccc4c4803deabe09484e51">votca::xtp::BSE::_bse_triplet_energies</a></div><div class="ttdeci">VectorXfd &amp; _bse_triplet_energies</div><div class="ttdef"><b>Definition:</b> <a href="bse_8h_source.html#l00135">bse.h:135</a></div></div>
<div class="ttc" id="structvotca_1_1xtp_1_1BSE_1_1Interaction_html_a556ad40aa3c44aff4bc3ed1300fa66b1"><div class="ttname"><a href="structvotca_1_1xtp_1_1BSE_1_1Interaction.html#a556ad40aa3c44aff4bc3ed1300fa66b1">votca::xtp::BSE::Interaction::qp_contrib</a></div><div class="ttdeci">Eigen::VectorXd qp_contrib</div><div class="ttdef"><b>Definition:</b> <a href="bse_8h_source.html#l00037">bse.h:37</a></div></div>
<div class="ttc" id="namespacevotca_1_1xtp_html_a1562003c814c961d9fe41b42be6e2e61"><div class="ttname"><a href="namespacevotca_1_1xtp.html#a1562003c814c961d9fe41b42be6e2e61">votca::xtp::MatrixXfd</a></div><div class="ttdeci">Eigen::Matrix&lt; real_gwbse, Eigen::Dynamic, Eigen::Dynamic &gt; MatrixXfd</div><div class="ttdef"><b>Definition:</b> <a href="xtp_2include_2votca_2xtp_2eigen_8h_source.html#l00034">eigen.h:34</a></div></div>
<div class="ttc" id="classvotca_1_1tools_1_1vec_html_aa62c261e0b0578d32c47685c42cafdaa"><div class="ttname"><a href="classvotca_1_1tools_1_1vec.html#aa62c261e0b0578d32c47685c42cafdaa">votca::tools::vec::getX</a></div><div class="ttdeci">const double &amp; getX() const</div><div class="ttdoc">read only access to x element </div><div class="ttdef"><b>Definition:</b> <a href="vec_8h_source.html#l00092">vec.h:92</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1BSE_html_a05a0721af341420b3f89b2149f779e8f"><div class="ttname"><a href="classvotca_1_1xtp_1_1BSE.html#a05a0721af341420b3f89b2149f779e8f">votca::xtp::BSE::Solve_singlets_BTDA</a></div><div class="ttdeci">void Solve_singlets_BTDA()</div><div class="ttdef"><b>Definition:</b> <a href="bse_8cc_source.html#l00071">bse.cc:71</a></div></div>
<div class="ttc" id="ImagePotential_8h_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="ImagePotential_8h.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="ImagePotential_8h_source.html#l00028">ImagePotential.h:28</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1BSE_html_a833659b261da7a1aa2a55e23f6aa0d15"><div class="ttname"><a href="classvotca_1_1xtp_1_1BSE.html#a833659b261da7a1aa2a55e23f6aa0d15">votca::xtp::BSE::_bse_singlet_coefficients</a></div><div class="ttdeci">MatrixXfd &amp; _bse_singlet_coefficients</div><div class="ttdef"><b>Definition:</b> <a href="bse_8h_source.html#l00131">bse.h:131</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1AOOverlap_html"><div class="ttname"><a href="classvotca_1_1xtp_1_1AOOverlap.html">votca::xtp::AOOverlap</a></div><div class="ttdef"><b>Definition:</b> <a href="aomatrix_8h_source.html#l00171">aomatrix.h:171</a></div></div>
<div class="ttc" id="structvotca_1_1xtp_1_1BSE_1_1Population_html"><div class="ttname"><a href="structvotca_1_1xtp_1_1BSE_1_1Population.html">votca::xtp::BSE::Population</a></div><div class="ttdef"><b>Definition:</b> <a href="bse_8h_source.html#l00040">bse.h:40</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1Orbitals_html_ad5b0df3a865c2927104af6d3e3c8772f"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#ad5b0df3a865c2927104af6d3e3c8772f">votca::xtp::Orbitals::DensityMatrixExcitedState</a></div><div class="ttdeci">std::vector&lt; Eigen::MatrixXd &gt; DensityMatrixExcitedState(const QMState &amp;state) const</div><div class="ttdef"><b>Definition:</b> <a href="xtp_2src_2libxtp_2orbitals_8cc_source.html#l00341">orbitals.cc:341</a></div></div>
<div class="ttc" id="namespacevotca_1_1ctp_html_a6ca95ba08b5f1943b39d7c0d0fad0616a316f858e85e6a70732b82e35ac4e190f"><div class="ttname"><a href="namespacevotca_1_1ctp.html#a6ca95ba08b5f1943b39d7c0d0fad0616a316f858e85e6a70732b82e35ac4e190f">votca::ctp::logDEBUG</a></div><div class="ttdef"><b>Definition:</b> <a href="logger_8h_source.html#l00029">logger.h:29</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1BSE_html_ac6ce0dfbb12862428bd2ff11da339b71"><div class="ttname"><a href="classvotca_1_1xtp_1_1BSE.html#ac6ce0dfbb12862428bd2ff11da339b71">votca::xtp::BSE::_bse_vmin</a></div><div class="ttdeci">int _bse_vmin</div><div class="ttdef"><b>Definition:</b> <a href="bse_8h_source.html#l00110">bse.h:110</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1BSE_html_aac58b5167c0743f6f7e12ae79e71ed7c"><div class="ttname"><a href="classvotca_1_1xtp_1_1BSE.html#aac58b5167c0743f6f7e12ae79e71ed7c">votca::xtp::BSE::_eh_t</a></div><div class="ttdeci">MatrixXfd &amp; _eh_t</div><div class="ttdef"><b>Definition:</b> <a href="bse_8h_source.html#l00128">bse.h:128</a></div></div>
<div class="ttc" id="qmstate_8h_html"><div class="ttname"><a href="qmstate_8h.html">qmstate.h</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1BSE_html_a5e4a45e8e5a1bb3ee6619e04d5cc28a9"><div class="ttname"><a href="classvotca_1_1xtp_1_1BSE.html#a5e4a45e8e5a1bb3ee6619e04d5cc28a9">votca::xtp::BSE::Analyze_singlets</a></div><div class="ttdeci">void Analyze_singlets(const AOBasis &amp;dftbasis)</div><div class="ttdef"><b>Definition:</b> <a href="bse_8cc_source.html#l00390">bse.cc:390</a></div></div>
<div class="ttc" id="classvotca_1_1tools_1_1vec_html_a637523087dd64b3d4633e1bc8b6f13b6"><div class="ttname"><a href="classvotca_1_1tools_1_1vec.html#a637523087dd64b3d4633e1bc8b6f13b6">votca::tools::vec::y</a></div><div class="ttdeci">double &amp; y()</div><div class="ttdoc">get full access to y element </div><div class="ttdef"><b>Definition:</b> <a href="vec_8h_source.html#l00074">vec.h:74</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1BSE_html_a5d6b75f37990fe0bd4cda744d3620fff"><div class="ttname"><a href="classvotca_1_1xtp_1_1BSE.html#a5d6b75f37990fe0bd4cda744d3620fff">votca::xtp::BSE::_bse_triplet_coefficients</a></div><div class="ttdeci">MatrixXfd &amp; _bse_triplet_coefficients</div><div class="ttdef"><b>Definition:</b> <a href="bse_8h_source.html#l00136">bse.h:136</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1Orbitals_html_ac8f9814756af473cdbbcf1da5fa29219"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#ac8f9814756af473cdbbcf1da5fa29219">votca::xtp::Orbitals::TransitionDipoles</a></div><div class="ttdeci">const std::vector&lt; tools::vec &gt; &amp; TransitionDipoles() const</div><div class="ttdef"><b>Definition:</b> <a href="xtp_2include_2votca_2xtp_2orbitals_8h_source.html#l00486">orbitals.h:486</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1vc2index_html_a78b92c55637c8921adbe7a0f0bc9ee6f"><div class="ttname"><a href="classvotca_1_1xtp_1_1vc2index.html#a78b92c55637c8921adbe7a0f0bc9ee6f">votca::xtp::vc2index::c</a></div><div class="ttdeci">int c(int index) const</div><div class="ttdef"><b>Definition:</b> <a href="vc2index_8h_source.html#l00042">vc2index.h:42</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1BSE_html_afd151553fb022439c024f716dc3823fc"><div class="ttname"><a href="classvotca_1_1xtp_1_1BSE.html#afd151553fb022439c024f716dc3823fc">votca::xtp::BSE::_homo</a></div><div class="ttdeci">int _homo</div><div class="ttdef"><b>Definition:</b> <a href="bse_8h_source.html#l00109">bse.h:109</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1BSE_html_af224e01bdc671521570c8e4ff1a596d0"><div class="ttname"><a href="classvotca_1_1xtp_1_1BSE.html#af224e01bdc671521570c8e4ff1a596d0">votca::xtp::BSE::_bse_singlet_coefficients_AR</a></div><div class="ttdeci">MatrixXfd &amp; _bse_singlet_coefficients_AR</div><div class="ttdef"><b>Definition:</b> <a href="bse_8h_source.html#l00133">bse.h:133</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1BSE_html_ac667d6e731c876736788c68478d59916"><div class="ttname"><a href="classvotca_1_1xtp_1_1BSE.html#ac667d6e731c876736788c68478d59916">votca::xtp::BSE::_Mmn</a></div><div class="ttdeci">const TCMatrix_gwbse * _Mmn</div><div class="ttdef"><b>Definition:</b> <a href="bse_8h_source.html#l00121">bse.h:121</a></div></div>
<div class="ttc" id="structvotca_1_1xtp_1_1BSE_1_1Interaction_html"><div class="ttname"><a href="structvotca_1_1xtp_1_1BSE_1_1Interaction.html">votca::xtp::BSE::Interaction</a></div><div class="ttdef"><b>Definition:</b> <a href="bse_8h_source.html#l00034">bse.h:34</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1QMState_html"><div class="ttname"><a href="classvotca_1_1xtp_1_1QMState.html">votca::xtp::QMState</a></div><div class="ttdoc">Identifier for QMstates. Strings like S1 are converted into enum +zero indexed int. </div><div class="ttdef"><b>Definition:</b> <a href="qmstate_8h_source.html#l00089">qmstate.h:89</a></div></div>
<div class="ttc" id="namespacevotca_1_1ctp_html_a6ca95ba08b5f1943b39d7c0d0fad0616a8c6c5f605ebba63a742e19471883f0bb"><div class="ttname"><a href="namespacevotca_1_1ctp.html#a6ca95ba08b5f1943b39d7c0d0fad0616a8c6c5f605ebba63a742e19471883f0bb">votca::ctp::logINFO</a></div><div class="ttdef"><b>Definition:</b> <a href="logger_8h_source.html#l00029">logger.h:29</a></div></div>
<div class="ttc" id="tools_2include_2votca_2tools_2linalg_8h_html"><div class="ttname"><a href="tools_2include_2votca_2tools_2linalg_8h.html">linalg.h</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1QMStateType_html_ac99cbd6d6ed98f669041f0840b09dfe7ac2ca29ef89597f341a74e08f205c4552"><div class="ttname"><a href="classvotca_1_1xtp_1_1QMStateType.html#ac99cbd6d6ed98f669041f0840b09dfe7ac2ca29ef89597f341a74e08f205c4552">votca::xtp::QMStateType::Singlet</a></div><div class="ttdef"><b>Definition:</b> <a href="qmstate_8h_source.html#l00032">qmstate.h:32</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1BSE_html_ae55323af2d531f3b6ac113817bd05340"><div class="ttname"><a href="classvotca_1_1xtp_1_1BSE.html#ae55323af2d531f3b6ac113817bd05340">votca::xtp::BSE::Analyze_eh_interaction</a></div><div class="ttdeci">Interaction Analyze_eh_interaction(const QMStateType &amp;type)</div><div class="ttdef"><b>Definition:</b> <a href="bse_8cc_source.html#l00512">bse.cc:512</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1BSE_html_a481374c9dbe613c24eb1271c51c9030d"><div class="ttname"><a href="classvotca_1_1xtp_1_1BSE.html#a481374c9dbe613c24eb1271c51c9030d">votca::xtp::BSE::Analyze_triplets</a></div><div class="ttdeci">void Analyze_triplets(const AOBasis &amp;dftbasis)</div><div class="ttdef"><b>Definition:</b> <a href="bse_8cc_source.html#l00447">bse.cc:447</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1BSE_html_a478b8e8ac7e99050dc0ef356880be30b"><div class="ttname"><a href="classvotca_1_1xtp_1_1BSE.html#a478b8e8ac7e99050dc0ef356880be30b">votca::xtp::BSE::_Hqp</a></div><div class="ttdeci">const Eigen::MatrixXd * _Hqp</div><div class="ttdef"><b>Definition:</b> <a href="bse_8h_source.html#l00123">bse.h:123</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1BSE_html_a655b9df724d0fed8bb143dcc9f75eb9d"><div class="ttname"><a href="classvotca_1_1xtp_1_1BSE.html#a655b9df724d0fed8bb143dcc9f75eb9d">votca::xtp::BSE::_bse_singlet_energies</a></div><div class="ttdeci">VectorXfd &amp; _bse_singlet_energies</div><div class="ttdef"><b>Definition:</b> <a href="bse_8h_source.html#l00130">bse.h:130</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1BSE_html_a677cf0e7dbfafa4d74cb7c10ff64edb8"><div class="ttname"><a href="classvotca_1_1xtp_1_1BSE.html#a677cf0e7dbfafa4d74cb7c10ff64edb8">votca::xtp::BSE::printWeights</a></div><div class="ttdeci">void printWeights(int i_bse, double weight)</div><div class="ttdef"><b>Definition:</b> <a href="bse_8cc_source.html#l00380">bse.cc:380</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1Orbitals_html_a359fb265681d8ac6126fa015dcdc4b41"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#a359fb265681d8ac6126fa015dcdc4b41">votca::xtp::Orbitals::setFragment_H_localisation_singlet</a></div><div class="ttdeci">void setFragment_H_localisation_singlet(const std::vector&lt; Eigen::VectorXd &gt; &amp;popH)</div><div class="ttdef"><b>Definition:</b> <a href="xtp_2include_2votca_2xtp_2orbitals_8h_source.html#l00555">orbitals.h:555</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1BSE_html_a189c91297358634740c781b60ecbb417"><div class="ttname"><a href="classvotca_1_1xtp_1_1BSE.html#a189c91297358634740c781b60ecbb417">votca::xtp::BSE::FragmentPopulations</a></div><div class="ttdeci">Population FragmentPopulations(const QMStateType &amp;type, const AOBasis &amp;dftbasis)</div><div class="ttdef"><b>Definition:</b> <a href="bse_8cc_source.html#l00533">bse.cc:533</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1QMStateType_html"><div class="ttname"><a href="classvotca_1_1xtp_1_1QMStateType.html">votca::xtp::QMStateType</a></div><div class="ttdef"><b>Definition:</b> <a href="qmstate_8h_source.html#l00029">qmstate.h:29</a></div></div>
<div class="ttc" id="classvotca_1_1tools_1_1vec_html"><div class="ttname"><a href="classvotca_1_1tools_1_1vec.html">votca::tools::vec</a></div><div class="ttdoc">Vector class for a 3 component vector. </div><div class="ttdef"><b>Definition:</b> <a href="vec_8h_source.html#l00041">vec.h:41</a></div></div>
<div class="ttc" id="classvotca_1_1ctp_1_1TimeStamp_html"><div class="ttname"><a href="classvotca_1_1ctp_1_1TimeStamp.html">votca::ctp::TimeStamp</a></div><div class="ttdoc">Timestamp returns the current time as a string Example: cout &lt;&lt; TimeStamp() </div><div class="ttdef"><b>Definition:</b> <a href="logger_8h_source.html#l00229">logger.h:229</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1BSE_html_adf8f7a2feee5d71f8047ce603955a66d"><div class="ttname"><a href="classvotca_1_1xtp_1_1BSE.html#adf8f7a2feee5d71f8047ce603955a66d">votca::xtp::BSE::Analyze_IndividualContribution</a></div><div class="ttdeci">Eigen::VectorXd Analyze_IndividualContribution(const QMStateType &amp;type, const MatrixXfd &amp;H)</div><div class="ttdef"><b>Definition:</b> <a href="bse_8cc_source.html#l00489">bse.cc:489</a></div></div>
<div class="ttc" id="classvotca_1_1tools_1_1vec_html_a3f5853a9c588a3a31b362a7e690d28b9"><div class="ttname"><a href="classvotca_1_1tools_1_1vec.html#a3f5853a9c588a3a31b362a7e690d28b9">votca::tools::vec::getY</a></div><div class="ttdeci">const double &amp; getY() const</div><div class="ttdoc">read only access to y element </div><div class="ttdef"><b>Definition:</b> <a href="vec_8h_source.html#l00100">vec.h:100</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1BSE_html_a403e94722fe6e1530fbd8b90a69983fb"><div class="ttname"><a href="classvotca_1_1xtp_1_1BSE.html#a403e94722fe6e1530fbd8b90a69983fb">votca::xtp::BSE::Add_Hqp</a></div><div class="ttdeci">void Add_Hqp(Eigen::Matrix&lt; T, Eigen::Dynamic, Eigen::Dynamic &gt; &amp;H)</div><div class="ttdef"><b>Definition:</b> <a href="bse_8cc_source.html#l00159">bse.cc:159</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1BSE_html_a1dfe9b85c4ed31090f202786a9c23770"><div class="ttname"><a href="classvotca_1_1xtp_1_1BSE.html#a1dfe9b85c4ed31090f202786a9c23770">votca::xtp::BSE::_bse_vtotal</a></div><div class="ttdeci">int _bse_vtotal</div><div class="ttdef"><b>Definition:</b> <a href="bse_8h_source.html#l00115">bse.h:115</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1BSE_html_a59ac7afc9048fa69d3eae4cb10c02c90"><div class="ttname"><a href="classvotca_1_1xtp_1_1BSE.html#a59ac7afc9048fa69d3eae4cb10c02c90">votca::xtp::BSE::_bse_cmin</a></div><div class="ttdeci">int _bse_cmin</div><div class="ttdef"><b>Definition:</b> <a href="bse_8h_source.html#l00112">bse.h:112</a></div></div>
<div class="ttc" id="structvotca_1_1tools_1_1globals_html_a68680885a1bd6265f3aacdcca5ab61c4"><div class="ttname"><a href="structvotca_1_1tools_1_1globals.html#a68680885a1bd6265f3aacdcca5ab61c4">votca::tools::globals::verbose</a></div><div class="ttdeci">static bool verbose</div><div class="ttdoc">be loud and noisy </div><div class="ttdef"><b>Definition:</b> <a href="globals_8h_source.html#l00036">globals.h:36</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1BSE_html_a6e7e24a74f4de93aa3825f12a6916645"><div class="ttname"><a href="classvotca_1_1xtp_1_1BSE.html#a6e7e24a74f4de93aa3825f12a6916645">votca::xtp::BSE::printFragInfo</a></div><div class="ttdeci">void printFragInfo(const Population &amp;pop, int i)</div><div class="ttdef"><b>Definition:</b> <a href="bse_8cc_source.html#l00372">bse.cc:372</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1BSE_html_a1f5034aaa396a91caa5326f7f81e6776"><div class="ttname"><a href="classvotca_1_1xtp_1_1BSE.html#a1f5034aaa396a91caa5326f7f81e6776">votca::xtp::BSE::Add_Hd2</a></div><div class="ttdeci">void Add_Hd2(Eigen::Matrix&lt; T, Eigen::Dynamic, Eigen::Dynamic &gt; &amp;H, double factor)</div><div class="ttdef"><b>Definition:</b> <a href="bse_8cc_source.html#l00271">bse.cc:271</a></div></div>
<div class="ttc" id="classvotca_1_1xtp_1_1Orbitals_html_a518ef773cfee05c34dc2a084c0256a58"><div class="ttname"><a href="classvotca_1_1xtp_1_1Orbitals.html#a518ef773cfee05c34dc2a084c0256a58">votca::xtp::Orbitals::LoewdinPopulation</a></div><div class="ttdeci">static Eigen::VectorXd LoewdinPopulation(const Eigen::MatrixXd &amp;densitymatrix, const Eigen::MatrixXd &amp;overlapmatrix, int frag)</div><div class="ttdef"><b>Definition:</b> <a href="xtp_2src_2libxtp_2orbitals_8cc_source.html#l00484">orbitals.cc:484</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
